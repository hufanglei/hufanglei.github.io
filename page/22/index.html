<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hufanglei.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"scrollpercent":true,"onmobile":false},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
<meta property="og:type" content="blog">
<meta property="og:title" content="个人博客">
<meta property="og:url" content="https://hufanglei.github.io/page/22/index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="胡方雷">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hufanglei.github.io/page/22/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/22/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>个人博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">个人博客</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录生活中的点点滴滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">398</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">105</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">594</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="胡方雷"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">胡方雷</p>
  <div class="site-description" itemprop="description">直到这一刻微笑着说话为止，我至少留下了一公升眼泪</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">594</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">105</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">398</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hufanglei" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hufanglei" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://hufanglei.blog.csdn.net/" title="CSDN → https:&#x2F;&#x2F;hufanglei.blog.csdn.net" rel="noopener me" target="_blank"><i class="crosshairs fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:690328661@qq.com" title="E-Mail → mailto:690328661@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1518938&auto=1&height=66"></iframe>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title">
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="http://www.alloyteam.com/nav/" title="http:&#x2F;&#x2F;www.alloyteam.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">Web前端导航</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://www.uisdc.com/" title="http:&#x2F;&#x2F;www.uisdc.com&#x2F;" rel="noopener" target="_blank">优设</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://www.zhangxinxu.com/" title="http:&#x2F;&#x2F;www.zhangxinxu.com&#x2F;" rel="noopener" target="_blank">牛人文档</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://ife.baidu.com/" title="http:&#x2F;&#x2F;ife.baidu.com&#x2F;" rel="noopener" target="_blank">百度前端技术学院</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://wf.uisdc.com/cn/" title="http:&#x2F;&#x2F;wf.uisdc.com&#x2F;cn&#x2F;" rel="noopener" target="_blank">google前端开发基础</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(4)%20--%20%E9%A1%B5%E9%9D%A2%E9%97%B4%E7%9A%84%E8%B7%B3%E8%BD%AC%E5%92%8C%E4%BC%A0%E5%80%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(4)%20--%20%E9%A1%B5%E9%9D%A2%E9%97%B4%E7%9A%84%E8%B7%B3%E8%BD%AC%E5%92%8C%E4%BC%A0%E5%80%BC/" class="post-title-link" itemprop="url">微信小程序学习笔记(4) -- 页面间的跳转和传值</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-27 23:31:24" itemprop="dateCreated datePublished" datetime="2020-06-27T23:31:24+08:00">2020-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">微信小程序</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="页面间跳转"><a href="#页面间跳转" class="headerlink" title="页面间跳转"></a>页面间跳转</h1><h2 id="页面间跳转-—-导航"><a href="#页面间跳转-—-导航" class="headerlink" title="页面间跳转 — 导航"></a>页面间跳转 — 导航</h2><p>关键标签:  navigator</p>
<p>首先注意2个地方:</p>
<p>1.在app.json中书写一个配置项，会自动生成该页面的page下面的2个文件</p>
<p>2.如果新建的page的json文件是空内容，改页面不会被渲染，显示空白，解决方式在page的json中加个{}，让它符合json的规范。</p>
<p>案例演示:</p>
<p> 演示页面demo1跳转到demo2的页面，然后点击demo2的图片挑转到demo3的页面。</p>
<ul>
<li><p>1.准备3个页面</p>
<p>app.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;pages/demo1/demo1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/demo2/demo2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/demo3/demo3&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;window&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;backgroundTextStyle&quot;</span><span class="punctuation">:</span><span class="string">&quot;light&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#fff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WeChat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span><span class="string">&quot;black&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sitemapLocation&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sitemap.json&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>2.书写demo1的页面，定义个navigator的标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo1/demo1.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo2/demo2&quot;</span>&gt;</span>go demo2 page<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>3.书写demo2的页面</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo2/demo2.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>pages/demo2/demo2.wxml<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo3/demo3&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/12.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>4.书写demo3的页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo3/demo3.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>pages/demo3/demo3.wxml<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>看下效果:</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/099356b4c632cde0ceff86d3d543978c_1737630298619.png" alt="在这里插入图片描述"></p>
<p>会跳转到:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/dc036eaf9b0a2848eb2481d157e8c55e_1737630298619.png" alt="在这里插入图片描述"></p>
<p>点击图片:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b154ee2a1f02e8035cde71c5f947468a_1737630298619.png" alt="在这里插入图片描述"></p>
<h2 id="页面间传值"><a href="#页面间传值" class="headerlink" title="页面间传值"></a>页面间传值</h2><p> 页面间参数传递:</p>
<p>​    1.传递: 跳转链接上加问号参数</p>
<p>​    2.接受 pnload的第一个参数(对象)</p>
<p>案例说明:</p>
<p>在demo1中携带参数跳转到demo2页面，看下demo2是否可以接受到参数值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo1/demo1.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo2/demo2&quot;</span>&gt;</span>go demo2 page<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo2/demo2?name=小明&amp;age=18&quot;</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo2/demo2?name=小红&quot;</span>&gt;</span>小红<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> 页面间参数传递:</span></span><br><span class="line"><span class="comment">    1.传递: 跳转链接上加问号参数</span></span><br><span class="line"><span class="comment">    2.接受 pnload的第一个参数(对象)</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br></pre></td></tr></table></figure>

<p>demo2.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages/demo2/demo2.js</span></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onLoad</span>: <span class="keyword">function</span> (<span class="params">options</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(options);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面初次渲染完成</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onReady</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面显示</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onShow</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面隐藏</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onHide</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面卸载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onUnload</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面相关事件处理函数--监听用户下拉动作</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onPullDownRefresh</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面上拉触底事件的处理函数</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onReachBottom</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 用户点击右上角分享</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onShareAppMessage</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>测试:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b7b8adee248a6a4593a11a6cc5184f8f_1737630311150.png" alt="在这里插入图片描述"><br>看下打印信息:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/df0cf4b90f2429562572eebfc48012cf_1737630311150.png" alt="在这里插入图片描述"><br>显示：接收到了参数。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/32fc8e881f0b9c8b4fc6932d4d86c493_1737630311150.png" alt="在这里插入图片描述"></p>
<p>看下控制台信息:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a486bff6dacb4f1f2411d0cf33776f5b_1737630311150.png" alt="在这里插入图片描述"></p>
<p>也接受到了信息。同时页面也已经跳转到了demo2页面</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/943e4e643c0e6db67fb502a413030e6a_1737630311150.png" alt="在这里插入图片描述"></p>
<h2 id="页面导航模式–redirect"><a href="#页面导航模式–redirect" class="headerlink" title="页面导航模式–redirect"></a>页面导航模式–redirect</h2><p>前面的导航栏模式，demo1页面跳转到demo2的时候会有个返回，点击返回又返回到了demo1页面。</p>
<p>如果有这个需求:不想返回到原来的页面，就得用到导航的redirect模式（redirect设置为true）。</p>
<p>原来的方式:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/426dc7d3c39798b70313947f2f16ff17_1737630322327.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d78803305671ffc53ea797c19c50e1fd_1737630322327.png" alt="在这里插入图片描述"></p>
<p>可以看到又返回到demo1页面了。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/cc2cbdd174bc9736642dbe1a9790731a_1737630322327.png" alt=" S"></p>
<h3 id="改进：使用redirect方式跳转"><a href="#改进：使用redirect方式跳转" class="headerlink" title="改进：使用redirect方式跳转"></a>改进：使用redirect方式跳转</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo1/demo1.wxml--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo2/demo2&quot;</span> <span class="attr">redirect</span>&gt;</span>跳转过去(不回来了)<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3e12719a9f54c2bd13e5a420992b6aec_1737630322327.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e3b612591e9626071f696cbfdc616776_1737630322327.png" alt="在这里插入图片描述"></p>
<p>说明，redirect模式设置成功。</p>
<h2 id="导航元素点击高亮"><a href="#导航元素点击高亮" class="headerlink" title="导航元素点击高亮"></a>导航元素点击高亮</h2><p>在点击导航时，会有个高亮效果：如下图。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ab01f68d8611c07c996690d10c4f5da2_1737630334097.png" alt="在这里插入图片描述"></p>
<h3 id="如果设置不高亮？"><a href="#如果设置不高亮？" class="headerlink" title="如果设置不高亮？"></a>如果设置不高亮？</h3><p>通过这种方式:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span>&gt;</span>点我点我1<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="如何自定义高亮效果"><a href="#如何自定义高亮效果" class="headerlink" title="如何自定义高亮效果"></a>如何自定义高亮效果</h3><p>我们可以自己定义hover-class的样式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">hover-class</span>=<span class="string">&quot;my-hover&quot;</span>&gt;</span>点我点我<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.my-hover</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a3edfa893b94e51efd653cbddfef536e_1737630334097.png" alt="在这里插入图片描述"></p>
<h3 id="普通元素如何设置高亮"><a href="#普通元素如何设置高亮" class="headerlink" title="普通元素如何设置高亮"></a>普通元素如何设置高亮</h3><p>2种方式，放在导航标签，另一种给元素标签添加cusor:pointer</p>
<p>举例说明:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- cursor pointer 的方式是一个我们发现的一个小技巧，可以让任何袁术点击时高亮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;hover-demo&quot;</span> <span class="attr">src</span>=<span class="string">&quot;../../images/12.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.hover-demo</span>&#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="页面导航api"><a href="#页面导航api" class="headerlink" title="页面导航api"></a>页面导航api</h2><h3 id="wx-navigateTo"><a href="#wx-navigateTo" class="headerlink" title="wx.navigateTo"></a>wx.navigateTo</h3><p>跳转到指定的页面。</p>
<p>demo1.wxml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;tapHandler&quot;</span>&gt;</span>跳转过去<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>demo1.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">tapHandler</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//当我们点击按钮，系统会自动执行这里的代码</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)</span><br><span class="line">    <span class="comment">// wx.navigateTo(&#123;</span></span><br><span class="line">    <span class="comment">//   url: &#x27;../demo2/demo2&#x27;,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 相当于加上redirect的navigator</span></span><br><span class="line">    <span class="comment">// wx.redirectTo(&#123;</span></span><br><span class="line">    <span class="comment">//   url: &#x27;../demo2/demo2&#x27;,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;../demo2/demo2?id=123&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>测试：点击跳转按钮</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d564c2d9a5081084cddd77035f091d52_1737630334097.png" alt="在这里插入图片描述"></p>
<p>显示：跳转到了demo2的页面:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/47d3b0e43ab9c409e530a677204c59a0_1737630334097.png" alt="在这里插入图片描述"></p>
<h3 id="携带参数"><a href="#携带参数" class="headerlink" title="携带参数"></a>携带参数</h3><p>还是刚才的例子，使用问号携带了id&#x3D;123.看下控制台<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2ded3a0f079d4b71a109b04afc9974e3_1737630334097.png" alt="在这里插入图片描述"></p>
<p>显示参数携带过来了。</p>
<h3 id="wx-redirectTo"><a href="#wx-redirectTo" class="headerlink" title="wx.redirectTo"></a>wx.redirectTo</h3><p>导航redirect模式，不能返回原来的页面：</p>
<p>demo.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">tapHandler</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//当我们点击按钮，系统会自动执行这里的代码</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)</span><br><span class="line">    <span class="comment">// wx.navigateTo(&#123;</span></span><br><span class="line">    <span class="comment">//   url: &#x27;../demo2/demo2&#x27;,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 相当于加上redirect的navigator</span></span><br><span class="line">    wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;../demo2/demo2&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// wx.navigateTo(&#123;</span></span><br><span class="line">    <span class="comment">//   url: &#x27;../demo2/demo2?id=123&#x27;,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>看下效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/917a4b3ffc513ffa95c97db013a42476_1737630345103.png" alt="在这里插入图片描述"><br>跳转到了demo2的页面:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f5ff4d25fa5dff9da7b1de2de7537c6a_1737630345103.png" alt="在这里插入图片描述"></p>
<h3 id="wx-navigateBack"><a href="#wx-navigateBack" class="headerlink" title="wx.navigateBack"></a>wx.navigateBack</h3><p>返回到前面的页面。</p>
<ul>
<li><p>指定delta就是返回到指定页面（值为数字，1代表前面的第一个页面，2代表前面的第2个页面）</p>
</li>
<li><p>当delta过大（超出历史记录）。默认返回最开始的页面</p>
<p>举例说明:</p>
<p>在demo3.页面测试</p>
<p>demo3.wxml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pages/demo3/demo3.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>pages/demo3/demo3.wxml<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;backHandler&quot;</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>demo3.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages/demo3/demo3.js</span></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">backHandler</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//默认返回到上一页</span></span><br><span class="line">    <span class="comment">//  wx.navigateBack()</span></span><br><span class="line">    <span class="comment">//指定delta就是返回到指定页面</span></span><br><span class="line">    <span class="comment">//当delta过大（超出历史记录）。默认返回最开始的页面</span></span><br><span class="line">     wx.<span class="title function_">navigateBack</span>(&#123;</span><br><span class="line">       <span class="attr">delta</span>: <span class="number">2</span>,</span><br><span class="line">     &#125;)</span><br><span class="line">     <span class="comment">//wx.navigateTo</span></span><br><span class="line">     <span class="comment">//wx.navigateBack</span></span><br><span class="line">     <span class="comment">//wx.redirectTo</span></span><br><span class="line">     <span class="comment">//传递参数 通过问号  </span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>案例演示:</p>
<p>demo1:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tapHandler</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//当我们点击按钮，系统会自动执行这里的代码</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)</span><br><span class="line">  wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;../demo2/demo2&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/139f52f266d892fae8bd0bfffaeedecd_1737630345103.png" alt="在这里插入图片描述"></p>
<p>点击跳转过去，进入demo2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--pages/demo2/demo2.<span class="property">wxml</span>--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">text</span>&gt;</span>pages/demo2/demo2.wxml<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;../demo3/demo3&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/12.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/38e398e694e31e8805f97f42a625e6be_1737630345103.png" alt="在这里插入图片描述"><br>点击图片进入demo3</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages/demo3/demo3.js</span></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onLoad</span>: <span class="keyword">function</span> (<span class="params">options</span>) &#123;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">backHandler</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//默认返回到上一页</span></span><br><span class="line">    <span class="comment">//  wx.navigateBack()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定delta就是返回到指定页面</span></span><br><span class="line">    <span class="comment">//当delta过大（超出历史记录）。默认返回最开始的页面</span></span><br><span class="line">     wx.<span class="title function_">navigateBack</span>(&#123;</span><br><span class="line">       <span class="attr">delta</span>: <span class="number">2</span>,</span><br><span class="line">     &#125;)</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7c2f71e3ea5b612a86919de1eef1dacd_1737630345103.png" alt="在这里插入图片描述"></p>
<p>点击返回，返回到demo1的页面:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/90ec64fed127841e84cffa1339ebd84b_1737630357680.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(3)%20--%20%E4%BC%B8%E7%BC%A9%E5%B8%83%E5%B1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(3)%20--%20%E4%BC%B8%E7%BC%A9%E5%B8%83%E5%B1%80/" class="post-title-link" itemprop="url">微信小程序学习笔记(3) -- 伸缩布局</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-27 23:23:38" itemprop="dateCreated datePublished" datetime="2020-06-27T23:23:38+08:00">2020-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">微信小程序</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="小程序开发"><a href="#小程序开发" class="headerlink" title="小程序开发"></a>小程序开发</h1><h2 id="伸缩布局"><a href="#伸缩布局" class="headerlink" title="伸缩布局"></a>伸缩布局</h2><h3 id="各个属性介绍"><a href="#各个属性介绍" class="headerlink" title="各个属性介绍"></a>各个属性介绍</h3><ol>
<li><p>flex- direction调整主轴方向(默认为水平方向)</p>
</li>
<li><p>justify-content调整主轴对齐</p>
</li>
<li><p>aligin-items 调整侧轴对齐（子元素可以使用align-self覆盖）</p>
</li>
<li><p>flex-wrap控制是否换行</p>
</li>
<li><p>aligin-content 堆栈（由flex-wrap产生的独立行）对齐</p>
</li>
<li><p>flex-flow是flex-direction+flex-wrap的简写形式</p>
</li>
<li><p>flex是子项目在主轴的缩放比例，不指定flex属性，则不参与伸缩分配</p>
</li>
<li><p>order控制子项目的排列顺序，正序方式排序，从小到大</p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d35fcaf62b84b8bb00ec00208614ebf8_1737630357680.png" alt="在这里插入图片描述"><br>本文主要实现这个页面的布局:</p>
<h3 id="flex基本结构"><a href="#flex基本结构" class="headerlink" title="flex基本结构"></a>flex基本结构</h3><p>flex：1：左侧宽度固定，右侧自动填充的写法:</p>
<p>代码演示:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">	<span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">      1.设计好DOM结构</span></span></span><br><span class="line"><span class="comment"><span class="language-css">      2：将父盒子设置为伸缩盒子</span></span></span><br><span class="line"><span class="comment"><span class="language-css">	*/</span></span></span><br><span class="line"><span class="language-css">	<span class="selector-tag">html</span>,<span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.root</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="comment">/*将付和子设置为伸缩盒子*/</span></span></span><br><span class="line"><span class="language-css">		<span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.sidebar</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">background-color</span>: <span class="number">#ff0</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.content</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/*		width: 300px;*/</span>	</span></span><br><span class="line"><span class="language-css">		<span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">background-color</span>: <span class="number">#e0e0e0</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c1f0e786f208963abf0aa3062f2bfbeb_1737630357680.png" alt="在这里插入图片描述"></p>
<h3 id="flex布局平均分配"><a href="#flex布局平均分配" class="headerlink" title="flex布局平均分配"></a>flex布局平均分配</h3><p>还是利用flex：1.</p>
<p>代码演示:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>flex demo 2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css">	</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.container</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#CCC</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.container</span> <span class="selector-class">.item</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">flex</span>:<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	 <span class="selector-class">.item</span><span class="selector-pseudo">:first-child</span>&#123;</span></span><br><span class="line"><span class="language-css">	 	<span class="attribute">flex</span>: inherit;</span></span><br><span class="line"><span class="language-css">	 &#125;</span></span><br><span class="line"><span class="language-css">	<span class="comment">/*总的份数是4份，每一份占一份*/</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #ff0;width: 200px;&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #f00&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #f0f&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #0ff&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #ffe&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/01e675678de81dd39fae0c09169dbf3f_1737630357680.png" alt="在这里插入图片描述"></p>
<h3 id="调整主轴方向"><a href="#调整主轴方向" class="headerlink" title="调整主轴方向"></a>调整主轴方向</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>flex demo 2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css">	</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.container</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#CCC</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	<span class="selector-class">.container</span> <span class="selector-class">.item</span>&#123;</span></span><br><span class="line"><span class="language-css">		<span class="attribute">flex</span>:<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css">	 <span class="selector-class">.item</span><span class="selector-pseudo">:first-child</span>&#123;</span></span><br><span class="line"><span class="language-css">	 	<span class="attribute">flex</span>: inherit;</span></span><br><span class="line"><span class="language-css">	 &#125;</span></span><br><span class="line"><span class="language-css">	<span class="comment">/*总的份数是4份，每一份占一份*/</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #ff0;width: 200px;&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #f00&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #f0f&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #0ff&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #ffe&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果如下:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/550a0f37b5a7950b22f3ddde23b5735f_1737630357680.png" alt="在这里插入图片描述"></p>
<h3 id="flex布局案例1–固比模型"><a href="#flex布局案例1–固比模型" class="headerlink" title="flex布局案例1–固比模型"></a>flex布局案例1–固比模型</h3><p>步骤:</p>
<ul>
<li><p>1.去掉初始化的无用代码（index文件夹下的js，wxss, wxml）</p>
</li>
<li><p>2.设置index页上的标题头</p>
</li>
<li><p>3.设置固比，固定高度的tabs，和自适应的context</p>
<p>具体代码如下:</p>
</li>
</ul>
<p>在index.json上修改</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Music Player&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#333&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span> </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/20fd0426dcc48108e5b6c333e6ad8b42_1737630370556.png" alt="在这里插入图片描述"><br>设置固比</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标签栏的页签 固定高度--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="attribute">page</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.root</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>效果图:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/25680f88987c2541452bd58040faf469_1737630370556.png" alt="在这里插入图片描述"></p>
<h3 id="flex布局案例2–tab标签栏"><a href="#flex布局案例2–tab标签栏" class="headerlink" title="flex布局案例2–tab标签栏"></a>flex布局案例2–tab标签栏</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标签栏的页签 固定高度--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item active&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>个性推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>主播电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>排行榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="attribute">page</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.root</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span>&#123;</span><br><span class="line">  <span class="comment">/* height: 50px; */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span><span class="selector-class">.active</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="number">#e9232c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>页面效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/818aca43cee234ea9675fc7da37045f2_1737630370556.png" alt="在这里插入图片描述"></p>
<h3 id="flex布局案例3–底部播放条"><a href="#flex布局案例3–底部播放条" class="headerlink" title="flex布局案例3–底部播放条"></a>flex布局案例3–底部播放条</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标签栏的页签 固定高度--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item active&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>个性推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>主播电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>排行榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 播放控制条 固定高度 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;player&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;poster&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/1.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>一生中最爱<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;artist&quot;</span>&gt;</span>谭咏麟<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;controls&quot;</span>&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/11.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/22.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/33.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="attribute">page</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.root</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span>&#123;</span><br><span class="line">  <span class="comment">/* height: 50px; */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span><span class="selector-class">.active</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="number">#e9232c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.player</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.player</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.poster</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#888</span>;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;  </span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.title</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.artist</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.controls</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/acb674e8741a94ef62e3613b27683f4e_1737630370556.png" alt="在这里插入图片描述"></p>
<h3 id="flex布局案例4-—内容区域-自适应高度"><a href="#flex布局案例4-—内容区域-自适应高度" class="headerlink" title="flex布局案例4:—内容区域 自适应高度"></a>flex布局案例4:—内容区域 自适应高度</h3><p>下面实现海报和排行榜:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0c49f714af592aef357f27208bc5aa03_1737630370556.png" alt="在这里插入图片描述"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标签栏的页签 固定高度--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item active&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>个性推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>主播电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>排行榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 录播图 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;slider&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/slide.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 统计 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;portals&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/10.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>私人FM<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/12.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>每日歌曲推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/13.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>云音乐新歌榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 推荐 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 播放控制条 固定高度 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;player&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;poster&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/1.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>一生中最爱<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;artist&quot;</span>&gt;</span>谭咏麟<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;controls&quot;</span>&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/11.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/22.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/33.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> <span class="selector-class">.slider</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">130px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> <span class="selector-class">.portals</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="selector-class">.portals</span>  <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="selector-class">.portals</span>  <span class="selector-class">.item</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> auto;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.portals</span>  <span class="selector-class">.item</span> <span class="selector-tag">text</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="flex布局案例5-–-推荐歌单"><a href="#flex布局案例5-–-推荐歌单" class="headerlink" title="flex布局案例5 – 推荐歌单"></a>flex布局案例5 – 推荐歌单</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/283cf477f37a519908f015ae9aa44773_1737630380761.png" alt="在这里插入图片描述"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标签栏的页签 固定高度--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item active&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>个性推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>主播电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>排行榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span> <span class="attr">scroll-y</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 录播图 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;slider&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/slide.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 统计 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;portals&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/10.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>私人FM<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/12.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>每日歌曲推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/13.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">text</span>&gt;</span>云音乐新歌榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 推荐歌单--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>推荐歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/8.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">text</span>&gt;</span>一生中最爱的是谁谁?<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 播放控制条 固定高度 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;player&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;poster&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/1.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>一生中最爱<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;artist&quot;</span>&gt;</span>谭咏麟<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;controls&quot;</span>&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/11.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/22.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/33.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="attribute">page</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.root</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span>&#123;</span><br><span class="line">  <span class="comment">/* height: 50px; */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.item</span><span class="selector-class">.active</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="number">#e9232c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: scroll;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> <span class="selector-class">.slider</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">130px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> <span class="selector-class">.portals</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="selector-class">.portals</span>  <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="selector-class">.portals</span>  <span class="selector-class">.item</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> auto;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.portals</span>  <span class="selector-class">.item</span> <span class="selector-tag">text</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-class">.title</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-class">.inner</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-class">.inner</span> <span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">33.333333%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-class">.inner</span> <span class="selector-class">.item</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">120px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">120px</span>;</span><br><span class="line">  <span class="attribute">margin</span>:<span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-class">.inner</span> <span class="selector-class">.item</span> <span class="selector-tag">text</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.player</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.player</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.poster</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#888</span>;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;  </span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.title</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.info</span> <span class="selector-class">.artist</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.controls</span> <span class="selector-tag">image</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="flex布局案例6—轮播海报"><a href="#flex布局案例6—轮播海报" class="headerlink" title="flex布局案例6—轮播海报"></a>flex布局案例6—轮播海报</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span> <span class="attr">scroll-y</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 录播图 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;slider&quot;</span> <span class="attr">autoplay</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">block</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/slide.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;../../images/slide.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span>   </span><br><span class="line">       ...</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/86ff9e7ed9bf7616c5e9ba4399c2cc15_1737630380761.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(2)%20--%20%E9%80%BB%E8%BE%91%E5%B1%82%E4%BA%8B%E4%BB%B6%E3%80%81%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/27/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(2)%20--%20%E9%80%BB%E8%BE%91%E5%B1%82%E4%BA%8B%E4%BB%B6%E3%80%81%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" class="post-title-link" itemprop="url">微信小程序学习笔记(2) -- 逻辑层事件、常用组件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-27 23:16:35" itemprop="dateCreated datePublished" datetime="2020-06-27T23:16:35+08:00">2020-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">微信小程序</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="逻辑层"><a href="#逻辑层" class="headerlink" title="逻辑层"></a>逻辑层</h1><h2 id="逻辑层-事件处理"><a href="#逻辑层-事件处理" class="headerlink" title="逻辑层 事件处理"></a>逻辑层 事件处理</h2><ul>
<li>1： 事件的基本使用 bind[xxx] catch[xxx]</li>
<li>2: 小程序中事件冒泡和HTML中处理起来不一样，这里是使用catch[xxx]</li>
<li>3: 如果需要给事件处理函数指定参数 只能通过dataset</li>
</ul>
<p>下面分别来说明:</p>
<h3 id="bindtap"><a href="#bindtap" class="headerlink" title="bindtap"></a>bindtap</h3><blockquote>
<p>基本的事件使用 就是给组件加一个bind+事件名的属性，属性的值指向一个定义在当前页面对象中的一个function.</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;buttonTapHandler&quot;</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">buttonTapHandler</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">123</span>);</span><br><span class="line">    <span class="comment">//console.dir() 将一个对象以树状的形式打印到控制台</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">dir</span>(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/172cb8004ff2541d9a40c7cb574a0a52_1737630380761.png" alt="在这里插入图片描述"></p>
<h3 id="冒泡"><a href="#冒泡" class="headerlink" title="冒泡"></a>冒泡</h3><p>catch+ 事件名: 是阻止冒泡并绑定事件:</p>
<p>案例:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事件冒泡 --&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- catch+ 事件名: 是阻止冒泡并绑定事件 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">view</span> <span class="attr">bindtap</span>=<span class="string">&quot;outterHandler&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:200px;height:200px;background-color:red&quot;</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">view</span> <span class="attr">catchtap</span>=<span class="string">&quot;innerHandler&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100px;height:100px;background-color:blue&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">view</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/53a5dd99b8565a94d94e9ed0d93706ed_1737630380761.png" alt="在这里插入图片描述"></p>
<p>点击 蓝色小方块，冒泡被阻止了–完美。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6348dc47437925d65621491311a2faa6_1737630380761.png" alt="在这里插入图片描述"></p>
<h3 id="事件传参"><a href="#事件传参" class="headerlink" title="事件传参"></a>事件传参</h3><p>如果需要给事件处理函数指定参数 只能通过dataset</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8388e452f0e5b02130b6972605402e51_1737630393762.png" alt="在这里插入图片描述"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事件传参 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;tap2Handle&quot;</span> <span class="attr">data-name</span>=<span class="string">&quot;张三&quot;</span> <span class="attr">data-age</span>=<span class="string">&quot;13&quot;</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;tap2Handle&quot;</span> <span class="attr">data-hello-world</span>=<span class="string">&quot;张三&quot;</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tap2Handle</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="comment">// console.dir(e)</span></span><br><span class="line">  <span class="comment">//dataset指的是元素上所有以data-开头的属性集合</span></span><br><span class="line">  <span class="comment">// console.log(this) //事件处理函数中的this还是页面对象!!!跟html不一样.</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>.<span class="property">dataset</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示效果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/323e77d47ea6356e724b40c90f32f4c8_1737630393762.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2148c5eaea551bb14a6fac393c845768_1737630393762.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/cb011cf5e78625b1ab9e8fa14d366a14_1737630393762.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/13adcca962f9445bf82a37c741a5288f_1737630393762.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>注意: 多个“ - ” 的问题， 会自动转成驼峰的属性。</p>
</blockquote>
<h2 id="单向逻辑流"><a href="#单向逻辑流" class="headerlink" title="单向逻辑流"></a>单向逻辑流</h2><p>小程序没有双向数据绑定。</p>
<blockquote>
<p>this.setData 是用来改变data中的数据<br>它与直接赋值区别在于setData可以通知界面做出变化<br>直接赋值没有办法实现这一点（早期的js）</p>
</blockquote>
<p>解决是:setData.</p>
<p>案例如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; message &#125;&#125;&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;inputHandler&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>:&#123;</span><br><span class="line">      <span class="attr">demo</span>: <span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;initial&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">inputHandler</span>: <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">      <span class="comment">// console.log(123);</span></span><br><span class="line">      <span class="comment">// console.log(e.target);</span></span><br><span class="line">      <span class="comment">// console.log(e);</span></span><br><span class="line">      <span class="comment">// console.log(e.detail.value);</span></span><br><span class="line">      <span class="comment">// this.data.message = e.detail.value;</span></span><br><span class="line">      <span class="comment">// console.log(this.data.message);</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// this.setData 是用来改变data中的数据</span></span><br><span class="line">      <span class="comment">// 它与直接赋值区别在于setData可以通知界面做出变化</span></span><br><span class="line">      <span class="comment">// 直接赋值没有办法实现这一点（早期的js）</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">message</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>页面<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1a27f6da83ef4574634f4724b5eecda7_1737630403909.png" alt="在这里插入图片描述"><br>打印显示:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/242f9c67ad5221509e6be4b563905246_1737630403909.png" alt="在这里插入图片描述"></p>
<p>总结:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2d49b43678777150a66218aa7958688a_1737630403909.png" alt="在这里插入图片描述"></p>
<p>通过这种setData方式，让逻辑层的数据传递到页面层。</p>
<p>页面层的数据传递到逻辑层则是 通过 事件方式。</p>
<h2 id="登录案例"><a href="#登录案例" class="headerlink" title="登录案例"></a>登录案例</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;userinfo&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>  <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; username &#125;&#125;&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;usernameChangeHandler&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;padding-b-20&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">input</span>  <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; password &#125;&#125;&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;passwordChangeHandler&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;loginHandler&quot;</span>&gt;</span>登 录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="selector-class">.userinfo</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span>&#123;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#CCC</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.padding-b-20</span> &#123;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">button</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FFF</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  1.设计数据的结构(data属性)</span></span><br><span class="line"><span class="comment">    2.将数据绑定到特定的元素上</span></span><br><span class="line"><span class="comment">    3.登录按钮的点击事件（具体的登录逻辑）</span></span><br><span class="line"><span class="comment">    4.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;123&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">usernameChangeHandler</span>: <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">   <span class="comment">// this.data.username = e.detail.value; //不要使用这种方式，因为界面层无法判断</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">username</span>: e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">passwordChangeHandler</span>: <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="comment">// this.data.password = e.detail.value; //不要使用这种方式，因为界面层无法判断</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">password</span>: e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//用于处理登录按钮点击事件</span></span><br><span class="line">  <span class="attr">loginHandler</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//TODO :完成逻辑</span></span><br><span class="line">    <span class="comment">//1. 先需要知道用户输入了什么</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">data</span>)</span><br><span class="line">    <span class="comment">//2. 根据用户输入的值判断</span></span><br><span class="line">    <span class="comment">//3. 根据判断的结果做出响应</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>演示效果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9db5494ebad791b035683a21c2be3c70_1737630403909.png" alt="在这里插入图片描述"></p>
<p>看下控制台，是否接收到页面的数据<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/fd4f30486207fd4e3b8c2d660ac82e47_1737630403909.png" alt="在这里插入图片描述"></p>
<h2 id="界面层的条件渲染"><a href="#界面层的条件渲染" class="headerlink" title="界面层的条件渲染"></a>界面层的条件渲染</h2><h3 id="wx-if"><a href="#wx-if" class="headerlink" title="wx:if"></a>wx:if</h3><p>当条件为假得时候是不渲染(这个标签不工作)，为真才渲染</p>
<h3 id="hidden"><a href="#hidden" class="headerlink" title="hidden"></a>hidden</h3><p>  标签仍然会工作，只是不显示在界面上</p>
<p>案例:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toggle&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span>&gt;</span>切换面板展示<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- block 只是控制属性(wx:)的载体，页面渲染过程中没有实际的意义 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123; !show &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- &lt;view class=&quot;content&quot;&gt;</span></span><br><span class="line"><span class="comment">              &lt;text&gt;</span></span><br><span class="line"><span class="comment">                这里是内容....</span></span><br><span class="line"><span class="comment">                  这里是内容....</span></span><br><span class="line"><span class="comment">                    这里是内容....</span></span><br><span class="line"><span class="comment">              &lt;/text&gt;</span></span><br><span class="line"><span class="comment">          &lt;/view&gt;</span></span><br><span class="line"><span class="comment">          &lt;view class=&quot;content&quot; &gt;</span></span><br><span class="line"><span class="comment">              &lt;text&gt;</span></span><br><span class="line"><span class="comment">                这里是内容....</span></span><br><span class="line"><span class="comment">                  这里是内容....</span></span><br><span class="line"><span class="comment">                    这里是内容....</span></span><br><span class="line"><span class="comment">              &lt;/text&gt;</span></span><br><span class="line"><span class="comment">          &lt;/view&gt; --&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- wx:if 当条件为假得时候是不渲染(这个标签不工作) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123; !show &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">                这里是内容....</span><br><span class="line">                  这里是内容....</span><br><span class="line">                    这里是内容....</span><br><span class="line">              <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span> </span><br><span class="line">          -----</span><br><span class="line">       <span class="comment">&lt;!-- hidden 标签仍然会工作，只是不显示在界面上  --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span> <span class="attr">hidden</span>=<span class="string">&quot;&#123;&#123; !show &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">                这里是内容....</span><br><span class="line">                  这里是内容....</span><br><span class="line">                    这里是内容....</span><br><span class="line">              <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>  </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//事件处理函数</span></span><br><span class="line">  <span class="attr">toggle</span>: <span class="keyword">function</span>(<span class="params">e</span>)&#123; </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">show</span>: !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">show</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>效果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a293d3cb79b08a577b436ac294c6e44a_1737630414384.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/da08bc87f154478efd440d51b2fb5911_1737630414384.png" alt="在这里插入图片描述"></p>
<h3 id="block"><a href="#block" class="headerlink" title="block"></a>block</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- block 只是控制属性(wx:)的载体，页面渲染过程中没有实际的意义 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123; !show &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">            这里是内容....</span><br><span class="line">              这里是内容....</span><br><span class="line">                这里是内容....</span><br><span class="line">          <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span> &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">            这里是内容....</span><br><span class="line">              这里是内容....</span><br><span class="line">                这里是内容....</span><br><span class="line">          <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="wxss和css的区别"><a href="#wxss和css的区别" class="headerlink" title="wxss和css的区别"></a>wxss和css的区别</h2><ol>
<li>rpt的单位，750rpt代表宽度100%</li>
<li>@import引入其他的样式。但是只是加载一次。css会发起多个请求。</li>
</ol>
<h1 id="微信ui组件"><a href="#微信ui组件" class="headerlink" title="微信ui组件"></a>微信ui组件</h1><h2 id="icon组件"><a href="#icon组件" class="headerlink" title="icon组件"></a>icon组件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- icon text process--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- icon的类型，有效值：success, success_no_circle, info, warn, waiting, cancel, download, search, clear --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- type用于定义图标类型，只能是规定范围的类型， 除了这些内置图标，其他图标必须通过图片方式使用 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;success_no_circle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;warn&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;waiting&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;cancel&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;download&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;search&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;clear&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- size用于指定图标大小， 默认23，单位是px --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> <span class="attr">size</span>=<span class="string">&quot;60&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- color用于指定图标颜色，取值就是css颜色取值 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">icon</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">size</span>=<span class="string">&quot;60&quot;</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">icon</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4fddc94680be83b1aab338fcf2590870_1737630414384.png" alt="在这里插入图片描述"></p>
<h2 id="text组件"><a href="#text组件" class="headerlink" title="text组件"></a>text组件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- text类似于html中的p标签，但是p标签不能嵌套 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- text主要是为了可以很好的控制页面的内容 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- text标签还支持换行 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>这是一段<span class="tag">&lt;<span class="name">text</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">text</span>&gt;</span>标签<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">这是一段没有被text包裹的文本</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/032fe47b38214fb500d5cdccbe8bd156_1737630414384.png" alt="在这里插入图片描述"></p>
<h2 id="progress-进度条"><a href="#progress-进度条" class="headerlink" title="progress 进度条"></a>progress 进度条</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 显示一个进度条 percent是0-100的值--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- show-info是用来控制是否显示具体数值的属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">progress</span> <span class="attr">percent</span>=<span class="string">&quot;20&quot;</span> <span class="attr">show-info</span>=<span class="string">&quot;true&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;10&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- active显示从左到右的动画 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">progress</span> <span class="attr">percent</span>=<span class="string">&quot;30&quot;</span> <span class="attr">show-info</span>=<span class="string">&quot;true&quot;</span>  <span class="attr">active</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/dcd643fa8043f836132c393525bc0693_1737630414384.png" alt="在这里插入图片描述"></p>
<h2 id="表单组件"><a href="#表单组件" class="headerlink" title="表单组件"></a>表单组件</h2><h3 id="button"><a href="#button" class="headerlink" title="button"></a>button</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- type是用来控制按钮的类型，只有三种，primary，default，warn --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;default&quot;</span>&gt;</span>这是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- size控制大小 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span>&gt;</span>这是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- plain 镂空 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">plain</span>&gt;</span>这是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- loading 加载，前面会有个转圈的菊花 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">loading</span>&gt;</span>这是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- form-type  submit提交表单 reset重置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">form-type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>这是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- hover指的是按下，hover-class指的就是按下过后的作用class --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">hover-class</span>=<span class="string">&quot;btn-active&quot;</span>&gt;</span>hover class<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**index.wxss**/</span></span><br><span class="line"><span class="selector-class">.btn-active</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/47fb4af32b906253498a861dffae73b9_1737630423907.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/bae92d036329e7f97edc1a55fed0b730_1737630423907.png" alt="在这里插入图片描述"></p>
<h3 id="radio"><a href="#radio" class="headerlink" title="radio"></a>radio</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">radio-group</span> <span class="attr">bindchange</span>=<span class="string">&quot;bindchangeHandle&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">radio</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span></span><br><span class="line">        男</span><br><span class="line">    <span class="tag">&lt;/<span class="name">radio</span>&gt;</span>   </span><br><span class="line">      <span class="tag">&lt;<span class="name">radio</span>  <span class="attr">value</span>=<span class="string">&quot;female&quot;</span> &gt;</span></span><br><span class="line">        女</span><br><span class="line">    <span class="tag">&lt;/<span class="name">radio</span>&gt;</span>      </span><br><span class="line"><span class="tag">&lt;/<span class="name">radio-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>您选中的是： &#123;&#123;gender&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 页面的初始数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">  <span class="attr">gender</span>:<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">bindchangeHandle</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>( e.<span class="property">detail</span>.<span class="property">value</span>);</span><br><span class="line">  <span class="keyword">let</span> gender =  e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    gender</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f256d5a70d529dcb8202b27e63ce2645_1737630423907.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c1169e7b7040362a693364894af9b114_1737630423907.png" alt="在这里插入图片描述"></p>
<h3 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">items</span>: [</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;USA&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;美国&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;CHN&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;中国&#x27;</span>, <span class="attr">checked</span>: <span class="string">&#x27;true&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;BRA&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;巴西&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;JPN&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;日本&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;ENG&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;英国&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">value</span>: <span class="string">&#x27;FRA&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;法国&#x27;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">checkboxChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;checkbox发生change事件，携带value值为：&#x27;</span>, e.<span class="property">detail</span>.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> items = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">items</span></span><br><span class="line">    <span class="keyword">const</span> values = e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, lenI = items.<span class="property">length</span>; i &lt; lenI; ++i) &#123;</span><br><span class="line">      items[i].<span class="property">checked</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>, lenJ = values.<span class="property">length</span>; j &lt; lenJ; ++j) &#123;</span><br><span class="line">        <span class="keyword">if</span> (items[i].<span class="property">value</span> === values[j]) &#123;</span><br><span class="line">          items[i].<span class="property">checked</span> = <span class="literal">true</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      items</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">checkbox-group</span> <span class="attr">bindchange</span>=<span class="string">&quot;checkboxChange&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;items&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;item.value&#125;&#125;&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&#123;&#123;item.checked&#125;&#125;&quot;</span>/&gt;</span>&#123;&#123;item.name&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">checkbox-group</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b4b44caf900253b86fe6d975fdd2cc71_1737630423907.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a8084ebc347db46b8afa2629d7a6252d_1737630436010.png" alt="在这里插入图片描述"></p>
<h3 id="input"><a href="#input" class="headerlink" title="input"></a>input</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;input1&quot;</span>  <span class="attr">placeholder-class</span>=<span class="string">&quot;input-placeholder&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.input1</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#c0c0c0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/06e2ea88db4867a33607ef83ec7bc2e0_1737630436010.png" alt="在这里插入图片描述"></p>
<h1 id="操作反馈组件"><a href="#操作反馈组件" class="headerlink" title="操作反馈组件"></a>操作反馈组件</h1><h2 id="action-sheet"><a href="#action-sheet" class="headerlink" title="action-sheet"></a>action-sheet</h2><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showActionSheet.html">https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showActionSheet.html</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">btnToDo</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="comment">//当点击按钮触发</span></span><br><span class="line">      <span class="comment">// console.log(111)</span></span><br><span class="line">      <span class="comment">//交互操作组件必须通过调用API的方式使用</span></span><br><span class="line">      <span class="comment">// https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showActionSheet.html</span></span><br><span class="line">      wx.<span class="title function_">showActionSheet</span>(&#123;</span><br><span class="line">        <span class="comment">//显示出来的项目列表</span></span><br><span class="line">        <span class="attr">itemList</span>: [<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;大数据&#x27;</span>, <span class="string">&#x27;小程序&#x27;</span>,<span class="string">&#x27;APP&#x27;</span>],</span><br><span class="line">        <span class="comment">//点击其中任一项的回调</span></span><br><span class="line">        <span class="title function_">success</span> (res) &#123;</span><br><span class="line">          <span class="comment">//res.cancel 指的是否点击取消</span></span><br><span class="line">          <span class="keyword">if</span>(!res.<span class="property">cancel</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">tapIndex</span>)</span><br><span class="line">          &#125;         </span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">fail</span> (res) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">errMsg</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>效果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/35b88927608fbfc3f9815b6c03ef7d8f_1737630436010.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f574d5bc65685ad32b644c07b60d8d34_1737630436010.png" alt="在这里插入图片描述"></p>
<h2 id="model-模态框"><a href="#model-模态框" class="headerlink" title="model 模态框"></a>model 模态框</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">showModal</span>(&#123;</span><br><span class="line">   <span class="attr">title</span>: <span class="string">&#x27;提示&#x27;</span>,</span><br><span class="line">   <span class="attr">content</span>: <span class="string">&#x27;这是一个模态弹窗&#x27;</span>,</span><br><span class="line">   <span class="title function_">success</span> (res) &#123;</span><br><span class="line">     <span class="keyword">if</span> (res.<span class="property">confirm</span>) &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;用户点击确定&#x27;</span>)</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">cancel</span>) &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;用户点击取消&#x27;</span>)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/74e428a0084c22fec6ed3aaf3cd74c43_1737630436010.png" alt="在这里插入图片描述"></p>
<h2 id="toast"><a href="#toast" class="headerlink" title="toast"></a>toast</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">   <span class="attr">title</span>: <span class="string">&#x27;成功&#x27;</span>,</span><br><span class="line">   <span class="attr">icon</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">   <span class="attr">duration</span>: <span class="number">2000</span></span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p>点击</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d383535cf770ef2ee1f97e39d486eda3_1737630446214.png" alt="在这里插入图片描述"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">   <span class="attr">title</span>: <span class="string">&#x27;加载中&#x27;</span>,</span><br><span class="line">   <span class="comment">// icon: &#x27;success&#x27;,</span></span><br><span class="line">   <span class="attr">icon</span>: <span class="string">&#x27;loading&#x27;</span>,</span><br><span class="line">   <span class="attr">duration</span>: <span class="number">2000</span></span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d2fdcff3a085f695847719b279e7b008_1737630446214.png" alt="在这里插入图片描述"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="组件的基本用法："><a href="#组件的基本用法：" class="headerlink" title="组件的基本用法："></a>组件的基本用法：</h3><ul>
<li><p>语法问题:</p>
<p>组件的使用类似于html的方式（有不同），组件使用的严格的XML标准(开闭标签问题)</p>
</li>
</ul>
<h3 id="组件的分类"><a href="#组件的分类" class="headerlink" title="组件的分类"></a>组件的分类</h3><ul>
<li>功能性的组件<ul>
<li>完成具体功能的</li>
</ul>
</li>
<li>布局类型的组件<ul>
<li>用来完成页面结构的(DIV)</li>
</ul>
</li>
<li>API类型(使用的角度)<ul>
<li>wx.showModel</li>
<li>wx.showActionSheet</li>
<li>wx.showToast</li>
</ul>
</li>
</ul>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/18/%E6%89%8B%E5%86%99springmvc%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/18/%E6%89%8B%E5%86%99springmvc%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC2/" class="post-title-link" itemprop="url">手写springmvc框架版本2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-18 22:35:57" itemprop="dateCreated datePublished" datetime="2020-06-18T22:35:57+08:00">2020-06-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F-%E6%BA%90%E7%A0%81/" itemprop="url" rel="index"><span itemprop="name">spring家族 源码</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[toc]<br>上一篇文章，简单写了一个版本，但是有诸多问题，如map既有bean，又有url和方法的映射，还有各种包下的所有java类，很凌乱；<br>而且参数映射是写死的。这个版本改写DispatcherServle.</p>
<p>具体代码如下：方便以后自己多多琢磨:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hfl.mvcframework.servlet.v2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hfl.mvcframework.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Tom on 2019/3/24.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HfDispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存application.properties配置文件中的内容</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Properties</span> <span class="variable">contextConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存扫描的所有的类名</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; classNames = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传说中的IOC容器，我们来揭开它的神秘面纱</span></span><br><span class="line">    <span class="comment">//为了简化程序，暂时不考虑ConcurrentHashMap</span></span><br><span class="line">    <span class="comment">// 主要还是关注设计思想和原理</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; ioc = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存url和Method的对应关系</span></span><br><span class="line"><span class="comment">//    private Map&lt;String,Method&gt; handlerMapping = new HashMap&lt;String,Method&gt;();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//思考：为什么不用Map</span></span><br><span class="line">    <span class="comment">//你用Map的话，key，只能是url</span></span><br><span class="line">    <span class="comment">//Handler 本身的功能就是把url和method对应关系，已经具备了Map的功能</span></span><br><span class="line">    <span class="comment">//根据设计原则：冗余的感觉了，单一职责，最少知道原则，帮助我们更好的理解</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Handler&gt; handlerMapping = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Handler&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doPost(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6、调用，运行阶段</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            doDispatch(req,resp);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;500 Exection,Detail : &quot;</span> + Arrays.toString(e.getStackTrace()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Handler</span> <span class="variable">handler</span> <span class="operator">=</span> getHandler(req);</span><br><span class="line">        <span class="keyword">if</span>(handler == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="comment">//        if(!this.handlerMapping.containsKey(url))&#123;</span></span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;404 Not Found!!!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得方法的形参列表</span></span><br><span class="line">        Class&lt;?&gt; [] paramTypes = handler.getParamTypes();</span><br><span class="line"></span><br><span class="line">        Object [] paramValues = <span class="keyword">new</span> <span class="title class_">Object</span>[paramTypes.length];</span><br><span class="line"></span><br><span class="line">        Map&lt;String,String[]&gt; params = req.getParameterMap();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String[]&gt; parm : params.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> Arrays.toString(parm.getValue()).replaceAll(<span class="string">&quot;\\[|\\]&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">                    .replaceAll(<span class="string">&quot;\\s&quot;</span>,<span class="string">&quot;,&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!handler.paramIndexMapping.containsKey(parm.getKey()))&#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> handler.paramIndexMapping.get(parm.getKey());</span><br><span class="line">            paramValues[index] = convert(paramTypes[index],value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(handler.paramIndexMapping.containsKey(HttpServletRequest.class.getName())) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">reqIndex</span> <span class="operator">=</span> handler.paramIndexMapping.get(HttpServletRequest.class.getName());</span><br><span class="line">            paramValues[reqIndex] = req;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(handler.paramIndexMapping.containsKey(HttpServletResponse.class.getName())) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">respIndex</span> <span class="operator">=</span> handler.paramIndexMapping.get(HttpServletResponse.class.getName());</span><br><span class="line">            paramValues[respIndex] = resp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> handler.method.invoke(handler.controller,paramValues);</span><br><span class="line">        <span class="keyword">if</span>(returnValue == <span class="literal">null</span> || returnValue <span class="keyword">instanceof</span> Void)&#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        resp.getWriter().write(returnValue.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Handler <span class="title function_">getHandler</span><span class="params">(HttpServletRequest req)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(handlerMapping.isEmpty())&#123;<span class="keyword">return</span> <span class="literal">null</span>;&#125;</span><br><span class="line">        <span class="comment">//绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> req.getRequestURI();</span><br><span class="line">        <span class="comment">//处理成相对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> req.getContextPath();</span><br><span class="line">        url = url.replaceAll(contextPath,<span class="string">&quot;&quot;</span>).replaceAll(<span class="string">&quot;/+&quot;</span>,<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Handler handler : <span class="built_in">this</span>.handlerMapping) &#123;</span><br><span class="line">            <span class="type">Matcher</span> <span class="variable">matcher</span> <span class="operator">=</span> handler.getPattern().matcher(url);</span><br><span class="line">            <span class="keyword">if</span>(!matcher.matches())&#123; <span class="keyword">continue</span>;&#125;</span><br><span class="line">            <span class="keyword">return</span> handler;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//url传过来的参数都是String类型的，HTTP是基于字符串协议</span></span><br><span class="line">    <span class="comment">//只需要把String转换为任意类型就好</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">convert</span><span class="params">(Class&lt;?&gt; type,String value)</span>&#123;</span><br><span class="line">        <span class="comment">//如果是int</span></span><br><span class="line">        <span class="keyword">if</span>(Integer.class == type)&#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.valueOf(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Double.class == type)&#123;</span><br><span class="line">            <span class="keyword">return</span> Double.valueOf(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果还有double或者其他类型，继续加if</span></span><br><span class="line">        <span class="comment">//这时候，我们应该想到策略模式了</span></span><br><span class="line">        <span class="comment">//在这里暂时不实现，希望小伙伴自己来实现</span></span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化阶段</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、加载配置文件</span></span><br><span class="line">        doLoadConfig(config.getInitParameter(<span class="string">&quot;contextConfigLocation&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、扫描相关的类</span></span><br><span class="line">        doScanner(contextConfig.getProperty(<span class="string">&quot;scanPackage&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、初始化扫描到的类，并且将它们放入到ICO容器之中</span></span><br><span class="line">        doInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、完成依赖注入</span></span><br><span class="line">        doAutowired();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5、初始化HandlerMapping</span></span><br><span class="line">        initHandlerMapping();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Hf Spring framework is init.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化url和Method的一对一对应关系</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initHandlerMapping</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(ioc.isEmpty())&#123; <span class="keyword">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : ioc.entrySet()) &#123;</span><br><span class="line">            Class&lt;?&gt; clazz = entry.getValue().getClass();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!clazz.isAnnotationPresent(HfController.class))&#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">//保存写在类上面的@HfRequestMapping(&quot;/demo&quot;)</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">baseUrl</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(clazz.isAnnotationPresent(HfRequestMapping.class))&#123;</span><br><span class="line">                <span class="type">HfRequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> clazz.getAnnotation(HfRequestMapping.class);</span><br><span class="line">                baseUrl = requestMapping.value();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//默认获取所有的public方法</span></span><br><span class="line">            <span class="keyword">for</span> (Method method : clazz.getMethods()) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!method.isAnnotationPresent(HfRequestMapping.class))&#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">HfRequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> method.getAnnotation(HfRequestMapping.class);</span><br><span class="line">                <span class="comment">//优化</span></span><br><span class="line">                <span class="comment">// //demo///query</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">regex</span> <span class="operator">=</span> (<span class="string">&quot;/&quot;</span> + baseUrl + <span class="string">&quot;/&quot;</span> + requestMapping.value())</span><br><span class="line">                        .replaceAll(<span class="string">&quot;/+&quot;</span>,<span class="string">&quot;/&quot;</span>);</span><br><span class="line">                <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regex);</span><br><span class="line">                <span class="built_in">this</span>.handlerMapping.add(<span class="keyword">new</span> <span class="title class_">Handler</span>(pattern,entry.getValue(),method));</span><br><span class="line"><span class="comment">//                handlerMapping.put(url,method);</span></span><br><span class="line">                System.out.println(<span class="string">&quot;Mapped :&quot;</span> + pattern + <span class="string">&quot;,&quot;</span> + method);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自动依赖注入</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doAutowired</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(ioc.isEmpty())&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : ioc.entrySet()) &#123;</span><br><span class="line">            <span class="comment">//Declared 所有的，特定的 字段，包括private/protected/default</span></span><br><span class="line">            <span class="comment">//正常来说，普通的OOP编程只能拿到public的属性</span></span><br><span class="line">            Field[] fields = entry.getValue().getClass().getDeclaredFields();</span><br><span class="line">            <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!field.isAnnotationPresent(HfAutowired.class))&#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line">                <span class="type">HfAutowired</span> <span class="variable">autowired</span> <span class="operator">=</span> field.getAnnotation(HfAutowired.class);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果用户没有自定义beanName，默认就根据类型注入</span></span><br><span class="line">                <span class="comment">//这个地方省去了对类名首字母小写的情况的判断，这个作为课后作业</span></span><br><span class="line">                <span class="comment">//小伙伴们自己去完善</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> autowired.value().trim();</span><br><span class="line">                <span class="keyword">if</span>(<span class="string">&quot;&quot;</span>.equals(beanName))&#123;</span><br><span class="line">                    <span class="comment">//获得接口的类型，作为key待会拿这个key到ioc容器中去取值</span></span><br><span class="line">                    beanName = field.getType().getName();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果是public以外的修饰符，只要加了@Autowired注解，都要强制赋值</span></span><br><span class="line">                <span class="comment">//反射中叫做暴力访问， 强吻</span></span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//用反射机制，动态给字段赋值</span></span><br><span class="line">                    field.set(entry.getValue(),ioc.get(beanName));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//初始化，为DI做准备</span></span><br><span class="line">        <span class="keyword">if</span>(classNames.isEmpty())&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (String className : classNames) &#123;</span><br><span class="line">                Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//什么样的类才需要初始化呢？</span></span><br><span class="line">                <span class="comment">//加了注解的类，才初始化，怎么判断？</span></span><br><span class="line">                <span class="comment">//为了简化代码逻辑，主要体会设计思想，只举例 @Controller和@Service,</span></span><br><span class="line">                <span class="comment">// @Componment...就一一举例了</span></span><br><span class="line">                <span class="keyword">if</span>(clazz.isAnnotationPresent(HfController.class))&#123;</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">instance</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                    <span class="comment">//Spring默认类名首字母小写</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> toLowerFirstCase(clazz.getSimpleName());</span><br><span class="line">                    ioc.put(beanName,instance);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(clazz.isAnnotationPresent(HfService.class))&#123;</span><br><span class="line">                    <span class="comment">//1、自定义的beanName</span></span><br><span class="line">                    <span class="type">HfService</span> <span class="variable">service</span> <span class="operator">=</span> clazz.getAnnotation(HfService.class);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> service.value();</span><br><span class="line">                    <span class="comment">//2、默认类名首字母小写</span></span><br><span class="line">                    <span class="keyword">if</span>(<span class="string">&quot;&quot;</span>.equals(beanName.trim()))&#123;</span><br><span class="line">                        beanName = toLowerFirstCase(clazz.getSimpleName());</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">instance</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                    ioc.put(beanName,instance);</span><br><span class="line">                    <span class="comment">//3、根据类型自动赋值,投机取巧的方式</span></span><br><span class="line">                    <span class="keyword">for</span> (Class&lt;?&gt; i : clazz.getInterfaces()) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(ioc.containsKey(i.getName()))&#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;The “&quot;</span> + i.getName() + <span class="string">&quot;” is exists!!&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">//把接口的类型直接当成key了</span></span><br><span class="line">                        ioc.put(i.getName(),instance);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果类名本身是小写字母，确实会出问题</span></span><br><span class="line">    <span class="comment">//但是我要说明的是：这个方法是我自己用，private的</span></span><br><span class="line">    <span class="comment">//传值也是自己传，类也都遵循了驼峰命名法</span></span><br><span class="line">    <span class="comment">//默认传入的值，存在首字母小写的情况，也不可能出现非字母的情况</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//为了简化程序逻辑，就不做其他判断了，大家了解就OK</span></span><br><span class="line">    <span class="comment">//其实用写注释的时间都能够把逻辑写完了</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">toLowerFirstCase</span><span class="params">(String simpleName)</span> &#123;</span><br><span class="line">        <span class="type">char</span> [] chars = simpleName.toCharArray();</span><br><span class="line">        <span class="comment">//之所以加，是因为大小写字母的ASCII码相差32，</span></span><br><span class="line">        <span class="comment">// 而且大写字母的ASCII码要小于小写字母的ASCII码</span></span><br><span class="line">        <span class="comment">//在Java中，对char做算学运算，实际上就是对ASCII码做算学运算</span></span><br><span class="line">        chars[<span class="number">0</span>] += <span class="number">32</span>;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(chars);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//扫描出相关的类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doScanner</span><span class="params">(String scanPackage)</span> &#123;</span><br><span class="line">        <span class="comment">//scanPackage = com.gupaoedu.demo ，存储的是包路径</span></span><br><span class="line">        <span class="comment">//转换为文件路径，实际上就是把.替换为/就OK了</span></span><br><span class="line">        <span class="comment">//classpath</span></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader().getResource(<span class="string">&quot;/&quot;</span> + scanPackage.replaceAll(<span class="string">&quot;\\.&quot;</span>,<span class="string">&quot;/&quot;</span>));</span><br><span class="line">        <span class="type">File</span> <span class="variable">classPath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url.getFile());</span><br><span class="line">        <span class="keyword">for</span> (File file : classPath.listFiles()) &#123;</span><br><span class="line">            <span class="keyword">if</span>(file.isDirectory())&#123;</span><br><span class="line">                doScanner(scanPackage + <span class="string">&quot;.&quot;</span> + file.getName());</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!file.getName().endsWith(<span class="string">&quot;.class&quot;</span>))&#123; <span class="keyword">continue</span>;&#125;</span><br><span class="line">                <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> (scanPackage + <span class="string">&quot;.&quot;</span> + file.getName().replace(<span class="string">&quot;.class&quot;</span>,<span class="string">&quot;&quot;</span>));</span><br><span class="line">                classNames.add(className);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//加载配置文件</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doLoadConfig</span><span class="params">(String contextConfigLocation)</span> &#123;</span><br><span class="line">        <span class="comment">//直接从类路径下找到Spring主配置文件所在的路径</span></span><br><span class="line">        <span class="comment">//并且将其读取出来放到Properties对象中</span></span><br><span class="line">        <span class="comment">//相对于scanPackage=com.gupaoedu.demo 从文件中保存到了内存中</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader().getResourceAsStream(contextConfigLocation);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            contextConfig.load(fis);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != fis)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fis.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存一个url和一个Method的关系</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">        <span class="comment">//必须把url放到HandlerMapping才好理解吧</span></span><br><span class="line">        <span class="keyword">private</span> Pattern pattern;  <span class="comment">//正则</span></span><br><span class="line">        <span class="keyword">private</span> Method method;</span><br><span class="line">        <span class="keyword">private</span> Object controller;</span><br><span class="line">        <span class="keyword">private</span> Class&lt;?&gt; [] paramTypes;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Pattern <span class="title function_">getPattern</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> pattern;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Method <span class="title function_">getMethod</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> method;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">getController</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> controller;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Class&lt;?&gt;[] getParamTypes() &#123;</span><br><span class="line">            <span class="keyword">return</span> paramTypes;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//形参列表</span></span><br><span class="line">        <span class="comment">//参数的名字作为key,参数的顺序，位置作为值</span></span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,Integer&gt; paramIndexMapping;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Handler</span><span class="params">(Pattern pattern, Object controller, Method method)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.pattern = pattern;</span><br><span class="line">            <span class="built_in">this</span>.method = method;</span><br><span class="line">            <span class="built_in">this</span>.controller = controller;</span><br><span class="line"></span><br><span class="line">            paramTypes = method.getParameterTypes();</span><br><span class="line"></span><br><span class="line">            paramIndexMapping = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Integer&gt;();</span><br><span class="line">            putParamIndexMapping(method);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">putParamIndexMapping</span><span class="params">(Method method)</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//提取方法中加了注解的参数</span></span><br><span class="line">            <span class="comment">//把方法上的注解拿到，得到的是一个二维数组</span></span><br><span class="line">            <span class="comment">//因为一个参数可以有多个注解，而一个方法又有多个参数</span></span><br><span class="line">            Annotation [] [] pa = method.getParameterAnnotations();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; pa.length ; i ++) &#123;</span><br><span class="line">                <span class="keyword">for</span>(Annotation a : pa[i])&#123;</span><br><span class="line">                    <span class="keyword">if</span>(a <span class="keyword">instanceof</span> HfRequestParam)&#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">paramName</span> <span class="operator">=</span> ((HfRequestParam) a).value();</span><br><span class="line">                        <span class="keyword">if</span>(!<span class="string">&quot;&quot;</span>.equals(paramName.trim()))&#123;</span><br><span class="line">                            paramIndexMapping.put(paramName, i);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//提取方法中的request和response参数</span></span><br><span class="line">            Class&lt;?&gt; [] paramsTypes = method.getParameterTypes();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; paramsTypes.length ; i ++) &#123;</span><br><span class="line">                Class&lt;?&gt; type = paramsTypes[i];</span><br><span class="line">                <span class="keyword">if</span>(type == HttpServletRequest.class ||</span><br><span class="line">                        type == HttpServletResponse.class)&#123;</span><br><span class="line">                    paramIndexMapping.put(type.getName(),i);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>




<p>其他步骤和上篇文章一样。</p>
<h1 id="测试下"><a href="#测试下" class="headerlink" title="测试下:"></a>测试下:</h1><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0464546780555bb83d1cae4fcd58510a_1737630517903.png" alt="在这里插入图片描述"></p>
<p>效果如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9b187252d2f59baa61608e6011e479ed_1737630517903.png" alt="在这里插入图片描述"><br>成功。</p>
<hr>
<p>这个代码主要学习了委派模式转发请求，策略模式封装url和方法的映射。初始化参数中形参列表的设计和请求时的赋值技巧。</p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/18/%E4%B9%A6%E5%86%99%E7%AE%80%E6%98%93spring%20mvc%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/18/%E4%B9%A6%E5%86%99%E7%AE%80%E6%98%93spring%20mvc%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC1/" class="post-title-link" itemprop="url">书写简易spring mvc框架版本1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-18 20:16:51" itemprop="dateCreated datePublished" datetime="2020-06-18T20:16:51+08:00">2020-06-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<blockquote>
<p>springmvc简易框架（项目中肯定不能用，只是为了了解原理)的实现思路如下:</p>
</blockquote>
<h1 id="手写spring框架"><a href="#手写spring框架" class="headerlink" title="手写spring框架"></a>手写spring框架</h1><h2 id="1-配置阶段"><a href="#1-配置阶段" class="headerlink" title="1.配置阶段"></a>1.配置阶段</h2><ul>
<li>配置web.xml DispatcherServlet</li>
<li>设定init-param contextConfigLoacation &#x3D; classpath:application.xml</li>
<li>设定url-pattern &#x2F;*</li>
<li>配置Annotation @Controller @Service @Autowirted @RequestMapping …</li>
</ul>
<h2 id="2-初始化阶段"><a href="#2-初始化阶段" class="headerlink" title="2.初始化阶段"></a>2.初始化阶段</h2><ul>
<li>调用init()方法 加载配置文件</li>
<li>IOC容器初始化 Map&lt;String,Object&gt;</li>
<li>扫描相关的类 scan-package&#x3D;“com.hfl.demo”</li>
<li>ioc:创建实例化并保存至容器 通过反射机制将类实例化放入IOC容器中</li>
<li>DI:进行DI操作:扫描IOC容器中的实例，给没有赋值的属性自动赋值</li>
</ul>
<h2 id="3-运行阶段"><a href="#3-运行阶段" class="headerlink" title="3.运行阶段"></a>3.运行阶段</h2><ul>
<li>调用doPost()&#x2F;doGet()  - Web容器调用doPost&#x2F;doGet方法，获得request&#x2F;response对象</li>
<li>匹配HandlerMapping - 从request对象中获得用户输入的url，找到其对应的Method</li>
<li>反射调用method.invoker() - 利用反射调用方法并返回结果</li>
<li>response.getWrite().write - 将返回结果输出到浏览器</li>
</ul>
<h1 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h1><h2 id="1-配置阶段-1"><a href="#1-配置阶段-1" class="headerlink" title="1.配置阶段"></a>1.配置阶段</h2><p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Gupao Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hflmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.hfl.mvcframework.servlet.v1.HfDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>application.properties<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hflmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>包结构:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3e91dc5f37790beec522a9b0aa928d8f_1737630517903.png" alt="在这里插入图片描述"><br>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scanPackage</span>=<span class="string">com.hfl.demo</span></span><br></pre></td></tr></table></figure>

<p>配置注解<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c561f364af0d20778561b5793fdc36bd_1737630517903.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> HfAutowired &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其他注解类相同，只是注解名不一样.</p>
<h2 id="初始化阶段"><a href="#初始化阶段" class="headerlink" title="初始化阶段"></a>初始化阶段</h2><p>HfDispatcherServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hfl.mvcframework.servlet.v1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hfl.mvcframework.annotation.HfAutowired;</span><br><span class="line"><span class="keyword">import</span> com.hfl.mvcframework.annotation.HfController;</span><br><span class="line"><span class="keyword">import</span> com.hfl.mvcframework.annotation.HfRequestMapping;</span><br><span class="line"><span class="keyword">import</span> com.hfl.mvcframework.annotation.HfService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: HfDispatcherServlet</span></span><br><span class="line"><span class="comment"> * Description: TODO</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-06-17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//所有的核心逻辑全部写在一个init()方法中。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HfDispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; mapping = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">//读取初始化参数中的 配置文件信息（为了获取扫描的基础包名）</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">configContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            is = <span class="built_in">this</span>.getClass().getClassLoader().getResourceAsStream(config.getInitParameter(<span class="string">&quot;contextConfigLocation&quot;</span>));</span><br><span class="line">            configContext.load(is);</span><br><span class="line">            <span class="type">String</span> <span class="variable">scanPackage</span> <span class="operator">=</span> configContext.getProperty(<span class="string">&quot;scanPackage&quot;</span>);</span><br><span class="line">            <span class="comment">// 扫描包下的类 加入容器中</span></span><br><span class="line">            doScanner(scanPackage);</span><br><span class="line">            <span class="comment">//注入bean带注解的bean 并初始化</span></span><br><span class="line">            <span class="keyword">for</span> (String className : mapping.keySet()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!className.contains(<span class="string">&quot;.&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">                <span class="comment">//将&lt;url，method&gt;加入到mapping中</span></span><br><span class="line">                <span class="keyword">if</span> (clazz.isAnnotationPresent(HfController.class)) &#123;</span><br><span class="line">                    mapping.put(className, clazz.newInstance());</span><br><span class="line">                    <span class="type">String</span> <span class="variable">baseUrl</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span> (clazz.isAnnotationPresent(HfRequestMapping.class)) &#123;</span><br><span class="line">                        <span class="type">HfRequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> clazz.getAnnotation(HfRequestMapping.class);</span><br><span class="line">                        baseUrl = requestMapping.value();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//如果controller下的方法有 路径，则拼接到 map的value中去</span></span><br><span class="line">                    Method[] methods = clazz.getMethods();</span><br><span class="line">                    <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!method.isAnnotationPresent(HfRequestMapping.class)) &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="type">HfRequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> method.getAnnotation(HfRequestMapping.class);</span><br><span class="line">                        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> (baseUrl + <span class="string">&quot;/&quot;</span> + requestMapping.value()).replaceAll(<span class="string">&quot;/+&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">                        mapping.put(url, method);</span><br><span class="line">                        System.out.println(<span class="string">&quot;Mapped &quot;</span> + url + <span class="string">&quot;,&quot;</span> + method);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (clazz.isAnnotationPresent(HfService.class)) &#123;</span><br><span class="line">                    <span class="comment">//注解中有别名 有别名替换key</span></span><br><span class="line">                    <span class="type">HfService</span> <span class="variable">service</span> <span class="operator">=</span> clazz.getAnnotation(HfService.class);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> service.value();</span><br><span class="line">                    <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">                        beanName = clazz.getName();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//初始化bean</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">instance</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                    mapping.put(beanName, instance);</span><br><span class="line">                    <span class="comment">//将service实现的接口也注入到bean中</span></span><br><span class="line">                    <span class="keyword">for</span> (Class&lt;?&gt; i : clazz.getInterfaces()) &#123;</span><br><span class="line">                        mapping.put(i.getName(), instance);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//根据 autowired实例化bean 这里只实现了controller层的注入</span></span><br><span class="line">            <span class="keyword">for</span> (Object object : mapping.values()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (object == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                Class&lt;?&gt; clazz = object.getClass();</span><br><span class="line">                <span class="keyword">if</span> (clazz.isAnnotationPresent(HfController.class)) &#123;</span><br><span class="line">                    Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">                    <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!field.isAnnotationPresent(HfAutowired.class)) &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="type">HfAutowired</span> <span class="variable">autowired</span> <span class="operator">=</span> field.getAnnotation(HfAutowired.class);</span><br><span class="line">                        <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> autowired.value();</span><br><span class="line">                        <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">                            beanName = field.getType().getName();</span><br><span class="line">                        &#125;</span><br><span class="line">                        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            field.set(mapping.get(clazz.getName()), mapping.get(beanName));</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扫描包下的类 加入容器中</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> scanPackage</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doScanner</span><span class="params">(String scanPackage)</span> &#123;</span><br><span class="line">        <span class="comment">// 将包路径转成url路径</span></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader().getResource(<span class="string">&quot;/&quot;</span> + scanPackage.replaceAll(<span class="string">&quot;\\.&quot;</span>, <span class="string">&quot;/&quot;</span>));</span><br><span class="line">        <span class="type">File</span> <span class="variable">classFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url.getFile());</span><br><span class="line">        <span class="comment">//遍历文件下的所有子文件 加入到容器中</span></span><br><span class="line">        <span class="keyword">for</span> (File file : classFile.listFiles()) &#123;</span><br><span class="line">            <span class="comment">//如果是文件夹 递归继续遍历，如果不是则将类加入到容器中</span></span><br><span class="line">            <span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">                <span class="comment">//递归扫描</span></span><br><span class="line">                doScanner(scanPackage + <span class="string">&quot;.&quot;</span> + file.getName());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//如果不是class文件 则继续跳过循环</span></span><br><span class="line">                <span class="keyword">if</span> (!file.getName().endsWith(<span class="string">&quot;.class&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> (scanPackage + <span class="string">&quot;.&quot;</span> + file.getName()).replace(<span class="string">&quot;.class&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="comment">//将类名作为key 加入到map集合中</span></span><br><span class="line">                mapping.put(className, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-运行阶段-1"><a href="#3-运行阶段-1" class="headerlink" title="3.运行阶段"></a>3.运行阶段</h2><p>HfDispatcherServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          doDispatch(req, resp);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          resp.getWriter().write(<span class="string">&quot;500 Exception &quot;</span> + Arrays.toString(e.getStackTrace()));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      doGet(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">      <span class="comment">//请求的url</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> req.getRequestURI();</span><br><span class="line">      <span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> req.getContextPath();</span><br><span class="line">      url = url.replace(contextPath, <span class="string">&quot;&quot;</span>).replaceAll(<span class="string">&quot;/+&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">this</span>.mapping.containsKey(url)) &#123;</span><br><span class="line">          resp.getWriter().write(<span class="string">&quot;404 Not Found!&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> (Method) <span class="built_in">this</span>.mapping.get(url);</span><br><span class="line">      Map&lt;String, String[]&gt; params = req.getParameterMap();</span><br><span class="line">      method.invoke(<span class="built_in">this</span>.mapping.get(method.getDeclaringClass().getName()),  <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;req, resp, params.get(<span class="string">&quot;name&quot;</span>)[<span class="number">0</span>]&#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HfController</span></span><br><span class="line"><span class="meta">@HfRequestMapping(&quot;/demo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoAction</span> &#123;</span><br><span class="line"></span><br><span class="line">  	<span class="meta">@HfAutowired</span></span><br><span class="line">	<span class="keyword">private</span> IDemoService demoService;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@HfRequestMapping(&quot;/query.*&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">(HttpServletRequest req, HttpServletResponse resp,</span></span><br><span class="line"><span class="params">                      <span class="meta">@HfRequestParam(&quot;name&quot;)</span> String name)</span>&#123;</span><br><span class="line"><span class="comment">//		String result = demoService.get(name);</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;My name is &quot;</span> + name;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			resp.getWriter().write(result);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果如下: 已经跳转到action中的方法中了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7e8c394438f7fc1428d2d3429bb897e6_1737630527526.png" alt="在这里插入图片描述"></p>
<hr>
<p>这个版本很多东西都是写死的，主要为了了解整个扫描包，加入容器管理，初始化bean，请求url根据反射调用action的方法的逻辑。</p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/07/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3!%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E4%B8%83%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/07/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3!%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E4%B8%83%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" class="post-title-link" itemprop="url">深入理解:设计模式中的七大设计原则</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-07 19:33:11" itemprop="dateCreated datePublished" datetime="2020-06-07T19:33:11+08:00">2020-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>985</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="深入理解-设计模式中的七大原则"><a href="#深入理解-设计模式中的七大原则" class="headerlink" title="深入理解:设计模式中的七大原则"></a>深入理解:设计模式中的七大原则</h1><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0b859e3a260144a99b96fb7441b5ff2d_1737624863401.png" alt="在这里插入图片描述"></p>
<h2 id="一、单一原则"><a href="#一、单一原则" class="headerlink" title="一、单一原则"></a>一、单一原则</h2><p>概念理解: 1个类只负责一个功能领域中的相应职责。</p>
<h2 id="二、开闭原则（目标）"><a href="#二、开闭原则（目标）" class="headerlink" title="二、开闭原则（目标）"></a>二、开闭原则（目标）</h2><p><code>概念理解</code>:  抽象是开闭原则的关键。<br><code>怎么做</code>: 面向接口、抽象类机制编程</p>
<h2 id="三、里氏代换原则（基础）"><a href="#三、里氏代换原则（基础）" class="headerlink" title="三、里氏代换原则（基础）"></a>三、里氏代换原则（基础）</h2><p><code>概念理解</code>:  开闭原则的最重要实现方式之一;所有引用基类的地方必须能透明的使用其子类的对象）.</p>
<p><code>怎么做</code>:</p>
<ul>
<li>1.设计时: 将父类设计为接口或抽象类，让子类继承父类或实现父接口—<code>关键技巧点:子类不能重写父类已经实现的方法</code></li>
<li>2.运行时:尽量将父类定义为抽象类和接口，声明定义变量尽量使用父类声明</li>
</ul>
<h2 id="四、依赖倒转原则（手段）"><a href="#四、依赖倒转原则（手段）" class="headerlink" title="四、依赖倒转原则（手段）"></a>四、依赖倒转原则（手段）</h2><p><code>概念理解</code>: </p>
<ul>
<li>抽象不应该依赖细节，细节应当依赖抽象</li>
<li>针对接口编程，而不是针对实现编程</li>
</ul>
<p><code>怎么做</code>: </p>
<ul>
<li>一个实现类，必须对应一个接口或抽象类，方法一样，子类不能有多余的方法</li>
<li>传递参数或者关联关系时，尽量用层次高的抽象层类</li>
<li>对第2条具体做法:在 成员类型声明，参数类型，方法返回类型，数据类型转换时，不要用具体类，而是用接口和抽象类来声明</li>
</ul>
<p><code>总结规律</code>: </p>
<ul>
<li>面对抽象编程，肯定会找机会注入具体的子对象，即需要依赖注入</li>
<li>依赖注入有三种方式:<ul>
<li>构造注入</li>
<li>set值注入</li>
<li>接口注入</li>
</ul>
</li>
</ul>
<blockquote>
<p>接口注入:通过实现在接口中声明的业务方法来传入具体类的对象。这些对象在定义时使用的是抽象类型，在运行时在传入具体类型的对象，有子类对象来覆盖父类对象。</p>
</blockquote>
<h2 id="五、接口隔离原则"><a href="#五、接口隔离原则" class="headerlink" title="五、接口隔离原则"></a>五、接口隔离原则</h2><p><code>概念理解</code>:<br>使用多个专门的接口，而不使用单一的总接口，即客户端不应该依赖那些它不需要的接口。</p>
<p><code>怎么做</code>:<br>接口太大时，将他分割成一些更细小的接口，也不能太小，不然接口泛滥，使用起来不方便，一般为某一类用户定制(业务)的方法.</p>
<h2 id="六、合成复用原则"><a href="#六、合成复用原则" class="headerlink" title="六、合成复用原则"></a>六、合成复用原则</h2><p><code>概念理解</code>:<br>尽量使用对象组合，而不是继承来达到复用的目的</p>
<h2 id="七、迪米特法则"><a href="#七、迪米特法则" class="headerlink" title="七、迪米特法则"></a>七、迪米特法则</h2><p><code>概念理解</code>:</p>
<ul>
<li>一个软件实体应该尽可能少地与其他实体发生相互作用。</li>
<li>术语：对象之间通信的几种朋友关系。</li>
</ul>
<p><code>怎么做</code>: </p>
<ul>
<li>类的结构上—每个类的成员变量和成员函数的访问权限尽量降低。</li>
<li>类的设计上—一个类应该尽量设计成不变类，引用其他类时，一个对象对其他对象的引用应当降到最低。</li>
<li>对象通信上—减少一些对象之间的通信，如果两个对象不必直接通信，可以通过第三方转发调用，也就是引入一个合理的第三者来降低现有对象之间的耦合度。</li>
</ul>
<hr>
<p>总结: 设计模式的七大原则。<br>文章参考: 《设计模式的艺术–软件开发人员的内功修炼之道》</p>
<hr>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a4782db259fd4c7771a6131825447a15_1737630566072.png" alt="在这里插入图片描述"><br>欢迎关注本人微信公众号，不定时推送相关文章，有任何问题都可以留言讨论，希望和大家共同成长。</p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F---%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB%E7%9F%A5%E5%A4%9A%E5%B0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F---%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB%E7%9F%A5%E5%A4%9A%E5%B0%91/" class="post-title-link" itemprop="url">设计模式---类之间的关系知多少</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-07 18:58:35" itemprop="dateCreated datePublished" datetime="2020-06-07T18:58:35+08:00">2020-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>857</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[toc]</p>
<h1 id="设计模式中的关系总结"><a href="#设计模式中的关系总结" class="headerlink" title="设计模式中的关系总结"></a>设计模式中的关系总结</h1><p>在软件系统中，类并不是独立存在的，类与类之间存在各种关系，对于不同类型的关系，UML提供了不同的表示方式。现在来总结梳理下:</p>
<h2 id="一、关联关系"><a href="#一、关联关系" class="headerlink" title="一、关联关系"></a>一、关联关系</h2><p>类与类之间最常用的一种关系，是一种结构化的关系，用实线连接有关联关系的对象所对应的类。java中，常将一个类的对象作为另一个类的成员变量。</p>
<h3 id="1-双向关联"><a href="#1-双向关联" class="headerlink" title="1.双向关联"></a>1.双向关联</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/cb0581c58a4c10f78a191ffc0a7b7d5f_1737630527526.png" alt="在这里插入图片描述"></p>
<h3 id="2-单向关联"><a href="#2-单向关联" class="headerlink" title="2.单向关联"></a>2.单向关联</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/88448202c4bac3c6c60a750036b75e8b_1737630527526.png" alt="在这里插入图片描述"></p>
<h3 id="3-自关联"><a href="#3-自关联" class="headerlink" title="3.自关联"></a>3.自关联</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/575b01b571f6bfb0193b3603bd343d2d_1737630527526.png" alt="在这里插入图片描述"></p>
<h3 id="4-多重性关联"><a href="#4-多重性关联" class="headerlink" title="4.多重性关联"></a>4.多重性关联</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d2f94ffd95ab123896887493f002c039_1737630527526.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2bc37954066c6f01dbfc6f13260b1793_1737630538275.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/20f373a09910d3e7fdae473a144c027c_1737630538275.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4388f269b81e3fe4f02a49b6813a627e_1737630538275.png" alt="在这里插入图片描述"></p>
<h3 id="5-聚合关系"><a href="#5-聚合关系" class="headerlink" title="5.聚合关系"></a>5.聚合关系</h3><p>聚合(Aggregation)关系表示整体与部分的关系。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c31b386d6526ac63d4a830b49d7e84cc_1737630538275.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2955931daa15b13a4aaab1ebe4fc1422_1737630538275.png" alt="在这里插入图片描述"></p>
<h3 id="6-组合关系"><a href="#6-组合关系" class="headerlink" title="6.组合关系"></a>6.组合关系</h3><p>组合关系也表示类之间整体和部分的关系，但是在组合关系中整体对象可以控制对象成员的生命周期，一旦整体对象不存在，成员对象也将不存在，成员对象与整体对象之间具有同生共死的关系。</p>
<p>组合关系用带实心菱形的直线表示。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e97021430ee6a6aff7fc1222de0fcbaf_1737630552972.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/5cb160310c3cfaa1d80b12069b449530_1737630552972.png" alt="在这里插入图片描述"></p>
<h2 id="二、依赖关系-Denpendency"><a href="#二、依赖关系-Denpendency" class="headerlink" title="二、依赖关系(Denpendency)"></a>二、依赖关系(Denpendency)</h2><p>依赖(Denpendency)关系是一种使用关系。<br>大多数情况下，依赖关系体现在某个类的方法使用另一个类的对象作为参数。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f5407e58bf5a11ce8c37bc46afc4b458_1737630552972.png" alt="在这里插入图片描述"><br><code>敲黑板:</code><br>依赖关系通常通过3种方式来实现。</p>
<ul>
<li>第一种: 如上图，将一个类的对象作为另一个类中的方法</li>
<li>第二种: 在一个类的方法中将另一个类的对象作为其局部变量</li>
<li>第三种: 在一个类的方法中调用另一个类的静态方法。</li>
<li></li>
</ul>
<h2 id="三、泛化关系-Generalization"><a href="#三、泛化关系-Generalization" class="headerlink" title="三、泛化关系(Generalization)"></a>三、泛化关系(Generalization)</h2><p>泛化(Generalization)关系也就是继承关系，用于描述父类与子类之间的关系。<br>泛化关系用带空心三角形的直线来表示。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9b146a663dcf0d07eb2266a6eeca231c_1737630552972.png" alt="在这里插入图片描述"></p>
<h2 id="四、实现关系-Realization"><a href="#四、实现关系-Realization" class="headerlink" title="四、实现关系(Realization)"></a>四、实现关系(Realization)</h2><p>在接口中，通常没有属性。而且所有的操作都是抽象的，只有操作的声明，没有操作的实现。<br>接口之间可以有与类之间关系类似的继承关系和依赖关系。<br>接口与类之间还存在一种实现(Realization)关系。<br>这种关系，类实现了接口，类中的操作实现了接口中所声明的操作。<br>实现关系用带空心三角形的虚线来表示。</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a7384fb327fd53599eadf0e1223c0b31_1737630552972.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/572b5c74d69b93500f8ee6bce9e2b67f_1737630566072.png" alt="在这里插入图片描述"></p>
<hr>
<p>总结，以上主要介绍了设计模式中的类与类之间存在的各种关系，不同类型的关系，UML如何表示。</p>
<p>文章参考:《设计模式的艺术–软件开发人员的内功修炼之道》</p>
<hr>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a4782db259fd4c7771a6131825447a15_1737630566072.png" alt="在这里插入图片描述"><br>欢迎关注本人微信公众号，不定时推送相关文章，有任何问题都可以留言讨论，希望和大家共成长。</p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/06/%E5%AE%9E%E6%88%98--excel%E5%88%86%E5%88%AB%E5%AE%9E%E7%8E%B0%E6%8C%89%E8%A1%8C%E8%AF%BB%E5%92%8C%E6%8C%89%E5%88%97%E8%AF%BB(%E5%85%B6%E5%AE%9E%E6%98%AF%E6%8C%89%E5%8D%95%E5%85%83%E6%A0%BC%E8%AF%BB%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/06/%E5%AE%9E%E6%88%98--excel%E5%88%86%E5%88%AB%E5%AE%9E%E7%8E%B0%E6%8C%89%E8%A1%8C%E8%AF%BB%E5%92%8C%E6%8C%89%E5%88%97%E8%AF%BB(%E5%85%B6%E5%AE%9E%E6%98%AF%E6%8C%89%E5%8D%95%E5%85%83%E6%A0%BC%E8%AF%BB%EF%BC%89/" class="post-title-link" itemprop="url">实战--excel分别实现按行读和按列读(其实是按单元格读）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-06 16:16:58" itemprop="dateCreated datePublished" datetime="2020-06-06T16:16:58+08:00">2020-06-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java%E5%9F%BA%E7%A1%80-spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">java基础 spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>24k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>22 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[toc]</p>
<blockquote>
<p>近期有个需求，说是要用到excel导入导出，一般我们的想法都是按照行数，于是实现了，后面发现公司需求的是列读，甚至不规则的单个excel的读。于是就用poi自己写了按照单元格读的实现。</p>
</blockquote>
<h1 id="一、按行读"><a href="#一、按行读" class="headerlink" title="一、按行读"></a>一、按行读</h1><p>想起了之前用到的poi，经过搜索发现，开源的项目中有比较好的封装poi的框架，一个是阿里出的easyExcel，另一个是easypoi，感觉使用起来都很方便。网上说easyExcel能解决大文件内存溢出问题，于是项目中就使用easyExcel了。</p>
<p>简单普及下easyExcel原理，不做底层码农，了解点上层设计有好处:</p>
<h2 id="easyExcel核心原理"><a href="#easyExcel核心原理" class="headerlink" title="easyExcel核心原理"></a>easyExcel核心原理</h2><blockquote>
<p>写有大量数据的xlsx文件时，POI为我们提供了SXSSFWorkBook类来处理，这个类的处理机制是当内存中的数据条数达到一个极限数量的时候就flush这部分数据，再依次处理余下的数据，这个在大多数场景能够满足需求。<br>读有大量数据的文件时，使用WorkBook处理就不行了，因为POI对文件是先将文件中的cell读入内存，生成一个树的结构（针对Excel中的每个sheet，使用TreeMap存储sheet中的行）。<br>如果数据量比较大，则同样会产生java.lang.OutOfMemoryError: Java heap space错误。POI官方推荐使用“XSSF and SAX（event API）”方式来解决。<br>分析清楚POI后要解决OOM有3个关键.</p>
</blockquote>
<ul>
<li>读取的数据转换流程<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/877c64b50a36794ce38e2d9c7d23799e_1737630566072.png" alt="在这里插入图片描述"></li>
<li>easyexcel解析数据的 设计思想和相关角色。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/910b0932fad0f06f92414c2c05f74385_1737630566072.png" alt="在这里插入图片描述"></li>
</ul>
<p>根据上面官网给的信息，我们得有个模型来接收每行的数据，本例用<code>CommonUser</code>对象，该对象上在这上面也可以加数据校验，还需要个解析每个行的监听器<code>CommonUserListener</code>，可以来处理每行的数据，然后进行数据库操作读写。</p>
<p>来个小demo（用的mybatis-plus框架）</p>
<p>controler</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;info/commonuser&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonUserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommonUserService commonUserService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * excel导入（按照行读）</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> CommonUser&#125;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> CommonUserListener&#125;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 3. 直接读即可</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        EasyExcel.read(file.getInputStream(), CommonUser.class, <span class="keyword">new</span> <span class="title class_">CommonUserListener</span>(commonUserService))</span><br><span class="line">                .sheet()</span><br><span class="line">                .doRead();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件下载（失败了会返回一个有部分数据的Excel）</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> CommonUser&#125;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 2. 设置返回的 参数</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;download&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">download</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> URLEncoder.encode(<span class="string">&quot;用户表&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + fileName + <span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line">        EasyExcel.write(response.getOutputStream(), CommonUser.class).sheet(<span class="string">&quot;模板&quot;</span>).doWrite(data());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * excel导出</span></span><br><span class="line"><span class="comment">     * 文件下载并且失败的时候返回json（默认失败了会返回一个有部分数据的Excel）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2.1.1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;downloadFailedUsingJson&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">downloadFailedUsingJson</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            <span class="comment">// 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> URLEncoder.encode(<span class="string">&quot;测试&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            response.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + fileName + <span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line">            <span class="comment">// 这里需要设置不关闭流</span></span><br><span class="line">            EasyExcel.write(response.getOutputStream(), CommonUser.class).autoCloseStream(Boolean.FALSE).sheet(<span class="string">&quot;模板&quot;</span>)</span><br><span class="line">                    .doWrite(data());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// 重置response</span></span><br><span class="line">            response.reset();</span><br><span class="line">            response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, String&gt;();</span><br><span class="line">            map.put(<span class="string">&quot;status&quot;</span>, <span class="string">&quot;failure&quot;</span>);</span><br><span class="line">            map.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;下载文件失败&quot;</span> + e.getMessage());</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(map));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;CommonUser&gt; <span class="title function_">data</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;CommonUser&gt; list = commonUserService.list();</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CommonUserService （和读excel无关，业务需要）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户Service</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl 690328661@qq.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-16 08:42:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CommonUserService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;CommonUser&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>CommonUserServiceImpl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;commonUserService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonUserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;CommonUserMapper, CommonUser&gt; <span class="keyword">implements</span> <span class="title class_">CommonUserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(CommonUserServiceImpl.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>CommonUserListener（负责获取每行的数据，然后根据需要进行db保存）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonUserListener</span> <span class="keyword">extends</span> <span class="title class_">AnalysisEventListener</span>&lt;CommonUser&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOGGER</span> <span class="operator">=</span> LoggerFactory.getLogger(TestController.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每隔5条存储数据库，实际使用中可以3000条，然后清理list ，方便内存回收</span></span><br><span class="line"><span class="comment">     * mybatis-plus 默认1000</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">BATCH_COUNT</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    List&lt;CommonUser&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 假设这个是一个DAO，当然有业务逻辑这个也可以是一个service。当然如果不用存储这个对象没用。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> CommonUserService commonUserService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CommonUserListener</span><span class="params">(CommonUserService commonUserService)</span> &#123;</span><br><span class="line">        <span class="comment">// 这里是demo，所以随便new一个。实际使用如果到了spring,请使用下面的有参构造函数</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.commonUserService = commonUserService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每隔5条存储数据库，实际使用中可以3000条，然后清理list ，方便内存回收</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(CommonUser data, AnalysisContext context)</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;解析到一条数据:&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(data));</span><br><span class="line">        list.add(data);</span><br><span class="line">        <span class="comment">// 达到BATCH_COUNT了，需要去存储一次数据库，防止数据几万条数据在内存，容易OOM</span></span><br><span class="line">        <span class="keyword">if</span> (list.size() &gt;= BATCH_COUNT) &#123;</span><br><span class="line">            saveData();</span><br><span class="line">            <span class="comment">// 存储完成清理 list</span></span><br><span class="line">            list.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// 这里也要保存数据，确保最后遗留的数据也存储到数据库</span></span><br><span class="line">        saveData();</span><br><span class="line">        LOGGER.info(<span class="string">&quot;所有数据解析完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加上存储数据库</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveData</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;&#123;&#125;条数据，开始存储数据库！&quot;</span>, list.size());</span><br><span class="line">        commonUserService.saveBatch(list);</span><br><span class="line">        LOGGER.info(<span class="string">&quot;存储数据库成功！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>CommonUserMapper（数据库操作的）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户表</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-16 08:42:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CommonUserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;CommonUser&gt; &#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实体对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;common_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonUser</span> <span class="keyword">extends</span> <span class="title class_">BaseEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 用户ID</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@TableId</span></span><br><span class="line">	<span class="keyword">private</span> String userId;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 用户名</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@ExcelProperty(&quot;字符串标题&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String userName;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 真实姓名</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userRealname;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 密码</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userPassword;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 盐</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userSalt;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 手机号码</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userMobile;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 性别</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userSex;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 头像url</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userAvatar;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 电子邮箱</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userEmail;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 账号状态(0-正常,1-冻结)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> Integer userStatus;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 扩展字段</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String userEx;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;CommonUser&#123;&quot;</span> +</span><br><span class="line">				<span class="string">&quot;userId=&#x27;&quot;</span> + userId + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userName=&#x27;&quot;</span> + userName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userRealname=&#x27;&quot;</span> + userRealname + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userPassword=&#x27;&quot;</span> + userPassword + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userSalt=&#x27;&quot;</span> + userSalt + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userMobile=&#x27;&quot;</span> + userMobile + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userSex=&#x27;&quot;</span> + userSex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userAvatar=&#x27;&quot;</span> + userAvatar + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userEmail=&#x27;&quot;</span> + userEmail + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, userStatus=&quot;</span> + userStatus +</span><br><span class="line">				<span class="string">&quot;, userEx=&#x27;&quot;</span> + userEx + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>数据库表结构:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `common_user` (</span><br><span class="line">  `user_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">  `user_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `user_realname` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;真实姓名&#x27;</span>,</span><br><span class="line">  `user_password` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">  `user_salt` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;盐&#x27;</span>,</span><br><span class="line">  `user_mobile` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;手机号码&#x27;</span>,</span><br><span class="line">  `user_sex` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">  `user_avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头像url&#x27;</span>,</span><br><span class="line">  `user_email` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;电子邮箱&#x27;</span>,</span><br><span class="line">  `user_status` tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;账号状态(0-正常,1-冻结)&#x27;</span>,</span><br><span class="line">  `user_ex` text COMMENT <span class="string">&#x27;扩展字段&#x27;</span>,</span><br><span class="line">  `creater` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建者&#x27;</span>,</span><br><span class="line">  `modifier` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;修改者&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span>,</span><br><span class="line">  `is_deleted` tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;0：未删除，1：删除&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`user_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;用户表&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>启动项目:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6dd7126627827af4ec46c3a32f6c4a69_1737630566072.png" alt="在这里插入图片描述"><br>使用postman先把本地的数据库数据导出到excel中试试:<br>浏览器中输入: localhost:7000&#x2F;info&#x2F;commonuser&#x2F;downloadFailedUsingJson</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/fe20b2ae91a4da7f2a3d59cc6a615375_1737630579200.png" alt="在这里插入图片描述"><br>可以看出数据库中的被导出来了: 标题头和实体中的@ExcelProperty对应:这里只写了字符串标题这个表头，其他的会默认显示英文字段。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4997de5fb7f265cdf80d7c0546244437_1737630579200.png" alt="在这里插入图片描述"></p>
<h2 id="按行读"><a href="#按行读" class="headerlink" title="按行读"></a>按行读</h2><p>将刚才数据库中的数据全部删除:导入刚才的Excel数据试试</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6ec432f30336734fa49ce372fb844943_1737630579200.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/30e214d2feb552cb21a91731087082ea_1737630579200.png" alt="在这里插入图片描述"><br>使用post测试:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a957c466e3fbed655f6247f6511be1a5_1737630579200.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/bb0b55a81797d6316d0ba583fcc2477a_1737630591324.png" alt="在这里插入图片描述"><br>可以看到控制已经显示成功，<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b9c772d40175f91e20191903fb482ff3_1737630591324.png" alt="在这里插入图片描述"><br>看下数据库:显示已经按照行读，并写入数据库中了<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b9fbc3939d52a24f3b6ad97dcf6f3967_1737630591324.png" alt="在这里插入图片描述"></p>
<h1 id="二、按列读-按单元格读：适合模板型的excel）"><a href="#二、按列读-按单元格读：适合模板型的excel）" class="headerlink" title="二、按列读(按单元格读：适合模板型的excel）"></a>二、按列读(按单元格读：适合模板型的excel）</h1><p>上面的导入excel数据是按照行读的，但是我的需求是这样的:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6ad58af69957a3e0c927a4fc3c09f535_1737630591324.png" alt="在这里插入图片描述"><br>列形式，很多个sheet都不一样，怎么处理呢?<br>于是想到，easyExcel肯定是实现不了了，干脆使用poi自带的按照单元格自己去读。</p>
<blockquote>
<p>思路: 每个模板excel对应一个实体，每个单元格的位置（行号和列号）在实体上通过注解对应好，这样我解析单元格，取出每个单元格的值，和位置，赋值给对应的实体的属性。</p>
</blockquote>
<h2 id="解析单元格的小demo"><a href="#解析单元格的小demo" class="headerlink" title="解析单元格的小demo"></a>解析单元格的小demo</h2><p>因为easyExcel默认引用poi，所以不需要引maven包，直接写就好了:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">AllExcelRead</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InvalidFormatException &#123;</span><br><span class="line">        <span class="comment">//1、指定要读取EXCEL文档名称</span></span><br><span class="line">        String filename=<span class="string">&quot;C:\\Users\\69032\\Desktop\\vechicleService.xlsx&quot;</span>;</span><br><span class="line">        <span class="comment">//2、创建输入流</span></span><br><span class="line">        FileInputStream input=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filename);</span><br><span class="line">        <span class="comment">//3、通过工作簿工厂类来创建工作簿对象</span></span><br><span class="line">        Workbook workbook= WorkbookFactory.create(input);</span><br><span class="line">        <span class="comment">//4、获取工作表 (可以按照sheet名字，也可以按照sheet的索引)</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sheetName</span> <span class="operator">=</span> <span class="string">&quot;车辆信息备案申请&quot;</span>;</span><br><span class="line">        Sheet sheet=workbook.getSheet(sheetName);</span><br><span class="line"><span class="comment">//        Sheet sheet=workbook.getSheet(&quot;工作表1&quot;);</span></span><br><span class="line"><span class="comment">//        Sheet sheet = workbook.getSheetAt(0);</span></span><br><span class="line">        <span class="comment">//5、获取行</span></span><br><span class="line">        Row row=sheet.getRow(<span class="number">53</span>);</span><br><span class="line">        <span class="comment">//6、获取单元格</span></span><br><span class="line">        Cell cell=row.getCell(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//7、读取单元格内容</span></span><br><span class="line">        System.out.println(cell.getStringCellValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4ec7f90914b087ee504047512ce21229_1737630591324.png" alt="在这里插入图片描述"><br>完美找到excel对应单元格的数据:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ebce31b303beed6b801f9456625e677c_1737630602926.png" alt="在这里插入图片描述"></p>
<h2 id="实战："><a href="#实战：" class="headerlink" title="实战："></a>实战：</h2><p>定义个属性上的注解，指定某个单元格的属性:</p>
<p>RecordTemplate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RecordTemplate &#123;</span><br><span class="line">     <span class="comment">//行号</span></span><br><span class="line">     <span class="type">int</span> <span class="title function_">rowNo</span><span class="params">()</span>;</span><br><span class="line">     <span class="comment">//列号</span></span><br><span class="line">     <span class="type">int</span> <span class="title function_">columnNo</span><span class="params">()</span>;</span><br><span class="line">     <span class="comment">//是否必填</span></span><br><span class="line">     FillCommentEnum <span class="title function_">comment</span><span class="params">()</span>;</span><br><span class="line">     <span class="comment">//单元格名称</span></span><br><span class="line">     String <span class="title function_">name</span><span class="params">()</span>;</span><br><span class="line">     <span class="comment">//数据类型</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>是否必填的枚举:<br>FillCommentEnum</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: FillCommentEnum</span></span><br><span class="line"><span class="comment"> * Description: 单元格 填充枚举</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">FillCommentEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    FILL(<span class="number">0</span>, <span class="string">&quot;必填&quot;</span>),</span><br><span class="line">    EMPTY(<span class="number">1</span>, <span class="string">&quot;非必填&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  <span class="type">int</span> code;</span><br><span class="line">    <span class="keyword">private</span>  String description;</span><br><span class="line"></span><br><span class="line">    FillCommentEnum(<span class="type">int</span> code, String description) &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.description = description;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDescription</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDescription</span><span class="params">(String description)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.description = description;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，我需要定义实体和模板对应。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;vehicle_static_info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VehicleStaticInfo</span> <span class="keyword">extends</span> <span class="title class_">BaseEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆ID(主键)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 最大基准扭矩</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String engineMaxTorque;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车牌号码(（GB17691-2005必填，GB17691-2018选填）)</span></span><br><span class="line"><span class="comment">     * 此字段，数据库中已经移除，提取到车辆公共信息表中了</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 3, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车牌号码&quot;)</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleLicense;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车牌颜色(车牌颜色)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 4, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车牌颜色&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String licenseColor;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车体结构(（编码见说明3）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 5, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车体结构&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer vehicleStructure;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆颜色</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 6, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆颜色&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleColor;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 核定载重</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 7, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;核定载重&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double vehicleLoad;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆尺寸mm（长）(32960、17691等)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 8, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆尺寸mm（长）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double vehicleLong;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆尺寸mm（宽）(国六，新能源等字典)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 9, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆尺寸mm（宽）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double vehicleWide;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆尺寸mm（高）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 10, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆尺寸mm（高）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double vehicleHigh;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总质量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 11, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;总质量&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double grossVehicleMass;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆类型(（编码见说明1）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 12, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆类型（编码见右面1）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer vehicleType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 行业类型(（编码见说明8 http://www.stats.gov.cn/tjsj/tjbz/hyflbz/201905/P020190716349644060705.pdf）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 13, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;行业类型（编码见右面8）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String industryType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆型号(（GB17691-2005必填，GB17691-2018选填）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 14, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;车辆型号（GB17691-2005必填，GB17691-2018选填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;车辆型号不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleModel;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 购买时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 15, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;购买时间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String buyingDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车架号VIN(（必填）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 16, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;车架号VIN（必填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;车架号VIN不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleFrameNo;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 行驶证号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 17, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;行驶证号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String drivingLicenseNo;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发动机型号(（GB17691-2005必填，GB17691-2018选填）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 18, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;发动机型号（GB17691-2005必填，GB17691-2018选填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;发动机型号不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> String engineModel;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发动机编号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 19, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;发动机编号&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;发动机编号不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> String engineNo;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车籍地</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 20, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车籍地&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String vehiclePlace;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆技术等级(（编码见说明2）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 21, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆技术等级（编码见右面2）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer technicalLevel;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 出厂日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 22, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;出厂日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String productionDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 等级评定日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 23, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;等级评定日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String gradeAssessmentDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二级维护日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 24, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;二级维护日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String twoMaintenanceDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二级维护状态(（编码见说明5）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 25, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;二级维护状态（编码见右面5）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer twoMaintenanceStatus;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年审状态(（编码见说明4）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 26, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;年审状态（编码见右面4）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer yearEvaluationStatus;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年检有效期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 27, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;年检有效期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String yearinspectionPeriod;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保险有效期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 28, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;保险有效期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String insurancePeriod;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保养有效期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 29, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;保养有效期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String maintenancePeriod;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所属单位名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 30, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;所属单位名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String enterpriseName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆联系人</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 31, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆联系人&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String contactsName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆联系电话</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 32, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆联系电话&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String contactPhone;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆sim卡号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 33, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆sim卡号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String terminalSim;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆注册时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 34, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆注册时间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String registerDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所属组织ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 35, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;所属组织ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String organizationId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 环保局车辆类型(（编码见说明6）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 36, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;环保局车辆类型（编码见右面6）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer epaVehicleType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 运输局车辆类型(（编码见说明7）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 37, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;运输局车辆类型（编码见右面7）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer transVehicleType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有绑定的sim卡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 38, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;所有绑定的sim卡&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String terminalAllSim;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有者地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 39, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;所有者地址&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String ownerAddress;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车牌型号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 40, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车牌型号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String licenseModel;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 行政区划</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 41, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;行政区划&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String administrativeArea;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 行政地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 42, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;行政地址&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String administrativeAddress;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总客数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 43, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;总客数&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer totalnumberGuest;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 整备质量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 44, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;整备质量&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double curbWeight;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 列车最大总质量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 45, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;列车最大总质量&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double maximumTotalMassOfTrain;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 入网证号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 46, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;入网证号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String netNumber;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初次登记日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 47, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;初次登记日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String initialRegistrationDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年检日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 48, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;年检日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String annualInspectionDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 强制报废日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 49, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;强制报废日期&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String mandatoryScrapDate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所属企业简称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 50, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;所属企业简称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String enterpriseShortName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆SN</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 51, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;车辆SN&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleSn;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全芯片型号(（车载终端含有安全芯片的必填）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 52, columnNo = 2, comment = FillCommentEnum.EMPTY, name = &quot;安全芯片型号（车载终端含有安全芯片的必填）&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String chipType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车载终端型号(（必填）)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 53, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;车载终端型号（必填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;车载终端型号不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> String tboxType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 激活模式(（编码见说明9，必填）0-无需激活，1-需要激活)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 54, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;激活模式（编码见右面9，必填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;激活模式不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer vehRegisterMode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 排放水平(（编码见说明10，必填）(1-国六,2-国五,3-国四,4-国三,5-国二,6-排气后处理系统改装车辆))</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 55, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;排放水平（编码见右面10，必填）&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;放水平不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer emissionlLevelType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 整车生产企业</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RecordTemplate(rowNo = 56, columnNo = 2, comment = FillCommentEnum.FILL, name = &quot;整车生产企业&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;整车生产企业不能为空&quot;, groups = &#123;ImportGroup.class&#125;)</span></span><br><span class="line">    <span class="keyword">private</span> String vehicleFirm;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全芯片编号(备案不需要)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String chipCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 备注</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String remark;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 车辆备案结果(0:草稿；1:待审核；2：未备案 3:审核通过4:审核未通过)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> Integer recordResult;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解析工具类（最重要）"><a href="#解析工具类（最重要）" class="headerlink" title="解析工具类（最重要）"></a>解析工具类（最重要）</h3><p>思路:  遍历实体类上的有@ExcelTemplate注解的属性，有的话说明事由单元格和它对应的，把该属性的行号和列号传递给 解析单元格数据的方法，返回单元格的值，再通过java的 Filed的反射机制，给类赋值，就获取了excel中所有值了。在解析单元格的时候根据是否必填，也可以提前抛出异常。</p>
<p>解析单元格的相关方法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取sheet对象</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> Sheet <span class="title function_">getSheetByStream</span><span class="params">(InputStream inputStream, String sheetName)</span> &#123;</span><br><span class="line">       <span class="type">Workbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           workbook = WorkbookFactory.create(inputStream);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;excel文件有误&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">if</span> (StringUtils.isBlank(sheetName)) &#123;</span><br><span class="line">           <span class="comment">//取第一个</span></span><br><span class="line">           sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           sheet = workbook.getSheet(sheetName.trim());</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> sheet;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 读取单个单元格的值</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> rowNo</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> columnNo</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readCell</span><span class="params">(Sheet sheet, <span class="type">int</span> rowNo, <span class="type">int</span> columnNo, FillCommentEnum comment, String name)</span> &#123;</span><br><span class="line">       <span class="comment">//5、获取行</span></span><br><span class="line">       <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.getRow(rowNo);</span><br><span class="line">       <span class="comment">//6、获取单元格</span></span><br><span class="line">       <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> row.getCell(columnNo);</span><br><span class="line">       <span class="comment">//7、读取单元格内容</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">stringCellValue</span> <span class="operator">=</span> getCellValueByType(cell, name);</span><br><span class="line">       <span class="keyword">if</span> (comment.getCode() == <span class="number">0</span> &amp;&amp; StringUtils.isBlank(stringCellValue)) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(name + <span class="string">&quot;不能为空&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       logger.info(stringCellValue);</span><br><span class="line">       <span class="keyword">return</span> stringCellValue;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getCellValueByType</span><span class="params">(Cell cell,String name)</span>&#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">cellValue</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span>(cell.getCellTypeEnum() == CellType.NUMERIC)&#123;</span><br><span class="line">          <span class="keyword">if</span> (HSSFDateUtil.isCellDateFormatted(cell)) &#123;</span><br><span class="line">              cellValue = DateFormatUtils.format(cell.getDateCellValue(), <span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="type">NumberFormat</span> <span class="variable">nf</span> <span class="operator">=</span> NumberFormat.getInstance();</span><br><span class="line">              cellValue = String.valueOf(nf.format(cell.getNumericCellValue())).replace(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          logger.info(cellValue);</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cell.getCellTypeEnum() == CellType.STRING)&#123;</span><br><span class="line">          cellValue = String.valueOf(cell.getStringCellValue());</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cell.getCellTypeEnum() == CellType.BOOLEAN)&#123;</span><br><span class="line">          cellValue = String.valueOf(cell.getBooleanCellValue());</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cell.getCellTypeEnum() == CellType.ERROR)&#123;</span><br><span class="line">          cellValue = <span class="string">&quot;错误类型&quot;</span>;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;单元格&quot;</span>+name+<span class="string">&quot;: &quot;</span>+cellValue);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> cellValue;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>反射给对象赋值的相关方法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 解析excel备案数据到对象</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> ClassNotFoundException</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> InstantiationException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">parseExcelToModel</span><span class="params">(String className, Sheet sheet)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException &#123;</span><br><span class="line">     Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">     Field[] declaredFields = clazz.getDeclaredFields();</span><br><span class="line">     <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">     <span class="comment">//获取excel的流，前端传入</span></span><br><span class="line">     <span class="keyword">for</span> (Field field: declaredFields) &#123;</span><br><span class="line">         field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">         <span class="keyword">if</span> (field.isAnnotationPresent(RecordTemplate.class)) &#123;</span><br><span class="line">             <span class="type">RecordTemplate</span> <span class="variable">annotation</span> <span class="operator">=</span> field.getAnnotation(RecordTemplate.class);</span><br><span class="line">             Class&lt;?&gt; type = field.getType();</span><br><span class="line">             logger.info(type.getName());</span><br><span class="line">             <span class="comment">//单元格的值</span></span><br><span class="line">             <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> ReadExcellCellUtils.readCell(sheet, annotation.rowNo(), annotation.columnNo(), annotation.comment(), annotation.name());</span><br><span class="line">             <span class="comment">//通过反射把 单元格的值 给对象属性</span></span><br><span class="line">             setFieldValue(o, field, type, value);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> o;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过反射把 单元格的值 给对象属性</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> field</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object o, Field field, Class&lt;?&gt; type, String value)</span> <span class="keyword">throws</span> IllegalAccessException &#123;</span><br><span class="line">     <span class="type">Object</span> <span class="variable">targetValue</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">     <span class="keyword">if</span> (StringUtils.isEmpty(value)) &#123;</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span> (type.equals(Integer.class)) &#123;</span><br><span class="line">         targetValue = Integer.parseInt(value);</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(Double.class)) &#123;</span><br><span class="line">         targetValue = Double.parseDouble(value);</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(Float.class)) &#123;</span><br><span class="line">         targetValue =  Float.parseFloat(value);</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(Boolean.class)) &#123;</span><br><span class="line">         targetValue = Boolean.getBoolean(value);</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">         targetValue = value;</span><br><span class="line">     &#125;</span><br><span class="line">     field.set(o, targetValue);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 解析数据到model</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> className   类名</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> inputStream 输入流</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> sheetName   sheetname 可以为null，为null时取第一页</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> 映射对象</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">parseExcelToModel</span><span class="params">(String className, InputStream inputStream, String sheetName)</span> &#123;</span><br><span class="line">     <span class="type">Sheet</span> <span class="variable">sheetByStream</span> <span class="operator">=</span> getSheetByStream(inputStream, sheetName);</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">return</span> parseExcelToModel(className, sheetByStream);</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         e.printStackTrace();</span><br><span class="line">         <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;解析数据到model失败&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用:"></a>如何使用:</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/01abc840237650278080bfacc49553ed_1737630602926.png" alt="在这里插入图片描述"><br>提供这3个值就可以了。<br>举例说明:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/911ea7251700a20b870b044519b8b574_1737630602926.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/28825f2a0690db5c187c49ecb3094892_1737630602926.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2d3b0fda3cdad1489cc5cce74c4427ac_1737630602926.png" alt="在这里插入图片描述"><br>测试:<br>使用postman请求： excel的数据都获取到了：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/229503fba3665082bd2637ebd62bdf5b_1737630614815.png" alt="在这里插入图片描述"></p>
<p>自此，按照单元格的例子就完成了，这种适合不规则的excel，而且行数确定，特别是针对模板excel的读都是很通用的。</p>
<hr>
<p>总结:本文主要实现了easyExcel按照行数的例子，还有自己封装的针对通用不规则excel按照列（确切是按照单元格）读的例子。如有问题或者错误，欢迎留言讨论。</p>
<hr>
<p>个人微信公众号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/undefined/img/2025-1-13/42409b1dbd9a6b7ff63471ea0769592d_1737631173950.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/05/%E9%AB%98%E6%89%8B%E7%9C%BC%E4%B8%AD%E7%9A%84%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%96%B0%E6%89%8B%E6%9C%89%E4%BB%80%E4%B9%88%E4%B8%8D%E4%B8%80%E6%A0%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/05/%E9%AB%98%E6%89%8B%E7%9C%BC%E4%B8%AD%E7%9A%84%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%96%B0%E6%89%8B%E6%9C%89%E4%BB%80%E4%B9%88%E4%B8%8D%E4%B8%80%E6%A0%B7/" class="post-title-link" itemprop="url">高手眼中的观察者模式和新手有什么不一样</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-05 23:31:03" itemprop="dateCreated datePublished" datetime="2020-06-05T23:31:03+08:00">2020-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java%E5%9F%BA%E7%A1%80-spring%E5%AE%B6%E6%97%8F-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">java基础 spring家族 设计模式</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>27k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>25 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[toc]</p>
<blockquote>
<p>观察者模式，是使用很多的一种模式，初次了解，只是根据入门demo写个例子，但是不知道用在哪，怎么用，很教科书。<br>个人很喜欢比较实战的的博客或者资料。<br>最近又恶补了一把，感觉有点小收获，记录下。</p>
</blockquote>
<h1 id="基础部分"><a href="#基础部分" class="headerlink" title="基础部分"></a>基础部分</h1><h2 id="一、观察者模式的基本经典结构"><a href="#一、观察者模式的基本经典结构" class="headerlink" title="一、观察者模式的基本经典结构"></a>一、观察者模式的基本经典结构</h2><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ca6db9feaa4742b1317a77c96d9d8de9_1737630614815.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/43a48525a44868c3ee4b51a79f81f845_1737630614815.png" alt="在这里插入图片描述"></p>
<h2 id="二、入门小demo"><a href="#二、入门小demo" class="headerlink" title="二、入门小demo"></a>二、入门小demo</h2><h3 id="经典小demo1："><a href="#经典小demo1：" class="headerlink" title="经典小demo1："></a>经典小demo1：</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3f6e43aa79db18c9775138649b5e4336_1737630614815.png" alt="在这里插入图片描述"><br>Observer </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者接口，定义一个更新的接口给那些在目标发生改变的时候被通知的对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新的接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Subject subject)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ConcreteObserver</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//具体观察者对象，实现更新的方法，使用自身的状态和</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteObserver</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Subject subject)</span> &#123;</span><br><span class="line">        <span class="comment">//具体的实现</span></span><br><span class="line">        <span class="comment">//这里可能需要更新观察者的状态，使其与目标的状态保持一致</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> ((ConcreteSubject) subject).getSubjectState();</span><br><span class="line">        System.out.println(<span class="string">&quot;收到一通知: 获取到的状态是: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Subject</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 目标对象，它知道观察它的观察者，并提供注册和删除观察者的接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用来保存注册的观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(Observer observer)</span>&#123;</span><br><span class="line">        observers.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(Observer observer)</span>&#123;</span><br><span class="line">        observers.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通知所有注册的观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">notifyObservers</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer: observers)&#123;</span><br><span class="line">            observer.update(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ConcreteSubject </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的目标对象，负责吧有关状态存入到相应的观察者对象</span></span><br><span class="line"><span class="comment"> * 并在自己状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteSubject</span> <span class="keyword">extends</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 目标对象的状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSubjectState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> subjectState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSubjectState</span><span class="params">(String subjectState)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subjectState = subjectState;</span><br><span class="line">        <span class="built_in">this</span>.notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Test</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//观察者</span></span><br><span class="line">        <span class="type">Observer</span> <span class="variable">concreteObserver1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteObserver</span>();</span><br><span class="line">        <span class="type">Observer</span> <span class="variable">concreteObserver2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteObserver</span>();</span><br><span class="line">        <span class="comment">//目标对象 即被观察者 目标可以有多个，此demo通过 state区分</span></span><br><span class="line">        <span class="type">ConcreteSubject</span> <span class="variable">subject1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteSubject</span>();</span><br><span class="line">        <span class="comment">//注册观察者</span></span><br><span class="line">        subject1.attach(concreteObserver1);</span><br><span class="line">        subject1.attach(concreteObserver2);</span><br><span class="line"><span class="comment">//        ConcreteSubject subject2 = new ConcreteSubject();</span></span><br><span class="line"><span class="comment">//        //注册观察者</span></span><br><span class="line"><span class="comment">//        subject2.attach(concreteObserver1);</span></span><br><span class="line"><span class="comment">//        subject2.attach(concreteObserver2);</span></span><br><span class="line">        <span class="comment">//发出通知</span></span><br><span class="line">        subject1.setSubjectState(<span class="string">&quot;通知1：已经下发了&quot;</span>);</span><br><span class="line"><span class="comment">//        System.out.println(&quot;===换一个主题======&quot;);</span></span><br><span class="line"><span class="comment">//        subject2.setSubjectState(&quot;通知2：已经下发了&quot;);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果: 主题发一个消息，观察者都能收到:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ee41f802bcc13af53883052be308d7de_1737630628133.png" alt="在这里插入图片描述"></p>
<h3 id="大话设计模式中看门放哨小案例"><a href="#大话设计模式中看门放哨小案例" class="headerlink" title="大话设计模式中看门放哨小案例"></a>大话设计模式中看门放哨小案例</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1e11b281aa054597bd7bbcd1dd0f085d_1737630628133.png" alt="在这里插入图片描述"><br>Subject</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 添加观察者</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> observer</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addObserver</span><span class="params">(Observer observer)</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 移除指定的观察者</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> observer</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">removeObserver</span><span class="params">(Observer observer)</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 移除所有的观察者</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">removeAll</span><span class="params">()</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * data 是要通知给观察者的数据</span></span><br><span class="line"><span class="comment">	 * 因为Object是所有类的父类，可以使用多态，当然 你也可以使用 泛型</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">notifyAllObserver</span><span class="params">(Object data)</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 单独 通知某一个观察者</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> observer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     *  data 是要通知给观察者的数据</span></span><br><span class="line"><span class="comment">	 * 因为Object是所有类的父类，可以使用多态，当然 你也可以使用 泛型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(Observer observer,Object data)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ConcreteSubject</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的主题对象 </span></span><br><span class="line"><span class="comment"> * 这里就不实现线程安全的功能了，</span></span><br><span class="line"><span class="comment"> * 有兴趣的话可以参考java.util报下的Observable</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xujun</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteSubject</span> <span class="keyword">implements</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line"></span><br><span class="line">	List&lt;Observer&gt; mList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addObserver</span><span class="params">(Observer observer)</span> &#123;</span><br><span class="line">		<span class="comment">// 确保相同的观察者只含有一个</span></span><br><span class="line">		<span class="keyword">if</span> (observer == <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;observer == null&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!mList.contains(observer)) &#123;</span><br><span class="line">			mList.add(observer);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeObserver</span><span class="params">(Observer observer)</span> &#123;</span><br><span class="line">		mList.remove(observer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeAll</span><span class="params">()</span> &#123;</span><br><span class="line">       mList.clear();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyAllObserver</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (Observer observer : mList) &#123;</span><br><span class="line">			observer.update(data);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(Observer observer, Object data)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(observer!=<span class="literal">null</span>)&#123;</span><br><span class="line">			observer.update(data);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Observer </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Administrator</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> data    被观察者传递给观察者的 数据</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Object data)</span>;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CartoonObserver </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CartoonObserver</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">		System.out.println( <span class="string">&quot; 我是&quot;</span>+<span class="built_in">this</span>.getClass().</span><br><span class="line">				getSimpleName()+<span class="string">&quot;，  &quot;</span>+data+<span class="string">&quot;别看漫画了&quot;</span>);	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>NBAObserver</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NBAObserver</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CartoonObserver</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">			System.out.println( <span class="string">&quot; 我是&quot;</span>+<span class="built_in">this</span>.getClass().getSimpleName()+<span class="string">&quot;，  &quot;</span>+data+<span class="string">&quot;别看漫画了&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot; 我是&quot;</span> + <span class="built_in">this</span>.getClass().getSimpleName() + <span class="string">&quot;，  &quot;</span> + data + <span class="string">&quot;别看NBA了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>TestObserver</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestObserver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//主题</span></span><br><span class="line">        <span class="type">ConcreteSubject</span> <span class="variable">concreteSubject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteSubject</span>();</span><br><span class="line">        <span class="comment">//观察者</span></span><br><span class="line">        <span class="type">CartoonObserver</span> <span class="variable">cartoonObserver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CartoonObserver</span>();</span><br><span class="line">        <span class="type">NBAObserver</span> <span class="variable">nbaObserver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NBAObserver</span>();</span><br><span class="line">        <span class="comment">//添加观察者</span></span><br><span class="line">        concreteSubject.addObserver(cartoonObserver);</span><br><span class="line">        concreteSubject.addObserver(nbaObserver);</span><br><span class="line">       <span class="comment">//发布消息通知</span></span><br><span class="line">        concreteSubject.notifyAllObserver(<span class="string">&quot;老师来了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果: 只要放哨的一发通知，观察者就收到了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/956f9633302e8cdd0857fd8a33517432_1737630628133.png" alt="在这里插入图片描述"></p>
<h2 id="三、经典观察者模式的两种使用方式-推和拉"><a href="#三、经典观察者模式的两种使用方式-推和拉" class="headerlink" title="三、经典观察者模式的两种使用方式: 推和拉"></a>三、经典观察者模式的两种使用方式: 推和拉</h2><p>观察者模式使用时，其实分2个阶段：</p>
<ul>
<li><p>准备阶段，维护目标和观察者关系的阶段</p>
</li>
<li><p>实际运行阶段，也就是目标发生变化，引起观察者做出发应的阶段</p>
</li>
</ul>
<p>这里说的使用方式，针对的是实际运行阶段。获取目标确切数据发起者的问题。</p>
<ul>
<li>推模型<br>目标对象主动向观察者推送目标的详细信息，不管观察者是否需要，这些数据，是目标对象定义，相当于广播给观察者。刚才的例子中，第2个就是推模型。</li>
<li>拉模型<br>目标对象在通知观察者的时候，只是把自己的引用给观察者，观察者根据需要，使用引用获取。刚才的例子中，第一个例子就是拉模型。目标对象吧this传递给观察者。</li>
</ul>
<p>开发中如果数据确定，可以用推模型，如果观察者要得到的数据不固定，建议用拉模型，更加灵活，扩展性强。总之，还是拉模型好。</p>
<hr>
<p><code>新手一般只学到上面。下面进入入深入思考的部分</code>:</p>
<hr>
<h1 id="高级部分（应用场景）"><a href="#高级部分（应用场景）" class="headerlink" title="高级部分（应用场景）"></a>高级部分（应用场景）</h1><h2 id="一、-如何让观察者区别对待"><a href="#一、-如何让观察者区别对待" class="headerlink" title="一、 如何让观察者区别对待"></a>一、 如何让观察者区别对待</h2><p>上面的demo，均是目前通知观察者的时候全部都通知，根据不同的情况来让不同的观察者处理操作，如何设计呢?</p>
<blockquote>
<p><code>思路</code>:2种，<br>一种是目标可以全部通知，但是观察者不做任何操作，<br>另一种就是在目标里面进行判断，直接不通知了，<br>这里推荐第二种，可以统一逻辑控制，并进行观察者的统一分派，有利于业务控制和今后的扩展。</p>
</blockquote>
<p>来个例子： 水质污染，根据污染情况分别通知检测员，预警人员，检测部门领导。<br>代如下:<br> <img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b5457513c6100af8e4d18aeafcfe6283_1737630628133.png" alt="在这里插入图片描述"></p>
<p>WaterQualitySubject - 水质监测的目标对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义水质监测的目标对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">WaterQualitySubject</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用来保存注册</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> List&lt;WatcherObserver&gt; observers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(WatcherObserver observer)</span>&#123;</span><br><span class="line">        observers.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(WatcherObserver observer)</span>&#123;</span><br><span class="line">        observers.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通知相应的观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">notifyWathers</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取水质污染的级别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">int</span> <span class="title function_">getPolluteLevel</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>WaterQuality -  具体的水质监测对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的水质监测对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WaterQuality</span> <span class="keyword">extends</span> <span class="title class_">WaterQualitySubject</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 污染的级别，0表示正常，1表示轻度污染，2表示中度污染，3表示高度污染</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">polluteLevel</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取水质污染的级别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPolluteLevel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> polluteLevel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPolluteLevel</span><span class="params">(<span class="type">int</span> polluteLevel)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.polluteLevel = polluteLevel;</span><br><span class="line">        <span class="built_in">this</span>.notifyWathers();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通知相应的观察者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyWathers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//循环所在注册的观察者</span></span><br><span class="line">        <span class="keyword">for</span> (WatcherObserver watcher: observers)&#123;</span><br><span class="line">            <span class="comment">//开始根据污染级别判断是否需要通知，由这里总控</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.polluteLevel &gt;=<span class="number">0</span> )&#123;</span><br><span class="line">                <span class="comment">//通知监测员做记录</span></span><br><span class="line">                <span class="keyword">if</span> ((<span class="string">&quot;监测人员&quot;</span>).equals(watcher.getJob()))&#123;</span><br><span class="line">                    watcher.update(<span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.polluteLevel &gt;=<span class="number">1</span> )&#123;</span><br><span class="line">                <span class="comment">//通知预警人员</span></span><br><span class="line">                <span class="keyword">if</span> ((<span class="string">&quot;预警人员&quot;</span>).equals(watcher.getJob()))&#123;</span><br><span class="line">                    watcher.update(<span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.polluteLevel &gt;=<span class="number">2</span> )&#123;</span><br><span class="line">                <span class="comment">//通知监测员部门领导</span></span><br><span class="line">                <span class="keyword">if</span> ((<span class="string">&quot;监测部门领导&quot;</span>).equals(watcher.getJob()))&#123;</span><br><span class="line">                    watcher.update(<span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>WatcherObserver</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WatcherObserver</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 被通知的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(WaterQualitySubject subject)</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置观察人员的职务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setJob</span><span class="params">(String job)</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取观察人员的职务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getJob</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Watcher</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Watcher</span>  <span class="keyword">implements</span> <span class="title class_">WatcherObserver</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(WaterQualitySubject subject)</span> &#123;</span><br><span class="line">        <span class="comment">//这里采用的是拉的方式</span></span><br><span class="line">        System.out.println(job+<span class="string">&quot;获取到通知，当前污染级别为:&quot;</span> + subject.getPolluteLevel());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setJob</span><span class="params">(String job)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.job = job;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getJob</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.job;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> Test</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建水质主题对象</span></span><br><span class="line">        <span class="type">WaterQuality</span> <span class="variable">subject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WaterQuality</span>();</span><br><span class="line">        <span class="comment">//创建几个观察者</span></span><br><span class="line">        <span class="type">WatcherObserver</span> <span class="variable">watcher1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Watcher</span>();</span><br><span class="line">        watcher1.setJob(<span class="string">&quot;监测人员&quot;</span>);</span><br><span class="line">        <span class="type">WatcherObserver</span> <span class="variable">watcher2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Watcher</span>();</span><br><span class="line">        watcher2.setJob(<span class="string">&quot;预警人员&quot;</span>);</span><br><span class="line">        <span class="type">WatcherObserver</span> <span class="variable">watcher3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Watcher</span>();</span><br><span class="line">        watcher3.setJob(<span class="string">&quot;监测部门领导&quot;</span>);</span><br><span class="line">        <span class="comment">//注册观察者</span></span><br><span class="line">        subject.attach(watcher1);</span><br><span class="line">        subject.attach(watcher2);</span><br><span class="line">        subject.attach(watcher3);</span><br><span class="line">        <span class="comment">//填写水质报告</span></span><br><span class="line">        System.out.println(<span class="string">&quot;当水质为正常的时候-----------&quot;</span>);</span><br><span class="line">        subject.setPolluteLevel(<span class="number">0</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;当水质为轻度污染的时候-----------&quot;</span>);</span><br><span class="line">        subject.setPolluteLevel(<span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;当水质为中度污染的时候-----------&quot;</span>);</span><br><span class="line">        subject.setPolluteLevel(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/38f453e7f4f1ac1bd82b1d4d9eafc0d3_1737630628133.png" alt="在这里插入图片描述"></p>
<p>可以看到根据预警级别通知了不同的观察者。<br>主要逻辑在目标对象实现类上，在if的判断上是比较取巧的写法，不是if 。。else if .. .,而是多个if。组合if，好好体会学习，以后借鉴使用下。</p>
<h2 id="二、如何不依赖抽象观察者，也能实现观察者模式："><a href="#二、如何不依赖抽象观察者，也能实现观察者模式：" class="headerlink" title="二、如何不依赖抽象观察者，也能实现观察者模式："></a>二、如何不依赖抽象观察者，也能实现观察者模式：</h2><p>上面的例子，都是有个抽象观察者的角色的，目标对象直接操作抽象观察者。如果不想使用抽象观察者，考虑的思路如下:</p>
<ul>
<li>1.新建抽象观察者类这个事情，别人给提供，我们实现它就好了，这里我们可以<code>使用java自带的观察者模式</code>，他已经帮我们自动提供了抽象观察者，和抽象目标类，我们按照他的规则直接使用就可以了。</li>
<li><input disabled="" type="checkbox"> 这里一会展示 使用java自带的观察者模式的例子:</li>
<li>2.注册观察者和通知观察者的工作交给一个第三方，解耦目标和观察者。<br>这种实现的方式很多，主要思路是<code>反射委托</code>。</li>
</ul>
<p>这里一会展示4个例子:</p>
<ul>
<li><input disabled="" type="checkbox"> 反射委托实现上面第2个例子，上课看nba和动漫，老师来了，做出不同反应的例子。</li>
<li><input disabled="" type="checkbox"> 比如:模仿swing组件实现原理的例子（<code>这个例子很特别，观察者可以观察多个目标对象</code>）</li>
<li><input disabled="" type="checkbox"> spring中listener实现观察者模式的例子</li>
<li><input disabled="" type="checkbox"> springboot使用Guava框架提供的eventBus，实现事件处理的例子。</li>
</ul>
<h3 id="1-使用java自带的观察者模式的例子"><a href="#1-使用java自带的观察者模式的例子" class="headerlink" title="1.使用java自带的观察者模式的例子"></a>1.使用java自带的观察者模式的例子</h3><p>java提供抽象观察者Observer，抽象目标对象Observable，通知观察者的方法名必须是update。通知前必须调动setChange()方法，具体代码如下:</p>
<p>具体目标类(被观察者)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: GPer</span></span><br><span class="line"><span class="comment"> * Description: JDK提供的一种观察者的实现方式，被观察者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-06-03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GPer</span> <span class="keyword">extends</span> <span class="title class_">Observable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;GPer生态圈&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">GPer</span> <span class="variable">gper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">GPer</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> GPer <span class="title function_">getInstance</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> == gper)&#123;</span><br><span class="line">            gper = <span class="keyword">new</span> <span class="title class_">GPer</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> gper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publishQuestion</span><span class="params">(Question question)</span>&#123;</span><br><span class="line">        System.out.println(question.getUserName() + <span class="string">&quot;在&quot;</span> + <span class="built_in">this</span>.name + <span class="string">&quot;上提交了一个问题。&quot;</span>);</span><br><span class="line">        setChanged();</span><br><span class="line">        notifyObservers(question);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>来个辅助的类，和观察者模式没啥关系的业务类:Question</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: Question</span></span><br><span class="line"><span class="comment"> * Description: TODO</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-06-03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Question</span> &#123;</span><br><span class="line">    <span class="comment">//提问者</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="comment">//提问问题</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserName</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContent</span><span class="params">(String content)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>具体的观察者类:Teacher</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Teacher</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Teacher</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Observable o, Object arg)</span> &#123;</span><br><span class="line">        <span class="type">GPer</span> <span class="variable">gper</span> <span class="operator">=</span> (GPer)o;</span><br><span class="line">        <span class="type">Question</span> <span class="variable">question</span> <span class="operator">=</span> (Question)arg;</span><br><span class="line">        System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">        System.out.println(name + <span class="string">&quot;老师，你好！\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;您收到了一个来自“&quot;</span> + gper.getName() + <span class="string">&quot;”的提问，希望您解答，问题内容如下：\n&quot;</span> +</span><br><span class="line">                question.getContent() + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;提问者：&quot;</span> + question.getUserName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>测试类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObserverTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">GPer</span> <span class="variable">gper</span> <span class="operator">=</span> GPer.getInstance();</span><br><span class="line">        <span class="type">Teacher</span> <span class="variable">tom</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Teacher</span>(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">        <span class="type">Teacher</span> <span class="variable">mic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Teacher</span>(<span class="string">&quot;Mic&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//这为没有@Tom老师</span></span><br><span class="line">        <span class="type">Question</span> <span class="variable">question</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Question</span>();</span><br><span class="line">        question.setUserName(<span class="string">&quot;小明&quot;</span>);</span><br><span class="line">        question.setContent(<span class="string">&quot;观察者设计模式适用于哪些场景？&quot;</span>);</span><br><span class="line">        gper.addObserver(tom);</span><br><span class="line">        gper.addObserver(mic);</span><br><span class="line">        gper.publishQuestion(question);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/91cb0e5753d2dbb45a9e89e6dd91085f_1737630639674.png" alt="在这里插入图片描述"><br>查看结果，完美的展示了目标对象通知所有观察者的实现。</p>
<h3 id="2-反射委托实现上面第2个例子，学生根据老师到来，做出不同反应的例子。"><a href="#2-反射委托实现上面第2个例子，学生根据老师到来，做出不同反应的例子。" class="headerlink" title="2.反射委托实现上面第2个例子，学生根据老师到来，做出不同反应的例子。"></a>2.反射委托实现上面第2个例子，学生根据老师到来，做出不同反应的例子。</h3><p>具体代码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ee272b5355a52aeb17c5c1cd96ee2653_1737630639674.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 事件对象的封装类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Administrator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Event</span> &#123;</span><br><span class="line">    <span class="comment">//要执行方法的对象   </span></span><br><span class="line">    <span class="keyword">private</span> Object object;</span><br><span class="line">    <span class="comment">//要执行的方法名称   </span></span><br><span class="line">    <span class="keyword">private</span> String methodName;</span><br><span class="line">    <span class="comment">//要执行方法的参数   </span></span><br><span class="line">    <span class="keyword">private</span> Object[] params;</span><br><span class="line">    <span class="comment">//要执行方法的参数类型   </span></span><br><span class="line">    <span class="keyword">private</span> Class[] paramTypes;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Event</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Event</span><span class="params">(Object object, String methodName, Object... args)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.object = object;</span><br><span class="line">        <span class="built_in">this</span>.methodName = methodName;</span><br><span class="line">        <span class="built_in">this</span>.params = args;</span><br><span class="line">        contractParamTypes(<span class="built_in">this</span>.params);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据参数数组生成参数类型数组   </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">contractParamTypes</span><span class="params">(Object[] params)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.paramTypes = <span class="keyword">new</span> <span class="title class_">Class</span>[params.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">            <span class="built_in">this</span>.paramTypes[i] = params[i].getClass();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObject</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里省略了若干get和set方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据该对象的方法名，方法参数，利用反射机制，执行该方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> object.getClass().getMethod(<span class="built_in">this</span>.getMethodName(), <span class="built_in">this</span>.getParamTypes());</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == method) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        method.invoke(<span class="built_in">this</span>.getObject(), <span class="built_in">this</span>.getParams());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setObject</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.object = object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMethodName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> methodName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMethodName</span><span class="params">(String methodName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.methodName = methodName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object[] getParams() &#123;</span><br><span class="line">        <span class="keyword">return</span> params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParams</span><span class="params">(Object[] params)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.params = params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Class[] getParamTypes() &#123;</span><br><span class="line">        <span class="keyword">return</span> paramTypes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParamTypes</span><span class="params">(Class[] paramTypes)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.paramTypes = paramTypes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>EventHandler</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: EventHandler</span></span><br><span class="line"><span class="comment"> * Description: 事件的 处理者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-06-05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventHandler</span> &#123;</span><br><span class="line">    <span class="comment">//是用一个List</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Event&gt; objects;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EventHandler</span><span class="params">()</span>&#123;</span><br><span class="line">        objects=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Event&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加某个对象要执行的事件，及需要的参数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addEvent</span><span class="params">(Object object,String methodName,Object...args)</span>&#123;</span><br><span class="line">        objects.add(<span class="keyword">new</span> <span class="title class_">Event</span>(object,methodName,args));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//通知所有的对象执行指定的事件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyX</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">for</span>(Event e : objects)&#123;</span><br><span class="line">            e.invoke();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通知者的 抽象类Notifier</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Notifier</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">EventHandler</span> <span class="variable">eventHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EventHandler</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> EventHandler <span class="title function_">getEventHandler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> eventHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEventHandler</span><span class="params">(EventHandler eventHandler)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.eventHandler = eventHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 增加需要帮忙 放哨 的 学生</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object     要执行方法的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodName 执行方法 的方法名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args       执行方法的参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">addListener</span><span class="params">(Object object, String methodName,  Object... args)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 告诉所有要帮忙放哨的学生：老师来了</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">notifyX</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通知者 GoodNotifier</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GoodNotifier</span> <span class="keyword">extends</span> <span class="title class_">Notifier</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addListener</span><span class="params">(Object object, String methodName, Object... args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;有新的同学委托尽职尽责的放哨人!&quot;</span>);</span><br><span class="line">        <span class="type">EventHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="built_in">this</span>.getEventHandler();</span><br><span class="line">        handler.addEvent(object, methodName, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyX</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;尽职尽责的放哨人告诉所有需要帮忙的同学：老师来了&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.getEventHandler().notifyX();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>WatchCartoonListener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: WatchCartoonListener</span></span><br><span class="line"><span class="comment"> * Description:  具体监听者（观察者）</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-06-05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WatchCartoonListener</span> <span class="keyword">extends</span> <span class="title class_">GoodNotifier</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WatchCartoonListener</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WatchCartoonListener 我正在看漫画，开始时间：&quot;</span>+ LocalDateTime.now().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stopPlayingGame</span><span class="params">(Date date)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WatchCartoonListener  停止看漫画了，结束时间：&quot;</span>+ <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(date));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>WatchingNBAListener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WatchingNBAListener</span> <span class="keyword">extends</span> <span class="title class_">GoodNotifier</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WatchingNBAListener</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WatchingNBAListener我正在看NBA,开始时间是： &quot;</span> + LocalDateTime.now().toString());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stopWatchingTV</span><span class="params">(Date date)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WatchingNBAListener 快关闭NBA直播 ， 结束时间是：&quot;</span> +  <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(date));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>测试类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一个尽职尽责的放哨者</span></span><br><span class="line">        <span class="type">Notifier</span> <span class="variable">goodNotifier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GoodNotifier</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个玩游戏的同学，开始玩游戏</span></span><br><span class="line">        <span class="type">WatchCartoonListener</span> <span class="variable">playingGameListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WatchCartoonListener</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个看电视的同学，开始看电视</span></span><br><span class="line">        <span class="type">WatchingNBAListener</span> <span class="variable">watchingTVListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WatchingNBAListener</span>();</span><br><span class="line"><span class="comment">//玩游戏的同学告诉放哨的同学，老师来了告诉一下</span></span><br><span class="line">        goodNotifier.addListener(playingGameListener, <span class="string">&quot;stopPlayingGame&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"><span class="comment">//看电视的同学告诉放哨的同学，老师来了告诉一下</span></span><br><span class="line">        goodNotifier.addListener(watchingTVListener, <span class="string">&quot;stopWatchingTV&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//一点时间后</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//老师出现，放哨的人通知所有要帮忙的同学:老师来了</span></span><br><span class="line">        goodNotifier.notifyX();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一个尽职尽责的放哨者</span></span><br><span class="line">        <span class="type">Notifier</span> <span class="variable">goodNotifier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GoodNotifier</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个玩游戏的同学，开始玩游戏</span></span><br><span class="line">        <span class="type">WatchCartoonListener</span> <span class="variable">playingGameListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WatchCartoonListener</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个看电视的同学，开始看电视</span></span><br><span class="line">        <span class="type">WatchingNBAListener</span> <span class="variable">watchingTVListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WatchingNBAListener</span>();</span><br><span class="line"><span class="comment">//玩游戏的同学告诉放哨的同学，老师来了告诉一下</span></span><br><span class="line">        goodNotifier.addListener(playingGameListener, <span class="string">&quot;stopPlayingGame&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"><span class="comment">//看电视的同学告诉放哨的同学，老师来了告诉一下</span></span><br><span class="line">        goodNotifier.addListener(watchingTVListener, <span class="string">&quot;stopWatchingTV&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//一点时间后</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//老师出现，放哨的人通知所有要帮忙的同学:老师来了</span></span><br><span class="line">        goodNotifier.notifyX();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/09e69fbf1ef2aa39ba2385c8b2d2ac22_1737630639674.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>事件委托机制 分析<br>1.放哨者完全不知道做游戏者的存在，完全解耦。（当然，功劳归功于Event和EventHandler，且这两个类具有通用性）<br>2.老师来了后游戏者停止游戏回到座位，看NBA者停止看NBA，看漫画这停止看漫画，玩游戏这停止玩游戏。（一次通知，执行了不同类的不同方法）<br>3.扩展性很高，再来一个打篮球的学生就先写个打篮球学生类，并在测试代码中告诉放哨者一下就好，放哨者完全没有变。重用性好</p>
</blockquote>
<p>看了这个例子，再来了解swing组件监听的例子就简单多了，因为原理完全一样，都是有事件和事件处理者管理和调用观察者的方法。</p>
<h3 id="3-swing组件监听的例子"><a href="#3-swing组件监听的例子" class="headerlink" title="3.swing组件监听的例子"></a>3.swing组件监听的例子</h3><p>具体看下代码:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8e247c252b7aa68c31955ce5c4eb33e0_1737630639674.png" alt="在这里插入图片描述"></p>
<p>这个例子比较强大，既体现了委托注册观察者，又有某个观察者的方法对应某个目标类的具体方法，方法到方法的对应。好好理解，学习，争取项目中使用下:<br>Event</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Event</span> &#123;</span><br><span class="line">    <span class="comment">//事件源，事件是由谁发起的保存起来</span></span><br><span class="line">    <span class="keyword">private</span> Object source;</span><br><span class="line">    <span class="comment">//事件触发，要通知谁</span></span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line">    <span class="comment">//事件触发，要做什么动作，回调</span></span><br><span class="line">    <span class="keyword">private</span> Method callback;</span><br><span class="line">    <span class="comment">//事件的名称，触发的是什么事件</span></span><br><span class="line">    <span class="keyword">private</span> String trigger;</span><br><span class="line">    <span class="comment">//事件触发的时间</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> time;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Event</span><span class="params">(Object target, Method callback)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">        <span class="built_in">this</span>.callback = callback;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Event <span class="title function_">setSource</span><span class="params">(Object source)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.source = source;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Event <span class="title function_">setTime</span><span class="params">(<span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.time = time;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Event <span class="title function_">setTrigger</span><span class="params">(String trigger)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.trigger = trigger;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getTarget</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Method <span class="title function_">getCallback</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> callback;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Event&#123;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\tsource=&quot;</span> + source.getClass() + <span class="string">&quot;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\ttarget=&quot;</span> + target.getClass() + <span class="string">&quot;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\tcallback=&quot;</span> + callback + <span class="string">&quot;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\ttrigger=&#x27;&quot;</span> + trigger + <span class="string">&quot;&#x27;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\ttime=&quot;</span> + time + <span class="string">&quot;&#x27;\n&quot;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>EventLisenter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventLisenter</span> &#123;</span><br><span class="line">    <span class="comment">//JDK底层的Lisenter通常也是这样来设计的</span></span><br><span class="line">    <span class="keyword">protected</span> Map&lt;String, Event&gt; events = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Event&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//事件名称和一个目标对象来触发事件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLisenter</span><span class="params">(String eventType, Object target)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.addLisenter(</span><br><span class="line">                    eventType,</span><br><span class="line">                    target,</span><br><span class="line">                    target.getClass().getMethod(<span class="string">&quot;on&quot;</span> + toUpperFirstCase(eventType), Event.class));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLisenter</span><span class="params">(String eventType, Object target, Method callback)</span> &#123;</span><br><span class="line">        <span class="comment">//注册事件</span></span><br><span class="line">        events.put(eventType, <span class="keyword">new</span> <span class="title class_">Event</span>(target, callback));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//触发，只要有动作就触发</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">trigger</span><span class="params">(Event event)</span> &#123;</span><br><span class="line">        event.setSource(<span class="built_in">this</span>);</span><br><span class="line">        event.setTime(System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//发起回调</span></span><br><span class="line">            <span class="keyword">if</span> (event.getCallback() != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">//用反射调用它的回调函数</span></span><br><span class="line">                event.getCallback().invoke(event.getTarget(), event);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//事件名称触发</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">trigger</span><span class="params">(String trigger)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.events.containsKey(trigger)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        trigger(<span class="built_in">this</span>.events.get(trigger).setTrigger(trigger));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//逻辑处理的私有方法，首字母大写</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">toUpperFirstCase</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">char</span>[] chars = str.toCharArray();</span><br><span class="line">        chars[<span class="number">0</span>] -= <span class="number">32</span>;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(chars);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Mouse</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_">EventLisenter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">click</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用单击方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_CLICK);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doubleClick</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用双击方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_DOUBLE_CLICK);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">up</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用弹起方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_UP);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">down</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用按下方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_DOWN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用移动方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_MOVE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">wheel</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用滚动方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_WHEEL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">over</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用悬停方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_OVER);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">blur</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用获焦方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_BLUR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">focus</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用失焦方法&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.trigger(MouseEventType.ON_FOCUS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MouseEventCallback</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自己写的逻辑，用于回调</span></span><br><span class="line"><span class="comment"> * Created by Tom.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MouseEventCallback</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标单击事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDoubleClick</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标双击事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUp</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标弹起事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDown</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标按下事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMove</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标移动事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onWheel</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标滚动事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOver</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标悬停事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBlur</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标失焦事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFocus</span><span class="params">(Event e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========触发鼠标获焦事件==========&quot;</span> + <span class="string">&quot;\n&quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>MouseEventType</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MouseEventType</span> &#123;</span><br><span class="line">    <span class="comment">//单击</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_CLICK</span> <span class="operator">=</span> <span class="string">&quot;click&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//双击</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_DOUBLE_CLICK</span> <span class="operator">=</span> <span class="string">&quot;doubleClick&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//弹起</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_UP</span> <span class="operator">=</span> <span class="string">&quot;up&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//按下</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_DOWN</span> <span class="operator">=</span> <span class="string">&quot;down&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//移动</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_MOVE</span> <span class="operator">=</span> <span class="string">&quot;move&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//滚动</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_WHEEL</span> <span class="operator">=</span> <span class="string">&quot;wheel&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//悬停</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_OVER</span> <span class="operator">=</span> <span class="string">&quot;over&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//失焦</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_BLUR</span> <span class="operator">=</span> <span class="string">&quot;blur&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获焦</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ON_FOCUS</span> <span class="operator">=</span> <span class="string">&quot;focus&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MouseEventTest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MouseEventTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MouseEventCallback</span> <span class="variable">callback</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MouseEventCallback</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">Mouse</span> <span class="variable">mouse</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Mouse</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//@谁？  @回调方法</span></span><br><span class="line">        mouse.addLisenter(MouseEventType.ON_CLICK,callback);</span><br><span class="line">        mouse.addLisenter(MouseEventType.ON_FOCUS,callback);</span><br><span class="line"></span><br><span class="line">        mouse.click();</span><br><span class="line"></span><br><span class="line">        mouse.focus();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Keybord</span> <span class="keyword">extends</span> <span class="title class_">EventLisenter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">down</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">up</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a2fe5aeb6d7c293649ac9485c558f4ba_1737630639674.png" alt="在这里插入图片描述"></p>
<h3 id="4-spring中listener实现观察者模式的例子"><a href="#4-spring中listener实现观察者模式的例子" class="headerlink" title="4.spring中listener实现观察者模式的例子"></a>4.spring中listener实现观察者模式的例子</h3><p>Spring的事件机制用到了观察者模式。在此种模式中，一个目标物件管理所有相依于它的观察者物件，并且在它本身的状态改变时主动发出通知。这通常透过呼叫各观察者所提供的方法来实现。此种模式通常被用来实现事件处理系统。<br>在Spring中各个listener相当于观察者。event事件相当于目标，观察者，而容器用来管理和注册观察者，发布事件。</p>
<p>具体的演示代码如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/77ecd26b7ab258f73e6c0e5d623d324a_1737630651591.png" alt="在这里插入图片描述"></p>
<p>事件类:OrderEvent 相当于目标类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderEvent</span><span class="params">(Object source)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OrderSmsListener相当于观察者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderSmsListener</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span>&lt;OrderEvent&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(OrderEvent orderEvent)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;orderSmsListener receive event from &quot;</span> + orderEvent.getSource());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>业务类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">order</span><span class="params">()</span> &#123;</span><br><span class="line">        applicationContext.publishEvent(<span class="keyword">new</span> <span class="title class_">OrderEvent</span>(<span class="string">&quot;orderService&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外spring容器相当于委托类。<br>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PatternApplicationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        orderService.order();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/06d34f4a273b5085b60acc5077bb806e_1737630651591.png" alt="在这里插入图片描述"><br>显示，事件发布后，监听这就能观察到这个事件了，可以做更多的操作。</p>
<h3 id="5-springboot中集成谷歌的Guava，通过eventBus实现订阅发布功能"><a href="#5-springboot中集成谷歌的Guava，通过eventBus实现订阅发布功能" class="headerlink" title="5.springboot中集成谷歌的Guava，通过eventBus实现订阅发布功能"></a>5.springboot中集成谷歌的Guava，通过eventBus实现订阅发布功能</h3><p>EventBus无需实现复杂的事件、监听者、发布者。前面讲的是面向类，现在：Guava是面向是方法，更加强大。能够轻松落地观察模式的一种解决方案。</p>
<p>演示个例子:<br>引入Guava的包:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>20.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>EventBus 事件总线</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//api封装</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEventBus</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 事件任务总线 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">EventBus</span> <span class="variable">tiemEventBus</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EventBus</span>();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 触发同步事件</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> event</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">post</span><span class="params">(Object event)</span> &#123;</span><br><span class="line">        tiemEventBus.post(event);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册事件处理器</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(Object handler)</span> &#123;</span><br><span class="line">        tiemEventBus.register(handler);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注销事件处理器</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unregister</span><span class="params">(Object handler)</span> &#123;</span><br><span class="line">        tiemEventBus.unregister(handler);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>消息实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> MessageType messageType;</span><br><span class="line">    <span class="keyword">private</span> String messageContent;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Message</span><span class="params">(MessageType messageType, String messageContent)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.messageType = messageType;</span><br><span class="line">        <span class="built_in">this</span>.messageContent = messageContent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> MessageType <span class="title function_">getMessageType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> messageType;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessageType</span><span class="params">(MessageType messageType)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.messageType = messageType;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessageContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> messageContent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessageContent</span><span class="params">(String messageContent)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.messageContent = messageContent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">MessageType</span> &#123;</span><br><span class="line">        OPENDOOR(<span class="number">1</span>, <span class="string">&quot;openDoor&quot;</span>),</span><br><span class="line">        CLOSEDOOR(<span class="number">2</span>,<span class="string">&quot;closeDoor&quot;</span>);</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line">        <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">        MessageType(<span class="type">int</span> code, String value) &#123;</span><br><span class="line">            <span class="built_in">this</span>.code = code;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> code;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.code = code;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(String value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>事件监听者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">MyApplicationListener</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span>&lt;ApplicationPreparedEvent&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  ApplicationPreparedEvent 上下文准备事件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> applicationPreparedEvent</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(ApplicationPreparedEvent applicationPreparedEvent)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> applicationPreparedEvent.getApplicationContext();</span><br><span class="line">        <span class="type">MyApplicationListener</span> <span class="variable">bean</span> <span class="operator">=</span> applicationContext.getBean(<span class="built_in">this</span>.getClass());</span><br><span class="line">        System.out.println(<span class="string">&quot;regist listener to eventBus....&quot;</span>+bean);</span><br><span class="line">        MyEventBus.register(bean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>订阅者（也即监听者）继承至MyApplicationListener。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListentenerSubscribe</span> <span class="keyword">extends</span> <span class="title class_">MyApplicationListener</span>&#123;</span><br><span class="line">    <span class="meta">@Subscribe</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;subscribe message-&gt;  messgeType：&quot;</span>+message.getMessageType()+<span class="string">&quot;\n messageContent：&quot;</span>+message.getMessageContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventPublishCtrl</span> <span class="keyword">extends</span> <span class="title class_">LogBase</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/publish&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publishEvent</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;this publish method...&quot;</span>);</span><br><span class="line">        MyEventBus.post(<span class="keyword">new</span> <span class="title class_">Message</span>(Message.MessageType.OPENDOOR,<span class="string">&quot;芝麻开门！&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>启动项目，然后调用发布方法:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d5f6b56113691f333d2f2731df0dd2d6_1737630651591.png" alt="在这里插入图片描述"></p>
<p>订阅者收到具体的消息类型，以及消息内容。</p>
<hr>
<h2 id="三、观察者模式的本质"><a href="#三、观察者模式的本质" class="headerlink" title="三、观察者模式的本质"></a>三、观察者模式的本质</h2><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b5c0a1fa4914a0385bac93871e64c9b3_1737630651591.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/99d089809231e770b9917a770c5d7639_1737630651591.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>上面主要介绍了观察者模式的基本经典结构；入门小demo；使用的2种方式；观察者模式变形写法；java中封装好的观察者模式使用方式;不依赖抽象观察者的方式，比如使用反射委托例子，swing使用观察者的例子，spring中listener观察者模式实现的例子，springboot 的eventBus的观察者模式的例子. 最后说下观察者模式的本质。</p>
</blockquote>
<p>自此，观察者模式总算写完了，其实后续可能会有加上mq的例子，还没深入学习，先这样吧。</p>
<p>参考文章:<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/gdutxiaoxu/article/details/51824769">https://blog.csdn.net/gdutxiaoxu/article/details/51824769</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/fw19940314/article/details/100010397">https://blog.csdn.net/fw19940314/article/details/100010397</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wkzhao/p/10229283.html">https://www.cnblogs.com/wkzhao/p/10229283.html</a></p>
<hr>
<p>个人微信公众号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/undefined/img/2025-1-13/42409b1dbd9a6b7ff63471ea0769592d_1737631173950.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/06/02/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/02/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">深入理解装饰者模式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-02 23:23:40" itemprop="dateCreated datePublished" datetime="2020-06-02T23:23:40+08:00">2020-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[toc]</p>
<h1 id="基础部分"><a href="#基础部分" class="headerlink" title="基础部分"></a>基础部分</h1><h2 id="装饰者模式的类图"><a href="#装饰者模式的类图" class="headerlink" title="装饰者模式的类图"></a>装饰者模式的类图</h2><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8640bed573fc69b451bb6c18e86a361f_1737630664054.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/faaa5fc7e6891cbf1c978852cc79f03b_1737630664054.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/abe280d4d20c9e1301c4bd795167b224_1737630664054.png" alt="在这里插入图片描述"></p>
<h2 id="装饰者模式的简单入门案例"><a href="#装饰者模式的简单入门案例" class="headerlink" title="装饰者模式的简单入门案例"></a>装饰者模式的简单入门案例</h2><blockquote>
<p>来看一个这样的场景，有些小伙伴可能在上班路上碰到卖煎饼的路边摊，都会顺带一个到公司茶水间吃早餐。卖煎饼的大姐可以给你的煎饼加鸡蛋，也可以加香肠.<br>用装饰者实现计算总价:</p>
</blockquote>
<p>类图：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/fee69ef5d34e05183910e64a2803ecc4_1737630664054.png" alt="在这里插入图片描述"><br>煎饼类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Battercake</span> &#123;</span><br><span class="line">	<span class="keyword">protected</span> String <span class="title function_">getMsg</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;煎饼&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>基础套餐</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseBattercake</span> <span class="keyword">extends</span> <span class="title class_">Battercake</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String <span class="title function_">getMsg</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;煎饼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>抽象装饰类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: BattercakeDecorator</span></span><br><span class="line"><span class="comment"> * Description: 加蛋糕的套餐</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BattercakeDecorator</span> <span class="keyword">extends</span> <span class="title class_">Battercake</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Battercake battercake;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BattercakeDecorator</span><span class="params">(Battercake battercake)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.battercake = battercake;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//、用于扩展一个类的功能或给一个类添加附加职责。</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String <span class="title function_">getMsg</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.battercake.getMsg();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.battercake.getPrice() ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>鸡蛋装饰者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: EggDecorator</span></span><br><span class="line"><span class="comment"> * Description: 鸡蛋装饰者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EggDecorator</span> <span class="keyword">extends</span> <span class="title class_">BattercakeDecorator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EggDecorator</span><span class="params">(Battercake battercake)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(battercake);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String <span class="title function_">getMsg</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getMsg()+<span class="string">&quot;+1个鸡蛋&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getPrice()+ <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Title: SausageDecorator</span></span><br><span class="line"><span class="comment"> * Description: 香肠装饰者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hfl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-05-31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SausageDecorator</span> <span class="keyword">extends</span> <span class="title class_">BattercakeDecorator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SausageDecorator</span><span class="params">(Battercake battercake)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(battercake);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String <span class="title function_">getMsg</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getMsg() + <span class="string">&quot;1根香肠&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getPrice() + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>测试类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BattercakeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Battercake battercake;</span><br><span class="line">        <span class="comment">//路边摊买一个煎饼</span></span><br><span class="line">        battercake = <span class="keyword">new</span> <span class="title class_">BaseBattercake</span>();</span><br><span class="line">        <span class="comment">//煎饼有点小，想再加一个鸡蛋</span></span><br><span class="line">        battercake = <span class="keyword">new</span> <span class="title class_">EggDecorator</span>(battercake);</span><br><span class="line">        <span class="comment">//再加一个鸡蛋</span></span><br><span class="line">        battercake = <span class="keyword">new</span> <span class="title class_">EggDecorator</span>(battercake);</span><br><span class="line">        <span class="comment">//很饿，再加根香肠</span></span><br><span class="line">        battercake = <span class="keyword">new</span> <span class="title class_">SausageDecorator</span>(battercake);</span><br><span class="line">        <span class="comment">//跟静态代理最大区别就是职责不同</span></span><br><span class="line">        <span class="comment">//静态代理不一定要满足is-a 的关系</span></span><br><span class="line">        <span class="comment">//静态代理会做功能增强，同一个职责变得不一样</span></span><br><span class="line">        <span class="comment">//装饰器更多考虑是扩展</span></span><br><span class="line">        System.out.println(battercake.getMsg() + <span class="string">&quot;,总价：&quot;</span> + battercake.getPrice());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/eb6866d94d410af094515e128e6c93b6_1737630678430.png" alt="在这里插入图片描述"></p>
<h1 id="高级部分"><a href="#高级部分" class="headerlink" title="高级部分"></a>高级部分</h1><h2 id="装饰者模式的本质"><a href="#装饰者模式的本质" class="headerlink" title="装饰者模式的本质"></a>装饰者模式的本质</h2><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/46260d5740ac62f8822d919666f1b9cb_1737630678431.png" alt="在这里插入图片描述"></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a9980acedb0f2165845e4b42b35751c4_1737630678431.png" alt="在这里插入图片描述"><br>  怎么理解本质说的这2个方面：</p>
<h3 id="类的层面考虑-横向扩展（动态扩展）—-类比继承"><a href="#类的层面考虑-横向扩展（动态扩展）—-类比继承" class="headerlink" title="类的层面考虑:横向扩展（动态扩展）— 类比继承"></a>类的层面考虑:横向扩展（动态扩展）— 类比继承</h3><p>我们如果有个类，有一些方法，而如果需要扩展这个类的方法，可能想到的是继承，可是java是单继承，所以为了满足客户端的需求，又做到单一性原则，可能需要继承好几层。纵向的链路会特别长。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A()&#123;&#125;</span><br><span class="line">B <span class="keyword">extends</span> <span class="title class_">A</span>&#123;&#125;</span><br><span class="line">C extens B&#123;&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>而装饰者模式，相当于横向扩展，大多数情况下，只会继承一层，但是要将继承的类，放在属性上，通过构造函数注入。一个装饰者扩展了某个功能后，返回的外观还是和注入的类同一个父类，下一个装饰者可以将上一个装饰者注入到自己，然后实现自己的方法功能，调用起来就好像这个样子:<br><code>new A(new B( new C(....)))</code><br>这就是横向扩展，解决了java的单继承弊端，防止了继承的链路太长。</p>
<h3 id="对象方法的层面考虑-为装饰者透明的增加功能-甚至可以控制功能访问-—-类比AOP"><a href="#对象方法的层面考虑-为装饰者透明的增加功能-甚至可以控制功能访问-—-类比AOP" class="headerlink" title="对象方法的层面考虑:为装饰者透明的增加功能,甚至可以控制功能访问 — 类比AOP"></a>对象方法的层面考虑:为装饰者透明的增加功能,甚至可以控制功能访问 — 类比AOP</h3><p>我们用过spring开发的都知道，spring使用动态代理帮我们在类方法执行的前，中，后进行一些公共逻辑的提取，帮我们简化代码。<br>同样的： 装饰者模式可以通过装饰者增加功能，甚至给装饰前的对象织入自己的逻辑呢。<br>代码演示:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/27fe22f0c12aa10cc28364dc2b2c4ab4_1737630678431.png" alt="在这里插入图片描述"><br>封装销售单的数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SaleModel</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销售的商品</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String goods;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销售的数量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> saleNum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getGoods</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> goods;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGoods</span><span class="params">(String goods)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.goods = goods;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSaleNum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> saleNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSaleNum</span><span class="params">(<span class="type">int</span> saleNum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.saleNum = saleNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;SaleModel&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;goods=&#x27;&quot;</span> + goods + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, saleNum=&quot;</span> + saleNum +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 商品销售管理的业务接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">GoodSaleEbi</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存销售信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 操作人员</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cunstomer 客户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> saleModel 销售数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 是否保存成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sale</span><span class="params">(String user, String cunstomer, SaleModel saleModel)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>基本的业务实现对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GoodSaleEbo</span> <span class="keyword">implements</span> <span class="title class_">GoodSaleEbi</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sale</span><span class="params">(String user, String cunstomer, SaleModel saleModel)</span> &#123;</span><br><span class="line">        System.out.println(user + <span class="string">&quot;保存了，&quot;</span> + cunstomer + <span class="string">&quot;购买&quot;</span> + saleModel + <span class="string">&quot;的销售数据&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>抽象的装饰器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Decorator</span> <span class="keyword">implements</span> <span class="title class_">GoodSaleEbi</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 持有被装饰的组件对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> GoodSaleEbi ebi;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过构造方法传入被装饰的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ebi 被装饰的对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Decorator</span><span class="params">(GoodSaleEbi ebi)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.ebi = ebi;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>实现权限控制的装饰器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现权限控制的装饰器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CheckDecorator</span>  <span class="keyword">extends</span> <span class="title class_">Decorator</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过构造方法传入被装饰的对象</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ebi 被装饰的对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CheckDecorator</span><span class="params">(GoodSaleEbi ebi)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(ebi);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//权限控制逻辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sale</span><span class="params">(String user, String cunstomer, SaleModel saleModel)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">&quot;张三&quot;</span>.equals(user))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;对不起&quot;</span> + user + <span class="string">&quot;,你没有保存销售单的权限&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.ebi.sale(user,cunstomer,saleModel);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现日志记录</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogDecorator</span> <span class="keyword">extends</span> <span class="title class_">Decorator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LogDecorator</span><span class="params">(GoodSaleEbi ebi)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(ebi);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sale</span><span class="params">(String user, String cunstomer, SaleModel saleModel)</span> &#123;</span><br><span class="line">        <span class="comment">//执行业务</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">f</span> <span class="operator">=</span> <span class="built_in">this</span>.ebi.sale(user, cunstomer, saleModel);</span><br><span class="line">        <span class="comment">//在执行业务功能后记录日志</span></span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">simpleDateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;日志记录:&quot;</span> + user + <span class="string">&quot;于&quot;</span> + simpleDateFormat.format(<span class="keyword">new</span> <span class="title class_">Date</span>())</span><br><span class="line">                + <span class="string">&quot;时保存了一条销售记录，客户是：&quot;</span> + cunstomer + <span class="string">&quot;,购买记录是：&quot;</span> + saleModel);</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试:client</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//得到业务接口，组合装饰器</span></span><br><span class="line">        <span class="type">GoodSaleEbi</span> <span class="variable">ebi</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CheckDecorator</span>(<span class="keyword">new</span> <span class="title class_">LogDecorator</span>(<span class="keyword">new</span> <span class="title class_">GoodSaleEbo</span>()));</span><br><span class="line">        <span class="comment">//准备测试数据</span></span><br><span class="line">        <span class="type">SaleModel</span> <span class="variable">saleModel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SaleModel</span>();</span><br><span class="line">        saleModel.setGoods(<span class="string">&quot;moto 手机&quot;</span>);</span><br><span class="line">        saleModel.setSaleNum(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//调用业务功能</span></span><br><span class="line">        ebi.sale(<span class="string">&quot;张三&quot;</span>,<span class="string">&quot;张三丰&quot;</span>,saleModel);</span><br><span class="line">        ebi.sale(<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;张三丰&quot;</span>,saleModel);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e258bb7b7df0333407b5f08e4a222b63_1737630678431.png" alt="在这里插入图片描述"><br>在方法的前后都植入了逻辑，相当于模拟了Aop的功能。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9dd2caef5544e131aa05c0af727cb38d_1737630690372.png" alt="在这里插入图片描述"></p>
<h2 id="java源码重点使用的地方"><a href="#java源码重点使用的地方" class="headerlink" title="java源码重点使用的地方"></a>java源码重点使用的地方</h2><h3 id="io流"><a href="#io流" class="headerlink" title="io流"></a>io流</h3><p>典型的装饰者模式</p>
<h3 id="Spring-中的TransactionAwareCacheDecorator-类"><a href="#Spring-中的TransactionAwareCacheDecorator-类" class="headerlink" title="Spring 中的TransactionAwareCacheDecorator 类"></a>Spring 中的TransactionAwareCacheDecorator 类</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8968cf9cd2c8605766b579d9ffe88131_1737630690372.png" alt="在这里插入图片描述"></p>
<h3 id="MyBatis-中的一段处理缓存的设计org-apache-ibatis-cache-Cache"><a href="#MyBatis-中的一段处理缓存的设计org-apache-ibatis-cache-Cache" class="headerlink" title="MyBatis 中的一段处理缓存的设计org.apache.ibatis.cache.Cache"></a>MyBatis 中的一段处理缓存的设计org.apache.ibatis.cache.Cache</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e14653c4568592366b6d83a42079712c_1737630690372.png" alt="在这里插入图片描述"></p>
<h2 id="装饰者模式总结-深入反复理解"><a href="#装饰者模式总结-深入反复理解" class="headerlink" title="装饰者模式总结(深入反复理解)"></a>装饰者模式总结(深入反复理解)</h2><h3 id="装饰者模式的优缺点"><a href="#装饰者模式的优缺点" class="headerlink" title="装饰者模式的优缺点"></a>装饰者模式的优缺点</h3><p>优点：</p>
<ul>
<li>1、装饰者是继承的有力补充，比继承灵活，不改变原有对象的情况下动态地给一个对象<br>扩展功能，即插即用。</li>
<li>2、通过使用不同装饰类以及这些装饰类的排列组合，可以实现不同效果。</li>
<li>3、装饰者完全遵守开闭原则。<br>缺点：</li>
<li>1、会出现更多的代码，更多的类，增加程序复杂性。</li>
<li>2、动态装饰时，多层装饰时会更复杂。</li>
</ul>
<h2 id="和其他模式的相同和不同对比"><a href="#和其他模式的相同和不同对比" class="headerlink" title="和其他模式的相同和不同对比"></a>和其他模式的相同和不同对比</h2><h3 id="与适配器模式"><a href="#与适配器模式" class="headerlink" title="与适配器模式"></a>与适配器模式</h3><table>
<thead>
<tr>
<th></th>
<th>装饰者模式</th>
<th>适配器模式</th>
</tr>
</thead>
<tbody><tr>
<td>形式</td>
<td>是一种非常特别的适配器模式</td>
<td>没有层级关系，装饰器模式有层级关系</td>
</tr>
<tr>
<td>定义</td>
<td>装饰者和被装饰者都实现同一个接口，主要目的是为了扩展之后依旧保留OOP 关系</td>
<td>适配器和被适配者没有必然的联系，通常是采用继承或代理的形式进行包装</td>
</tr>
<tr>
<td>关系</td>
<td>关系满足is-a 的关系</td>
<td>满足has-a 的关系</td>
</tr>
<tr>
<td>功能</td>
<td>注重覆盖、扩展注重</td>
<td>兼容、转换</td>
</tr>
<tr>
<td>设计</td>
<td>设计前置考虑</td>
<td>后置考虑</td>
</tr>
</tbody></table>
<h3 id="与组合模式"><a href="#与组合模式" class="headerlink" title="与组合模式"></a>与组合模式</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/fb0774c7668c5a52dbfd9e6923371436_1737630690372.png" alt="在这里插入图片描述"></p>
<h3 id="与策略模式"><a href="#与策略模式" class="headerlink" title="与策略模式"></a>与策略模式</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f1c301195bb1a97d30dcae4a438f7cc3_1737630690372.png" alt="在这里插入图片描述"></p>
<h3 id="与模板方法模式"><a href="#与模板方法模式" class="headerlink" title="与模板方法模式"></a>与模板方法模式</h3><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/29885957241c420e4a7cfc503d6b7af9_1737630701374.png" alt="在这里插入图片描述"></p>
<p>以上截图的地方大部分来自&lt;研磨设计模式&gt;一书。</p>
<blockquote>
<p>“前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。<a target="_blank" rel="noopener" href="https://www.captainai.net/i690">点击跳转到网站</a>。”</p>
</blockquote>
<hr>
<p>个人微信公众号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/undefined/img/2025-1-13/42409b1dbd9a6b7ff63471ea0769592d_1737631173950.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/21/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><span class="page-number current">22</span><a class="page-number" href="/page/23/">23</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/23/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">胡方雷</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">1.8m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">26:40</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/hufanglei" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
