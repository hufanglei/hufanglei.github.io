<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hufanglei.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"scrollpercent":true,"onmobile":false},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
<meta property="og:type" content="blog">
<meta property="og:title" content="个人博客">
<meta property="og:url" content="https://hufanglei.github.io/page/28/index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="胡方雷">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hufanglei.github.io/page/28/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/28/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>个人博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">个人博客</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录生活中的点点滴滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">398</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">105</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">594</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="胡方雷"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">胡方雷</p>
  <div class="site-description" itemprop="description">直到这一刻微笑着说话为止，我至少留下了一公升眼泪</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">594</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">105</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">398</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hufanglei" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hufanglei" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://hufanglei.blog.csdn.net/" title="CSDN → https:&#x2F;&#x2F;hufanglei.blog.csdn.net" rel="noopener me" target="_blank"><i class="crosshairs fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:690328661@qq.com" title="E-Mail → mailto:690328661@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1518938&auto=1&height=66"></iframe>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title">
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="http://www.alloyteam.com/nav/" title="http:&#x2F;&#x2F;www.alloyteam.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">Web前端导航</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://www.uisdc.com/" title="http:&#x2F;&#x2F;www.uisdc.com&#x2F;" rel="noopener" target="_blank">优设</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://www.zhangxinxu.com/" title="http:&#x2F;&#x2F;www.zhangxinxu.com&#x2F;" rel="noopener" target="_blank">牛人文档</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://ife.baidu.com/" title="http:&#x2F;&#x2F;ife.baidu.com&#x2F;" rel="noopener" target="_blank">百度前端技术学院</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://wf.uisdc.com/cn/" title="http:&#x2F;&#x2F;wf.uisdc.com&#x2F;cn&#x2F;" rel="noopener" target="_blank">google前端开发基础</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/23/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(14)--springbootweb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/23/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(14)--springbootweb/" class="post-title-link" itemprop="url">springboot原理实战(14)--springbootweb</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-23 05:51:53" itemprop="dateCreated datePublished" datetime="2020-03-23T05:51:53+08:00">2020-03-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>18k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>16 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录:"></a>目录:</h1><p>本文章的大纲如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/24737d68dcc7a6e29a18e5631d57c88c_1737624990160.png" alt="在这里插入图片描述"></p>
<h1 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分:"></a>第一部分:</h1><h2 id="一、请求method"><a href="#一、请求method" class="headerlink" title="一、请求method"></a>一、请求method</h2><p>springboot的请求注解是<code>@RequestMapping(value = &quot;/user/home&quot;,method= RequestMethod.GET)</code><br>spring4.3以后可以使用: <code>@GetMapping(&quot;/user/home2&quot;)</code>,<code>@PostMapping(&quot;/user/create&quot;)</code>等语义化表示get，post等请求方法。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/909268694cd26da0d16a5ca3b56809b4_1737624990160.png" alt="在这里插入图片描述"></p>
<h2 id="二、传递参数的3种方式"><a href="#二、传递参数的3种方式" class="headerlink" title="二、传递参数的3种方式"></a>二、传递参数的3种方式</h2><h3 id="1-RequestParam"><a href="#1-RequestParam" class="headerlink" title="1.RequestParam"></a>1.RequestParam</h3><p>  <code>@RequestParam 默认必填，可以设置非必填，和默认值</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  <span class="doctag">@RequestParam</span> 注解默认是参数必须提供值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user/create&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">create</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;,defaultValue = &quot;admin&quot;)</span> String username, <span class="meta">@RequestParam(value=&quot;password&quot;,required = false)</span> String password)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user create, username=&quot;</span> + username + <span class="string">&quot;,password=&quot;</span>+password;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-url方式-PathVariable"><a href="#2-url方式-PathVariable" class="headerlink" title="2.url方式 @PathVariable"></a>2.url方式 @PathVariable</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取url的方式/user/1 ，/user/2</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">display</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;user display is=&quot;</span> + id;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-HttpServletRequest方式"><a href="#3-HttpServletRequest方式" class="headerlink" title="3.HttpServletRequest方式"></a>3.HttpServletRequest方式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/ip&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">edit</span><span class="params">(HttpServletRequest req)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user edit &quot;</span> + req.getRemoteHost();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="三、-RestController"><a href="#三、-RestController" class="headerlink" title="三、@RestController"></a>三、@RestController</h2><p>这个注解相当于@Controller+@RequestBody,用在视图访问层，表示当前controller的方法的返回值并可以直接用于body测试.返回json格式数据:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6472f1567c0373eeeb903aefee3b565b_1737624990160.png" alt="在这里插入图片描述"></p>
<h2 id="四、springboot的数据渲染到jsp页面"><a href="#四、springboot的数据渲染到jsp页面" class="headerlink" title="四、springboot的数据渲染到jsp页面"></a>四、springboot的数据渲染到jsp页面</h2><p>需要的步骤:</p>
<h3 id="1-配置文件"><a href="#1-配置文件" class="headerlink" title="1.配置文件:"></a>1.配置文件:</h3><p>application.properties加入2个配置项，执行页面路径和后缀</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class="line">spring.mvc.view.suffix=.jsp</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="2-加入-tomcat-embed-jasper的依赖"><a href="#2-加入-tomcat-embed-jasper的依赖" class="headerlink" title="2.加入 tomcat-embed-jasper的依赖"></a>2.加入 tomcat-embed-jasper的依赖</h3><p>pom.xml中:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;</span><br><span class="line">&lt;!--  &lt;version&gt;<span class="number">9.0</span><span class="number">.27</span>&lt;/version&gt;--&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--servlet依赖jar--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--Jstl标签依赖的jar包start--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>build下加入resoures</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">        &lt;resources&gt;</span><br><span class="line">&lt;!--            &lt;resource&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;directory&gt;src/main/java&lt;/directory&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;includes&gt;--&gt;</span><br><span class="line">&lt;!--                    &lt;include&gt;**<span class="comment">/*.xml&lt;/include&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                &lt;/includes&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;/resource&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;resource&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                &lt;directory&gt;src/main/resources&lt;/directory&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                &lt;includes&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                    &lt;include&gt;**/</span>*.*&lt;/include&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;/includes&gt;--&gt;</span><br><span class="line">&lt;!--            &lt;/resource&gt;--&gt;</span><br><span class="line">            &lt;resource&gt;</span><br><span class="line">                &lt;directory&gt;src/main/webapp&lt;/directory&gt;</span><br><span class="line">                &lt;targetPath&gt;META-INF/resources&lt;/targetPath&gt;</span><br><span class="line">                &lt;includes&gt;</span><br><span class="line">                    &lt;include&gt;**<span class="comment">/*.*&lt;/include&gt;</span></span><br><span class="line"><span class="comment">                &lt;/includes&gt;</span></span><br><span class="line"><span class="comment">            &lt;/resource&gt;</span></span><br><span class="line"><span class="comment">        &lt;/resources&gt;</span></span><br><span class="line"><span class="comment">    &lt;/build&gt;</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>
<h3 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试:"></a>3.测试:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String username, <span class="meta">@RequestParam(value = &quot;password&quot;)</span> String password)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (username.equals(password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 给jsp传参数，类似req.setAttribute</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> model</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">loginIndex</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>login.jsp页面:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>this is login page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>username is $&#123;username&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行入口函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo11Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo11Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果,显示已经数据已经渲染到jsp页面:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8ee2d573e76ab7a55c55614c0aa5cbb4_1737624990160.png" alt="在这里插入图片描述"></p>
<h2 id="五、springboot渲染数据到freemarker页面"><a href="#五、springboot渲染数据到freemarker页面" class="headerlink" title="五、springboot渲染数据到freemarker页面:"></a>五、springboot渲染数据到freemarker页面:</h2><p>在springboot中使用freemarker的步骤</p>
<h3 id="1-在pom-xml里面加入依赖"><a href="#1-在pom-xml里面加入依赖" class="headerlink" title="1. 在pom.xml里面加入依赖"></a>1. 在pom.xml里面加入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-配置文件修改freemarker的位置和后缀"><a href="#2-配置文件修改freemarker的位置和后缀" class="headerlink" title="2.配置文件修改freemarker的位置和后缀"></a>2.配置文件修改freemarker的位置和后缀</h3><p>看配置信息可以看源码: <code>FreeMarkerProperties</code>:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c1c694323cf18d393293c52019f956bf_1737624990160.png" alt="在这里插入图片描述"><br>我们在application.properties中修改配置信息:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.freemarker.templateLoaderPath=classpath:/ftl/</span><br><span class="line">spring.freemarker.suffix=.ftl</span><br></pre></td></tr></table></figure>

<h3 id="3-测试-1"><a href="#3-测试-1" class="headerlink" title="3.测试:"></a>3.测试:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/reg&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">req</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;reg&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>页面代码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/441cafe68d52a9c13dca25a49285a283_1737625001248.png" alt="在这里插入图片描述"><br>运行入口函数:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo11Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo11Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看页面，显示已经渲染到HTML页面:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ff9eeaaef84bc4d3f3d3cd9d0860589e_1737625001248.png" alt="在这里插入图片描述"></p>
<h2 id="六、更换web容器"><a href="#六、更换web容器" class="headerlink" title="六、更换web容器"></a>六、更换web容器</h2><p>pringboot 容器默认使用的是tomcat作为外部容器， 可以更换为jetty。<br>具体操作如下:</p>
<h3 id="1-排除tomcat，加入jetty的依赖"><a href="#1-排除tomcat，加入jetty的依赖" class="headerlink" title="1.排除tomcat，加入jetty的依赖"></a>1.排除tomcat，加入jetty的依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--  排除tomcat--&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-测试"><a href="#2-测试" class="headerlink" title="2.测试:"></a>2.测试:</h3><p>运行入口函数:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo11Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo11Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果,看打印结果，已显示为jetty:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d56b41f9b5a8f91b3acf5c02005fe86f_1737625001248.png" alt="在这里插入图片描述"></p>
<p>源码地址:<br><a target="_blank" rel="noopener" href="https://github.com/hufanglei/springboot-v-study/tree/springboot-web1">https://github.com/hufanglei/springboot-v-study/tree/springboot-web1</a></p>
<hr>
<h1 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h1><h2 id="一、请求静态资源"><a href="#一、请求静态资源" class="headerlink" title="一、请求静态资源:"></a>一、请求静态资源:</h2><h3 id="1-放在webapp下-加resources-xml-可以访问到"><a href="#1-放在webapp下-加resources-xml-可以访问到" class="headerlink" title="1. 放在webapp下 加resources.xml 可以访问到"></a>1. 放在webapp下 加resources.xml 可以访问到</h3><p>做个案例，测试下：</p>
<ul>
<li>在webapp下准备一个图片和一个user.html<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/70c5e167ba1ef7257cb5733c5ad766e9_1737625001249.png" alt="在这里插入图片描述"></li>
<li>pom上加入资源</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!--注意此次必须要放在此目录下才能被访问到 --&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">targetPath</span>&gt;</span>META-INF/resources<span class="tag">&lt;/<span class="name">targetPath</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/**<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>入口函数启动：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>查看效果,显示图片和页面都可以访问到：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c864e8037b476f1ab827dd3d25585156_1737625001249.png" alt="在这里插入图片描述"></li>
</ul>
<h3 id="2-springboot默认的静态资源的路径是"><a href="#2-springboot默认的静态资源的路径是" class="headerlink" title="2. springboot默认的静态资源的路径是:"></a>2. springboot默认的静态资源的路径是:</h3><ul>
<li>“classpath:&#x2F;META-INF&#x2F;resources&#x2F;“,</li>
<li>“classpath:&#x2F;resources&#x2F;“,</li>
<li>“classpath:&#x2F;static&#x2F;“,</li>
<li>“classpath:&#x2F;public&#x2F;“ };</li>
</ul>
<p>我们可以在ResourceProperties源码中找到这个原因:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d50a623cffadf9dd0b5611a094362b9c_1737625014541.png" alt="在这里插入图片描述"><br>在public下准备个文件看下能否访问到:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6b3fc5c890310eec7169cc3e25617977_1737625014541.png" alt="在这里插入图片描述"><br>运行入口函数：看下页面,显示已经访问到public下的html页面和css。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/20a86d6caab1b6a8d952d4d8e5078b89_1737625014541.png" alt="在这里插入图片描述"></p>
<h3 id="3-可以通过spring-resources-static-locations-配置项修改默认静态资源路径"><a href="#3-可以通过spring-resources-static-locations-配置项修改默认静态资源路径" class="headerlink" title="3.可以通过spring.resources.static-locations 配置项修改默认静态资源路径"></a>3.可以通过spring.resources.static-locations 配置项修改默认静态资源路径</h3><p>试一试：<br>我们指定html文件下为我们的默认静态资源路径，并准备个login.html,看下能否访问：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d01c57b36f0b25d71290bc275683b454_1737625014541.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1c04c1caa01afc72afb05876ac074606_1737625014541.png" alt="在这里插入图片描述"><br>运行,看下页面效果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9413bdda013ea307c0749f8b88c178ec_1737625025294.png" alt="在这里插入图片描述"><br>结果显示已经访问到html下的页面。修改默认的静态资源路径成功。</p>
<h2 id="二、sevlet，filter，listener的2种配置方式"><a href="#二、sevlet，filter，listener的2种配置方式" class="headerlink" title="二、sevlet，filter，listener的2种配置方式:"></a>二、sevlet，filter，listener的2种配置方式:</h2><h3 id="1-springboot如何使用servlet"><a href="#1-springboot如何使用servlet" class="headerlink" title="1.springboot如何使用servlet"></a>1.springboot如何使用servlet</h3><p>有2种方式，一种是用sevlet3加入口函数注解扫码方式，一种是配置类注入servlet方式:<br>现在动手试试:</p>
<h4 id="①-方法一-servlet3可以使用这种方法"><a href="#①-方法一-servlet3可以使用这种方法" class="headerlink" title="① 方法一:(servlet3可以使用这种方法)"></a>① 方法一:(servlet3可以使用这种方法)</h4><ul>
<li>1）编写servlet，然后加上响应的注解@WebServlet</li>
<li>2）需要启用@ServletComonentScan注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/user.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookServlet</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===servet BookServlet========&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;book servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行入口，访问BookServlet 映射的user.do路径:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1fb6c3608620d4349fa79074fe9e5827_1737625025294.png" alt="在这里插入图片描述"><br>说明servlet已经访问成功。</p>
<h4 id="②-方法2-（servlet2-5及以下版本可以使用这种方法）"><a href="#②-方法2-（servlet2-5及以下版本可以使用这种方法）" class="headerlink" title="② 方法2:（servlet2.5及以下版本可以使用这种方法）"></a>② 方法2:（servlet2.5及以下版本可以使用这种方法）</h4><ul>
<li>1） 书写servlet无需对位映射，不用加@WebServlet注解</li>
<li>2）书写个配置类，使用@Bean注入，注入的话，需要调用ServletRegistrationBean的构造方法。<br>代码如下:<br>servlet:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookServlet</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===servet BookServlet========&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;book servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletConfigration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletRegistrationBean <span class="title function_">createBookServlet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ServletRegistrationBean</span> <span class="variable">servletRegistrationBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>(<span class="keyword">new</span> <span class="title class_">BookServlet</span>(), <span class="string">&quot;/book.do&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>入口函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动并测试:结果显示ok:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/20ac6bff40c0699d0078ef760b7fa805_1737625025294.png" alt="在这里插入图片描述"></p>
<h3 id="2-springboot如何使用过滤器"><a href="#2-springboot如何使用过滤器" class="headerlink" title="2.springboot如何使用过滤器"></a>2.springboot如何使用过滤器</h3><p>使用的方式和servet差不多，一种是@WebFilter(“&#x2F;*”)注解方式，另一种是也是通过配置类:<br>不过生成filter的类是 fileter -》 FilterRegistrationBean。</p>
<h4 id="方式1通过-WebFilter-“-”-入口-ServletComponentScan注解实现过滤器"><a href="#方式1通过-WebFilter-“-”-入口-ServletComponentScan注解实现过滤器" class="headerlink" title="方式1通过@WebFilter(“&#x2F;*”)+入口@ServletComponentScan注解实现过滤器"></a>方式1通过@WebFilter(“&#x2F;*”)+入口@ServletComponentScan注解实现过滤器</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogFilter</span> <span class="keyword">implements</span>  <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==LogFilter =init===&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==LogFilter =filter ===&quot;</span>+ request.getRemoteHost());</span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=====destroy======&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>入口函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动入口函数，访问刚才的servlet，看下控制台打印情况:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/969e9834c5810014330e931be0e72708_1737625025294.png" alt="在这里插入图片描述"><br>显示过滤器已经被注入了。</p>
<h4 id="方式2：配置类-注入bean，"><a href="#方式2：配置类-注入bean，" class="headerlink" title="方式2：配置类+注入bean，"></a>方式2：配置类+注入bean，</h4><p>代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EchoFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        System.out.println(<span class="string">&quot;spring boot web filter &quot;</span>+ req.getRequestURI());</span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>配置类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletConfigration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean <span class="title function_">createFilterRegistrationBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">FilterRegistrationBean</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>();</span><br><span class="line">        filter.setFilter(<span class="keyword">new</span> <span class="title class_">EchoFilter</span>());</span><br><span class="line">        filter.setUrlPatterns(Arrays.asList(<span class="string">&quot;/book.do&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> filter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>入口函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d136ad2470ec0fc58f79db470c309728_1737625025294.png" alt="在这里插入图片描述"></p>
<p>运行结果:显示过滤器已经起作用了了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/90309043cf31a28fbe3cddb6371c5219_1737625034818.png" alt="在这里插入图片描述"></p>
<h3 id="3-springboot如何使用监听器"><a href="#3-springboot如何使用监听器" class="headerlink" title="3.springboot如何使用监听器"></a>3.springboot如何使用监听器</h3><h4 id="1）方式1-WebListener-ServletComponentScan"><a href="#1）方式1-WebListener-ServletComponentScan" class="headerlink" title="1）方式1:@WebListener+@ServletComponentScan"></a>1）方式1:@WebListener+@ServletComponentScan</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;StartUpListener app startup at &quot;</span> + LocalDateTime.now().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/fa7015c4363a167c26774c1350d2a2b2_1737625034818.png" alt="在这里插入图片描述"></p>
<h4 id="2）方式2-配置类-bean-ServletListenerRegistrationBean构造函数注入"><a href="#2）方式2-配置类-bean-ServletListenerRegistrationBean构造函数注入" class="headerlink" title="2）方式2:配置类+@bean+ServletListenerRegistrationBean构造函数注入"></a>2）方式2:配置类+@bean+ServletListenerRegistrationBean构造函数注入</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StartUpListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;StartUpListener app startup at &quot;</span> + LocalDateTime.now().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletConfigration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletListenerRegistrationBean <span class="title function_">createServletListenerRegistrationBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ServletListenerRegistrationBean</span> <span class="variable">listener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletListenerRegistrationBean</span>(<span class="keyword">new</span> <span class="title class_">StartUpListener</span>());</span><br><span class="line">        <span class="keyword">return</span> listener;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo12Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo12Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f27e79dd5bc5425c5caf53d97beef03a_1737625034818.png" alt="在这里插入图片描述"><br>源码地址:<br><a target="_blank" rel="noopener" href="https://github.com/hufanglei/springboot-v-study/tree/demo12">https://github.com/hufanglei/springboot-v-study/tree/demo12</a></p>
<hr>
<h1 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h1><h2 id="1-拦截器："><a href="#1-拦截器：" class="headerlink" title="1.拦截器："></a>1.拦截器：</h2><p> 拦截器的使用步骤</p>
<h3 id="①写一个拦截器，实现HandlerInterceptor接口"><a href="#①写一个拦截器，实现HandlerInterceptor接口" class="headerlink" title="①写一个拦截器，实现HandlerInterceptor接口"></a>①写一个拦截器，实现HandlerInterceptor接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=========preHandle===============&quot;</span> + handler);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=========postHandle===============&quot;</span> + handler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=========afterCompletion===============&quot;</span> + handler);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>preHandle： controller执行之前调用</li>
<li>postHandle： controller执行之后，且页面渲染之前调用</li>
<li>afterCompletion： 页面渲染之后调用，一般用于资源清理操作</li>
</ul>
</blockquote>
<h3 id="②写一个类，实现WebMvcConfigurer接口，重写addInterceptors方法（已经过时）-并调用registry-addInterceptor把上一步的拦截器加进去"><a href="#②写一个类，实现WebMvcConfigurer接口，重写addInterceptors方法（已经过时）-并调用registry-addInterceptor把上一步的拦截器加进去" class="headerlink" title="②写一个类，实现WebMvcConfigurer接口，重写addInterceptors方法（已经过时）,并调用registry.addInterceptor把上一步的拦截器加进去"></a>②写一个类，实现WebMvcConfigurer接口，重写addInterceptors方法（已经过时）,并调用registry.addInterceptor把上一步的拦截器加进去</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfiguration</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    public void addResourceHandlers(ResourceHandlerRegistry registry) &#123;</span></span><br><span class="line"><span class="comment">//        registry.addResourceHandler(&quot;/web/**&quot;).addResourceLocations(&quot;classpath:/web/&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LogHandlerInterceptor</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>写个controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/home&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">home</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user home&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/help&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">help</span><span class="params">()</span>  &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;args is empty&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo13Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo13Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>页面测试:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/20baeaa364aa96d27578fd8a2b55c459_1737625034818.png" alt="在这里插入图片描述"><br>看下控制台:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e3766a606b7e36400ff9e7a2a29a9171_1737625034818.png" alt="在这里插入图片描述"><br>显示已经拦截controller。</p>
<h2 id="2-异常处理"><a href="#2-异常处理" class="headerlink" title="2.异常处理:"></a>2.异常处理:</h2><h3 id="1）默认异常处理逻辑ErrorMvcAutoConfiguration"><a href="#1）默认异常处理逻辑ErrorMvcAutoConfiguration" class="headerlink" title="1）默认异常处理逻辑ErrorMvcAutoConfiguration"></a>1）默认异常处理逻辑ErrorMvcAutoConfiguration</h3><p>当我们访问一个不存在的url时候会出现如下页面:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e87fbca80170a730da7ab6276e8e43c4_1737625046557.png" alt="在这里插入图片描述"><br>看下ErrorMvcAutoConfiguration源码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a971cb3ba26d9c62cbc799f1f4a1f324_1737625046557.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/50f75d005eaed908bc870b74e2a85816_1737625046557.png" alt="在这里插入图片描述"></p>
<h4 id="排除springboot默认显示的异常页方式1："><a href="#排除springboot默认显示的异常页方式1：" class="headerlink" title="排除springboot默认显示的异常页方式1："></a>排除springboot默认显示的异常页方式1：</h4><p>可以看到找到就是渲染的这段代码。<br>我们可以关闭这个默认异常页配置:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2e4449e4a61841abd467f5c2f9205220_1737625046557.png" alt="在这里插入图片描述"><br>看了源码再去修改applicaiton.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.error.whitelabel.enabled=<span class="literal">false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重新运行:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/41b2ed725131b4a909bd9716bae8a6f5_1737625046557.png" alt="在这里插入图片描述"><br>输入一个无效的url，就没有默认的异常处理页了。</p>
<h4 id="排除springboot默认显示的异常页方式2："><a href="#排除springboot默认显示的异常页方式2：" class="headerlink" title="排除springboot默认显示的异常页方式2："></a>排除springboot默认显示的异常页方式2：</h4><p>也可以直接在入口函数上，用exclude去排除自动注册的这个默认异常注册类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication(exclude = ErrorMvcAutoConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo13Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo13Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-自处理异常"><a href="#2-自处理异常" class="headerlink" title="2).自处理异常"></a>2).自处理异常</h3><p>定义一个controller。手动抛出异常:</p>
<h4 id="①在当前controller类使用-ExceptionHandler处理异常"><a href="#①在当前controller类使用-ExceptionHandler处理异常" class="headerlink" title="①在当前controller类使用@ExceptionHandler处理异常"></a>①在当前controller类使用@ExceptionHandler处理异常</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @ExceptionHandler(value = FileNotFoundException.class)</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = FileNotFoundException.class)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">error</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;file not found exception====  &quot;</span> + e.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/book/error1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FileNotFoundException</span>(<span class="string">&quot;file not found&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/book/error2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">error2</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundException</span>(<span class="string">&quot;file not found&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/null&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;args is empty&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们看到访问list，error2，empty的方法都会抛出异常，同时定义一个处理异常的方法error：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(value = FileNotFoundException.class)</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">error</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;file not found exception====  &quot;</span> + e.getMessage();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>如果匹配到 @ExceptionHandler中value对应的异常，就可以在error方法中处理异常，或者跳转到错误页面。<br>我们访问&#x2F;user&#x2F;null：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/558c3b936d5bcac3455da8bce1b43b76_1737625060975.png" alt="在这里插入图片描述"><br>因为<br><code>  @GetMapping(&quot;/user/null&quot;)     public String empty() &#123;         throw new NullPointerException(&quot;args is empty&quot;);     &#125; &#125;</code><br>对应的是空指针异常，而<code> @ExceptionHandler(value = FileNotFoundException.class)</code>是文件找不到的异常，所以controller没给我们处理。</p>
<p>然后访问@GetMapping(“&#x2F;book&#x2F;error1”)<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3d6afe547f56293806fb536af0483160_1737625060975.png" alt="在这里插入图片描述"><br>看到已经帮我们处理了。<br>如果想要@ExceptionHandler当前类全部的方法，就可以扩大异常范围,改成exception.class就可了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(value = Exception.class)</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">error</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot; exception====  &quot;</span> + e.getMessage();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="②全局处理异常的2种方式："><a href="#②全局处理异常的2种方式：" class="headerlink" title="②全局处理异常的2种方式："></a>②全局处理异常的2种方式：</h4><ul>
<li>a.方式1：使用ErrorPageRegistrar的接口<blockquote>
<p>写一个类，实现ErrorPageRegistrar接口，实现registerErrorPages，在该方法里面，添加具体的错误处理逻辑</p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonErrorRegistry</span> <span class="keyword">implements</span> <span class="title class_">ErrorPageRegistrar</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerErrorPages</span><span class="params">(ErrorPageRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">ErrorPage</span> <span class="variable">e404</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorPage</span>(HttpStatus.NOT_FOUND, <span class="string">&quot;/404.html&quot;</span>);</span><br><span class="line">        <span class="type">ErrorPage</span> <span class="variable">e500</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorPage</span>(INTERNAL_SERVER_ERROR, <span class="string">&quot;/500.html&quot;</span>);</span><br><span class="line">        ErrorPage argsPage= <span class="keyword">new</span> <span class="title class_">ErrorPage</span>(IllegalArgumentException.class, <span class="string">&quot;/args.html&quot;</span>);</span><br><span class="line">        registry.addErrorPages(e404, e500,argsPage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>b.方式2：@ControllerAdvice<br>具体做法:<blockquote>
<p>-1.写一个类，需要加上@ControllerAdvice注解<br>-2.写一个异常处理方法，需要加上@Exception（value&#x3D;Exception.class）这个注解，在该方法上处理异常，</p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GloabalExceptinHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = Exception.class)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">errorHandler</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;gloabal error  &quot;</span> + e.getClass().getName()+ <span class="string">&quot; ==&quot;</span>+ e.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = NullPointerException.class)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">errorHandler2</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;gloabal error2  &quot;</span> + e.getClass().getName()+ <span class="string">&quot; ==&quot;</span>+ e.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>这2种方法都可以跳转到自定义的页面，或者抛出异常。<br>看下这个ErrorPage类的源码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3ed1b6e9f76ef1d6c7250598ca8fadb0_1737625060975.png" alt="在这里插入图片描述"><br>可以看到，errorpage可以通过请求响应状态码控制跳转页面，可以根据具体异常控制跳转页。</p>
<p>演示代码git地址:<br><a target="_blank" rel="noopener" href="https://github.com/hufanglei/springboot-v-study/tree/springbootweb3">https://github.com/hufanglei/springboot-v-study/tree/springbootweb3</a></p>
<hr>
<p>以上就说了springbootweb的大体内容，基础springboot2的。关于请求方法参数，数据渲染到jsp页面和freemarker页面的配置方式，替换内置tomcat的方法，请求静态页面的设置，过滤器，监听器，servlet的2种注册方式，拦截器的自定义，异常处理的类上的处理，和全局处理的2种方式。</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/22/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(13)--%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/22/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(13)--%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">springboot原理实战(13)--运行流程分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-22 15:07:35" itemprop="dateCreated datePublished" datetime="2020-03-22T15:07:35+08:00">2020-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程:"></a>运行流程:</h1><ul>
<li>1.判断是否是web环境</li>
<li>2.加载所有classpath下面的META-IINF&#x2F;spring.factories –ApplicaionContextInitializer</li>
<li>3.加载所有classpath下面的META-INF&#x2F;spring.factories-ApplicationListener</li>
<li>4.推断main方法所在的类</li>
<li>5.开始执行run方法</li>
<li>6.设置java.awt.headless系统变量</li>
<li>7.加载所有classpath下面的META-INF&#x2F;spring.factories SpringApplicationRunListenr</li>
<li>8.执行所有ApplicationRunListener的started方法</li>
<li>9.实例化ApplicaitonArgumetns对象</li>
<li>10.创建environment</li>
<li>11.配置environment，主要是吧run方法的参数配置到environment</li>
<li>12.执行所有springApplicaitonRunListener的environmentPrepared方法</li>
<li>13.如果不是web环境，但是web的environment，则吧这个web的environment转换成标准的environment</li>
<li>14.打印Banner</li>
<li>15.初始化applicationContext，如果是web环境，则实例化AnnotionCongfigEmbeddedWebApplication对象，否则实例化AnnocationConfigApplication</li>
<li>16.如果beanNameGenerator不为空，就把beanNameGenerator对象注入到context里面去</li>
<li>17.回调所有的ApplicationContextInitialer方法</li>
<li>18.执行所有springApplicationRunListener的contextPrepare方法</li>
<li>19.依次往spring容器中注入：ApplicationArguments， Banner</li>
<li>20.加载所有的源到context里面去</li>
<li>21.执行所有SpringApplicationRunListener的contextLoaded方法</li>
<li>22.执行context的refresh方法，并且调用context的registerShutdownHook方法</li>
<li>23.回调，获取容器中所有的ApplicationRunner，CommandLineRunner接口，然后排序，依次调用</li>
<li>24：执行所有springApplicatonRunListener的finished方法</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/18/Springboot2.X%20%E4%BD%BF%E7%94%A8%20Jsp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/18/Springboot2.X%20%E4%BD%BF%E7%94%A8%20Jsp/" class="post-title-link" itemprop="url">Springboot2.X 使用 Jsp</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-18 10:55:04" itemprop="dateCreated datePublished" datetime="2020-03-18T10:55:04+08:00">2020-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>74</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]<br><a target="_blank" rel="noopener" href="https://my.oschina.net/mdxlcj/blog/1852916">https://my.oschina.net/mdxlcj/blog/1852916</a></p>
<hr>
<p>经验证可以，以前不行是卡在resources没配置。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/17/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(12)--%E6%89%AB%E6%8F%8F%E5%8C%85,banner,%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%843%E7%A7%8D%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/17/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(12)--%E6%89%AB%E6%8F%8F%E5%8C%85,banner,%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%843%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">springboot原理实战(12)--扫描包,banner,配置属性默认值的3种方式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-17 15:33:20" itemprop="dateCreated datePublished" datetime="2020-03-17T15:33:20+08:00">2020-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录概要："><a href="#目录概要：" class="headerlink" title="目录概要："></a>目录概要：</h1><p>本文是springoot的扩展分析补充，主要了解一些springboot扫码包，排除包，banner设置，和配置默认属性这3方面的知识。<br>脑图:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/cbfd51fef3d50436e7bc9b42ad91b46d_1737625060975.png" alt="在这里插入图片描述"></p>
<h1 id="一、SpringBootApplication扫描包"><a href="#一、SpringBootApplication扫描包" class="headerlink" title="一、SpringBootApplication扫描包:"></a>一、SpringBootApplication扫描包:</h1><p>有几个属性:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0f77a83c29a7cc1d68d17f2c67aaee50_1737625070583.png" alt="在这里插入图片描述"></p>
<ul>
<li>exclude根据类排除扫描的类</li>
<li>excludeName根据类名排除扫描的类</li>
<li>scanBasePackages：指定扫描的基本包的位置，可以指定多个包名进行扫描，默认是扫描入口类所在包和子包下面。</li>
<li>scanBasePackageClasses:可以指定多个类或接口的class,扫描时会 在这些指定的类和接口所属的包进行扫面。<br>排除的以前提到过，下面看下<code>scanBasePackages</code>：</li>
</ul>
<h2 id="①添加扫描包"><a href="#①添加扫描包" class="headerlink" title="①添加扫描包"></a>①添加扫描包</h2><p>例子：<br>入口类在demo1下<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4d3f88649ce26a8f21519339d15a9347_1737625070583.png" alt="在这里插入图片描述"><br>User和demo1平级，不在DemoApplication的当前包和子包：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们看下能否获取User对象:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(DemoApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果显示报错:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/58ee04be402c19813a1f05212f0264c5_1737625070583.png" alt="在这里插入图片描述"></p>
<p>现在用scanBasePackages添加扫描包的位置:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication(scanBasePackages=&quot;com.example&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(DemoApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f311bb278cca10e7cfec00e70040db28_1737625070583.png" alt="在这里插入图片描述"><br>已经显示注入spring了。</p>
<h2 id="②排除指定的类，配置类"><a href="#②排除指定的类，配置类" class="headerlink" title="②排除指定的类，配置类"></a>②排除指定的类，配置类</h2><ul>
<li>exclude 根据class来排除 GsonAutoConfiguration.class</li>
<li>excludeName 根据类名类排除 org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration</li>
</ul>
<p>我们知道GsonAutoConfiguration已经帮我们注入Gson了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(DemoApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(Gson.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/04ef994fdd6e6ce0934e6f23f9686688_1737625070583.png" alt="在这里插入图片描述"><br>现在我们去排除它,通过exclude 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication(exclude =  GsonAutoConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(DemoApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(Gson.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>显示已经排除:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3f3f27e7312b7bc0881c5febe7917db1_1737625079695.png" alt="在这里插入图片描述"></p>
<h1 id="二、启动banner相关"><a href="#二、启动banner相关" class="headerlink" title="二、启动banner相关"></a>二、启动banner相关</h1><p>刚才的项目可以看到启动banner:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/5fb9ad413d2fc55f15bec0539b9f7c52_1737625079695.png" alt="在这里插入图片描述"><br>这个banner，其实有个对应的Banner接口<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/65afbba574bc4f43877fca88f0c2caf1_1737625079696.png" alt="在这里插入图片描述"><br>可以控制禁用off，打印console默认的，log 将banner写入日志文件中。<br>想用使用的话。2种方式：</p>
<ul>
<li>代码种禁用或打入日志或者控制台输出<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d3506b012094749995d7f8f8b362446b_1737625079696.png" alt="在这里插入图片描述"></li>
<li>可以自定义banner，在resoures目录下，建个txt或者图片，支持jpg png  gif，然后根据下面的配置项配置即可。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/5c101a456bf5beed6813ce2eccb5b9bb_1737625079696.png" alt="在这里插入图片描述"></li>
</ul>
<h1 id="三、给springboot-设置默认值的3种方式"><a href="#三、给springboot-设置默认值的3种方式" class="headerlink" title="三、给springboot 设置默认值的3种方式"></a>三、给springboot 设置默认值的3种方式</h1><ul>
<li>第一种方式:冒号凡是</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//给默认值1</span></span><br><span class="line">  <span class="meta">@Value(&quot;$&#123;server.host:192.168.157.112&#125;&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String  serverHost;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>第二种方式getProperty</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> public <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">       <span class="title class_">SpringApplication</span> app = <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(<span class="title class_">DemoApplication</span>.<span class="property">class</span>);</span><br><span class="line">       <span class="title class_">ConfigurableApplicationContext</span> context = app.<span class="title function_">run</span>(args);</span><br><span class="line">       <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(context.<span class="title function_">getEnvironment</span>().<span class="title function_">getProperty</span>(<span class="string">&quot;server.host&quot;</span>,<span class="string">&quot;aaa&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第三种方式;app.setDefaultProperties</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.host&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String  serverHost;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(DemoApplication.class);</span><br><span class="line">        Map&lt;String, Object&gt; defaultProperties = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        defaultProperties.put(<span class="string">&quot;server.host&quot;</span>, <span class="string">&quot;192.168.157&quot;</span>);</span><br><span class="line">        app.setDefaultProperties(defaultProperties);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(DemoApplication.class).serverHost);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c3ef3bce1ad4867f0b68387a0be33549_1737625089897.png" alt="在这里插入图片描述"></p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/17/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(11)%20--%20springboot%E6%89%A9%E5%B1%95%E5%88%86%E6%9E%90CommandLineRunner/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/17/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(11)%20--%20springboot%E6%89%A9%E5%B1%95%E5%88%86%E6%9E%90CommandLineRunner/" class="post-title-link" itemprop="url">springboot原理实战(11) -- springboot扩展分析CommandLineRunner</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-17 14:42:44" itemprop="dateCreated datePublished" datetime="2020-03-17T14:42:44+08:00">2020-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>本文章主要了解在spring容器执行refreshed之前的一个回调接口：ApplicationContextInitializer，<br>在容器启动成功后的最后一步回调（类似开机自启动)的接口:CommandLineRunner和ApplicationRunner。<br>脑图如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e9b82a9df8cb100adf39145d2ac051de_1737625089897.png" alt="在这里插入图片描述"></p>
<h1 id="一、ApplicationContextInitializer"><a href="#一、ApplicationContextInitializer" class="headerlink" title="一、ApplicationContextInitializer"></a>一、ApplicationContextInitializer</h1><p>该接口是接口是在spring容器执行refreshed之前的一个回调。</p>
<h2 id="①使用步骤"><a href="#①使用步骤" class="headerlink" title="①使用步骤:"></a>①使用步骤:</h2><ul>
<li>1： 写一个类： 实现AApplicationContextInitializer接口</li>
<li>2： 注册ApplicationContextInitializer</li>
</ul>
<h2 id="②注册方法3种"><a href="#②注册方法3种" class="headerlink" title="②注册方法3种:"></a>②注册方法3种:</h2><ul>
<li>1.app.addInitializers</li>
<li>2:通过配置项context.initializer.classes指定</li>
<li>3.可以通过spring.factories机制(注册listener监听器也可以使用这种方式)</li>
</ul>
<h3 id="演示-1-app-addInitializers方式"><a href="#演示-1-app-addInitializers方式" class="headerlink" title="演示  1.app.addInitializers方式"></a>演示  1.app.addInitializers方式</h3><p>写个实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAppliationContextInitializer</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextInitializer</span>&lt;ConfigurableApplicationContext&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(ConfigurableApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;bean count: &quot;</span> + applicationContext.getBeanDefinitionCount());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 在入口中注册和调用:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo8Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo8Application.class);</span><br><span class="line">        app.addInitializers(<span class="keyword">new</span> <span class="title class_">MyAppliationContextInitializer</span>());</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/feb9b9bc3ec30b03f6c32aa100b630b1_1737625089897.png" alt="在这里插入图片描述">:<br>测试已经注入！</p>
<h3 id="演示-2-通过配置项context-initializer-classes指定"><a href="#演示-2-通过配置项context-initializer-classes指定" class="headerlink" title="演示 2:通过配置项context.initializer.classes指定"></a>演示 2:通过配置项context.initializer.classes指定</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAppliationContextInitializer</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextInitializer</span>&lt;ConfigurableApplicationContext&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(ConfigurableApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;bean count: &quot;</span> + applicationContext.getBeanDefinitionCount());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAppliationContextInitializer2</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextInitializer</span>&lt;ConfigurableApplicationContext&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(ConfigurableApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        System.out.println(applicationContext.getDisplayName());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>application.properties,写了2个实现类:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.initializer.classes=com.springboot.demo8.MyAppliationContextInitializer,com.springboot.demo8.MyAppliationContextInitializer2</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/14f44983c4cf24c9b758327b056100af_1737625089897.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo8Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo8Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果ok:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d0c1dae95bdd99f10d443ef169720764_1737625099115.png" alt="在这里插入图片描述"></p>
<h3 id="3-spring-factories机制-注册listener监听器也可以使用这种方式"><a href="#3-spring-factories机制-注册listener监听器也可以使用这种方式" class="headerlink" title="3.spring.factories机制(注册listener监听器也可以使用这种方式)"></a>3.spring.factories机制(注册listener监听器也可以使用这种方式)</h3><p>新建一个项目intializer:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/33be21c7fd3577dfdab3567bc0a9748a_1737625099115.png" alt="在这里插入图片描述"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.springboot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>intializer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>intializer<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EchoAppliationContextInitializer</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextInitializer</span>&lt;ConfigurableApplicationContext&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(ConfigurableApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=========EchoAppliationContextInitializer==========&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>intializer\src\main\resources\META-INF\spring.factories：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.context.ApplicationContextInitializer=com.springboot.intializer.EchoAppliationContextInitializer</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>将该项目引入原来的项目:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.springboot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;intializer&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">0.0</span><span class="number">.1</span>-SNAPSHOT&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo8Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo8Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/40853897692467f3022c389d43cba6ad_1737625099115.png" alt="在这里插入图片描述"><br>结果显示已经注入！！</p>
<h1 id="二、CommandLineRunner"><a href="#二、CommandLineRunner" class="headerlink" title="二、CommandLineRunner"></a>二、CommandLineRunner</h1><p>该接口是在容器启动成功后的最后一步回调（类似开机自启动），可以在应用启动时打印一些东西之类的。</p>
<h2 id="①使用步骤-1"><a href="#①使用步骤-1" class="headerlink" title="①使用步骤:"></a>①使用步骤:</h2><ul>
<li>1.写一个类，实现CommandLineRunner 接口</li>
<li>2 把该类纳入到spring的容器管理中<br><code>  注意：可以通过@Order注解或者Ordered接口来控制执行顺序。order值小的优先</code><br>演示一下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Order(1)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerSuccessReport</span> <span class="keyword">implements</span> <span class="title class_">CommandLineRunner</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=====应用已经成功的启动============&quot;</span> + Arrays.asList(args));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Order(2)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerStartedReport</span> <span class="keyword">implements</span> <span class="title class_">CommandLineRunner</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=====应用启动后的时间是:============&quot;</span>+ LocalDateTime.now().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上2个类都实现了CommandLineRunner 接口，并用@Compoent,并通过order控制优先级，值小的优先执行，注入spring:</p>
<p>测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo8Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo8Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/26cd26be3afe8d918572385ed6e158e4_1737625099115.png" alt="在这里插入图片描述"></p>
<h1 id="三、ApplicationRunner"><a href="#三、ApplicationRunner" class="headerlink" title="三、ApplicationRunner"></a>三、ApplicationRunner</h1><blockquote>
<p>CommandLineRunner,ApplicationRunner 区别<br>区别在于方法的参数不一样<br>CommandLineRunner的参数是最原始的参数，没有做任务处理<br>ApplicationRunner的参数是ApplicationArguments，是对原始参数做了进一步的封装</p>
</blockquote>
<p>举例说明:</p>
<p>看下CommandLineRunner的获取参数代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerSuccessReport</span> <span class="keyword">implements</span> <span class="title class_">CommandLineRunner</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=====应用已经成功的启动============&quot;</span> + Arrays.asList(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看戏ApplicationRunner的获取参数代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StartedApplicationRunner</span> <span class="keyword">implements</span> <span class="title class_">ApplicationRunner</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;应用已经启动，参数为:&quot;</span> + Arrays.asList(args.getSourceArgs()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/43c954781dae18a9286985dd7343a101_1737625099115.png" alt="在这里插入图片描述"><br>都获取了程序的参数，这里我们看不出来区别，继续改造：</p>
<ul>
<li>先设置启动参数:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/97b43c69569e71f9162a442c6d064f1d_1737625108225.png" alt="在这里插入图片描述"><br>ApplicationRunner 获取的是一个ApplicationArguments对象，我们来通过参数对象打印看下:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo8Application.class);</span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">    <span class="type">ApplicationArguments</span> <span class="variable">arg</span> <span class="operator">=</span> context.getBean(ApplicationArguments.class);</span><br><span class="line">    System.out.println(arg.getSourceArgs().length);</span><br><span class="line">    System.out.println(arg.getOptionNames());</span><br><span class="line">    System.out.println(arg.getOptionValues(<span class="string">&quot;myname&quot;</span>));</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8df246a4544a9c08ce4fd167ace0a6ba_1737625108225.png" alt="在这里插入图片描述"><br>可以看到通过ApplicationArguments可以使用其提供的getOptionNames，getOptionValues方法很方便的获取参数值，而CommandLineRunner 只能获取到<code>--myname=admin</code>这样的字符串，我们获取key或者value需要使用split切割很麻烦，而且ApplicationArguments还有好多实用的方法:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/41789c9e7926ca78da3015f65ab8ce5a_1737625108225.png" alt="在这里插入图片描述"><br>这就是CommandLineRunner,ApplicationRunner 区别 : 方法的参数类型不一样.</p>
<p>本文讲了主要是springboot容器2个常用接口:在spring容器执行refreshed之前的一个回调接口：ApplicationContextInitializer，<br>在容器启动成功后的最后一步回调（类似开机自启动)的接口:CommandLineRunner和ApplicationRunner,和这2个接口的区别.</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/16/springboot%E5%AE%9E%E6%88%98%E5%8E%9F%E7%90%86(10)--%E9%85%8D%E7%BD%AE%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%92%8C%E5%8E%9F%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/16/springboot%E5%AE%9E%E6%88%98%E5%8E%9F%E7%90%86(10)--%E9%85%8D%E7%BD%AE%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%92%8C%E5%8E%9F%E7%90%86/" class="post-title-link" itemprop="url">springboot实战原理(10)--配置事件监听的4种方式和原理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-16 11:40:32" itemprop="dateCreated datePublished" datetime="2020-03-16T11:40:32+08:00">2020-03-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录:"></a>目录:</h1><p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/61b0b21c0365af2132fa9cf004f8c3a1_1737625108225.png" alt="在这里插入图片描述"><br>源码地址:<br><a target="_blank" rel="noopener" href="https://github.com/hufanglei/springboot-v-study/tree/demo7">https://github.com/hufanglei/springboot-v-study/tree/demo7</a></p>
<h1 id="一、配置监听器的步骤"><a href="#一、配置监听器的步骤" class="headerlink" title="一、配置监听器的步骤:"></a>一、配置监听器的步骤:</h1><ul>
<li>1.自定义事件，一般是继承ApplicationEvent抽象类</li>
<li>2定义事件监听器，一般是实现ApplicationListener的接口</li>
<li>3.启动时候，需要把监听器加入到spring容器中</li>
<li>4.发布事件，使用ApplicationEventPublisher.publishEvent 发布事件</li>
</ul>
<h1 id="二、配置监听器：4种方式"><a href="#二、配置监听器：4种方式" class="headerlink" title="二、配置监听器：4种方式:"></a>二、配置监听器：4种方式:</h1><h2 id="①SpringApplication-addListeners增加"><a href="#①SpringApplication-addListeners增加" class="headerlink" title="①SpringApplication..addListeners增加"></a>①SpringApplication..addListeners增加</h2><p>例子:<br>&#x2F;&#x2F;定义事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义事件</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAplicationEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyAplicationEvent</span><span class="params">(Object source)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;监听器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyApplicationListener</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span>&lt;MyAplicationEvent&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(MyAplicationEvent event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接受到事件============&quot;</span>+ event.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;在启动入口中：通过addListeners增加添加到spring容器和发布事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="comment">//addListeners增加</span></span><br><span class="line">        app.addListeners(<span class="keyword">new</span> <span class="title class_">MyApplicationListener</span>());</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        <span class="comment">//发布事件</span></span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyAplicationEvent</span>(<span class="keyword">new</span> <span class="title class_">Object</span>()));</span><br><span class="line">        context.close();</span><br><span class="line"><span class="comment">//        context.stop();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/efa664c364cb09fe78d37ead8389a54f_1737625118807.png" alt="在这里插入图片描述"><br>显示监听器已经注入。</p>
<h2 id="②-使用-Component-把监听器纳入到spring容器中管理"><a href="#②-使用-Component-把监听器纳入到spring容器中管理" class="headerlink" title="② 使用@Component 把监听器纳入到spring容器中管理"></a>② 使用@Component 把监听器纳入到spring容器中管理</h2><p>修改刚才的代码：我们在监听器上加上@Component </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//监听器</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyApplicationListener</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span>&lt;MyAplicationEvent&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(MyAplicationEvent event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接受到事件============&quot;</span>+ event.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>入口函数删除 addListener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyAplicationEvent</span>(<span class="keyword">new</span> <span class="title class_">Object</span>()));</span><br><span class="line">        context.close();</span><br><span class="line"><span class="comment">//        context.stop();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重新运行代码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c454f6680e97cb06fadbe9f84efa520e_1737625118807.png" alt="在这里插入图片描述"><br>也说明，监听器生效了。</p>
<h2 id="③-application-properties中配置context-listener-classes属性"><a href="#③-application-properties中配置context-listener-classes属性" class="headerlink" title="③ application.properties中配置context.listener.classes属性"></a>③ application.properties中配置context.listener.classes属性</h2><p>配置如下:  <code>context.listener.classes=com.springboot.demo7.MyApplicationListener</code><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/b1678d9df2dbacdae362fcb2c292a32a_1737625118807.png" alt="在这里插入图片描述"><br>入口函数不变，继续运行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyAplicationEvent</span>(<span class="keyword">new</span> <span class="title class_">Object</span>()));</span><br><span class="line">        context.close();</span><br><span class="line"><span class="comment">//        context.stop();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样，监听器生效：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/321013e1baa8774bc0a6bb4b49fb6fe0_1737625118807.png" alt="在这里插入图片描述"></p>
<h2 id="④使用注解-EventListener"><a href="#④使用注解-EventListener" class="headerlink" title="④使用注解 @EventListener"></a>④使用注解 @EventListener</h2><p>我们定义一个MyEventHandle监听器处理类， 使用注解 @EventListener，在方法上面加入@EventListener注解，且该类需要纳入到spring容器中管理。<br>看代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEventHandle</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 任意参数</span></span><br><span class="line"><span class="comment">     * 所有，该参数事件，或者其子事件都可以接收到</span></span><br><span class="line"><span class="comment">     * @param event  任意参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(MyAplicationEvent event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接受到事件============&quot;</span>+ event.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyAplicationEvent</span>(<span class="keyword">new</span> <span class="title class_">Object</span>()));</span><br><span class="line">        context.close();</span><br><span class="line"><span class="comment">//        context.stop();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/21c68819397e0e41dc6d4c31051c9f5c_1737625118807.png" alt="在这里插入图片描述"><br>依然注入进来了。<br>这里可以修改<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/94d5a30a9a4dd8f5c7d49de904f07b5a_1737625127367.png" alt="在这里插入图片描述"><br>如果改成Object，就表示任意参数，所有，该参数事件，或者其子事件都可以接收到。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEventHandle</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 任意参数</span></span><br><span class="line"><span class="comment">     * 所有，该参数事件，或者其子事件都可以接收到</span></span><br><span class="line"><span class="comment">     * @param event  任意参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(Object event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接受到事件============&quot;</span>+ event.getClass());</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyAplicationEvent</span>(<span class="keyword">new</span> <span class="title class_">Object</span>()));</span><br><span class="line">        context.close();</span><br><span class="line"><span class="comment">//        context.stop();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/74329d2694b97a9163b9586f187b02b8_1737625127367.png" alt="在这里插入图片描述"><br>可以看到，不过有我们自定义的事件，spring默认注入的事件都打印出来了。</p>
<h1 id="三、原理"><a href="#三、原理" class="headerlink" title="三、原理"></a>三、原理</h1><p>第一二种方式都是启动时候，把监听器加入到spring容器中，ConfigurableApplicationContext拿到这个对象再发布就可使用监听器了。<br>第三四中最终也是吧监听器ConfigurableApplicationContext，只不过实现有了2个特别的类：</p>
<h2 id="①context-listener-classes配置原理之DelegatingApplicationListener"><a href="#①context-listener-classes配置原理之DelegatingApplicationListener" class="headerlink" title="①context.listener.classes配置原理之DelegatingApplicationListener:"></a>①context.listener.classes配置原理之DelegatingApplicationListener:</h2><p>看下源码</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a94ea75bdd3dbeef15b399320272fd30_1737625127367.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/24e1bcf362dd811d5e87d99fff21e0d5_1737625127367.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/078ed5d4bcd4d59040f85289fbb190a1_1737625127367.png" alt="在这里插入图片描述"><br>我们可以看到，这个类是读取了配置的属性context.listener.classes，加入到监听器列表并序好给我们的spring容器。</p>
<h2 id="②-注解-EventListener配置原理之-EventListenerMethodProcessor"><a href="#②-注解-EventListener配置原理之-EventListenerMethodProcessor" class="headerlink" title="② 注解@EventListener配置原理之 EventListenerMethodProcessor"></a>② 注解@EventListener配置原理之 EventListenerMethodProcessor</h2><p>看名字就知道EventListenerMethodProcessor这个是个后置处理器：<br>  看下源码:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7040e378650133acfe911133392716ee_1737625138741.png" alt="在这里插入图片描述"><br>afterSingletonsInstantiated方法调用了processBean方法:<br>processBean方法获取所有的@EventListener的注解:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/981e946403468d5e992258c759ba6b11_1737625138741.png" alt="在这里插入图片描述"><br>该方法有这些注解的类加入到了context中,Springboot就可以使用了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/979d9688cc27f117b5488fcf58f41060_1737625138741.png" alt="在这里插入图片描述"></p>
<h1 id="四、spring和springboot默认自定义的事件查看"><a href="#四、spring和springboot默认自定义的事件查看" class="headerlink" title="四、spring和springboot默认自定义的事件查看"></a>四、spring和springboot默认自定义的事件查看</h1><p>他们都在context包下：<br>看下springboot下的很多默认的事件和监听器<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8fe1d5f986c7e012edc41b1ae09a33be_1737625138741.png" alt="在这里插入图片描述"><br>看下spring5下的很多默认的事件和监听器:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/495029149a1ee50a8f53a997b8161125_1737625138741.png" alt="在这里插入图片描述"></p>
<h1 id="五、测试下默认的监听器："><a href="#五、测试下默认的监听器：" class="headerlink" title="五、测试下默认的监听器："></a>五、测试下默认的监听器：</h1><p>我们测试下spring提供的:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/28dbb9e21f54f2cd12a0f0db6a2e53cb_1737625149736.png" alt="在这里插入图片描述"><br>我们使用第4种方式测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEventHandle</span> &#123;</span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">event2</span><span class="params">(ContextStoppedEvent event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;应用停止事件============&quot;</span>+ event.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo7Application.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看下打印结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/48329b7a9dad9d6fd9771111f9834a65_1737625149736.png" alt="在这里插入图片描述"><br>说明这个应用关闭的事件触发了。</p>
<p>总结：本文章主要讲了springboot配置监听器的步骤方式，原理和自带的事件等。</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/15/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(9)--@EnableAutoConfigration%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8%E5%92%8C%E5%8E%9F%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/15/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(9)--@EnableAutoConfigration%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8%E5%92%8C%E5%8E%9F%E7%90%86/" class="post-title-link" itemprop="url">springboot原理实战(9)--@EnableAutoConfigration注解使用和原理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-15 22:53:25" itemprop="dateCreated datePublished" datetime="2020-03-15T22:53:25+08:00">2020-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录："><a href="#目录：" class="headerlink" title="目录："></a>目录：</h1><p>前面了解了@Eanable*前缀注入特性实现的原理，是通过@import按照条件导入spring容器进行管理bean的。<br>现在了解@EnableAutoConfigration这个特殊的注解，先看本文章的脑图吧:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7ff0bdeebf53ebcb2cecd43fcfd5c698_1737625149736.png" alt="在这里插入图片描述"></p>
<h1 id="一、-EnableAutoConfigration原理概要"><a href="#一、-EnableAutoConfigration原理概要" class="headerlink" title="一、@EnableAutoConfigration原理概要:"></a>一、@EnableAutoConfigration原理概要:</h1><p>当然这个注解也是符合enable*前缀注解实现原理的，为啥它比较特殊呢？</p>
<p>主要这个注解导入的类比较多比较强大，很多类都是通过这个注解默认或者按照条件导入的。<br>这个注解有个属性<code>spring.boot.enableautoconfiguration</code>如下图红框:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7ff7b857e8b77fd31c89cf2e331d447a_1737625149736.png" alt="在这里插入图片描述"><br>这个属性配置了：默认的的注入了很多的类。配置文件在<br>jar包:spring-boot-autoconfigure-2.2.5.RELEASE.jar!\META-INF\spring.factories这个文件下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/da4351fa666a1c6d2e71e0a45688ccf3_1737625160232.png" alt="在这里插入图片描述"><br>默认导入的如此多的类，我们直接使用就可以了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/27522fbc8b8c6a40214ffb6608a20a2a_1737625160232.png" alt="在这里插入图片描述"></p>
<ul>
<li>其内部实现的关键点有:<br>1： ImportSelector 该接口的方法的返回值都会被纳入到spring容器中管理<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6e780dedc81a5598e9e58d5941e32119_1737625160232.png" alt="在这里插入图片描述"><br>2： SpringFactoriesLoader 该类可以从classpath中搜索所有的所有META-INF&#x2F;spring.factories 配置文件,并读取配置<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4bb36f5fc252fe0800a0d3c8f9208632_1737625160232.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/959f8ba840776d6406bdf394a2265031_1737625160232.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4e2de8a9cbd9ba8cfb4f823158547320_1737625172783.png" alt="在这里插入图片描述"></li>
</ul>
<p>我们知道了@EnableAutoConfigration注入bean的原理，就可用它来做一些例子了。</p>
<h1 id="二、手动添加自动配置类项加载bean"><a href="#二、手动添加自动配置类项加载bean" class="headerlink" title="二、手动添加自动配置类项加载bean"></a>二、手动添加自动配置类项加载bean</h1><p>@EnableAutoConfigration\是通过在META-INF\spring.factories配置<code>spring.boot.enableautoconfiguration</code>的值来操作加载bean的，我们也可以在项目中建立META-INF\spring.factories 文件，配置·spring.boot.enableautoconfiguration&#96;来增加bean到spring容器中：<br>案例：<br>我们建立2个项目，一个普通的spring项目，一个spirngboot项目，</p>
<h2 id="演示配置·spring-boot-enableautoconfiguration-来增加bean到spring容器中："><a href="#演示配置·spring-boot-enableautoconfiguration-来增加bean到spring容器中：" class="headerlink" title="演示配置·spring.boot.enableautoconfiguration&#96;来增加bean到spring容器中："></a>演示配置·spring.boot.enableautoconfiguration&#96;来增加bean到spring容器中：</h2><p>普通spring项目<code>core-bean</code>代码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/850785ebbbaacb27de49df05d27eee64_1737625172783.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Role</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunnableConfigration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">createUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>spring.factories<br>暂时啥也不写：<br>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.springboot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>core-bean<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>core-bean<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>springboot项目<code>demo6</code>:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e66cb80663005ff1102a185aca438a91_1737625172783.png" alt="在这里插入图片描述"><br>pom.xml<br>将core-bean这个包引入到demo6中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.springboot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>core-bean<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudyApplication</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(StudyApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        System.out.println(context.getBean(Role.class));</span><br><span class="line">        System.out.println(context.getBean(Runnable.class));</span><br><span class="line"></span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e4883a5f284acc6080dc515031269297_1737625172783.png" alt="在这里插入图片描述"><br>因为，<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9401f3fc61b05c0129e4eef4c61cdd55_1737625172783.png" alt="在这里插入图片描述"><br>没有加@Component或者@Configration注解:<br>现在换种方式:修改core-bean的factories的文件：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.springboot.corebean.Role,com.springboot.corebean.UserConfiguration,com.springboot.corebean.RunnableConfigration</span><br></pre></td></tr></table></figure>
<p>再次启动demo6的入口函数:<br>运行结果如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2452b83ef5ecfeb9d8a6ed0435939ef6_1737625182849.png" alt="在这里插入图片描述"><br>结果显示我们已经都将bean注入进来了。</p>
<h1 id="三、禁用自动配置功能"><a href="#三、禁用自动配置功能" class="headerlink" title="三、禁用自动配置功能"></a>三、禁用自动配置功能</h1><p>刚才，我们利用EnableAutoConfiguration的注入bean的配置文件增加了几个我们自己的bean。那么我们怎么这个启用自动注入的功能禁用呢？<br>很简单：<br>来操作下：<br>在demo6的<code>application.properties</code>:<br>配置如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.boot.enableautoconfiguration=false</span><br></pre></td></tr></table></figure>
<p>再次测试<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/70adbec0f8814279dbf90a62a175ff48_1737625182849.png" alt="在这里插入图片描述"><br>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/58e7ba3e30d53c1adeb10912891a4b30_1737625182849.png" alt="在这里插入图片描述"><br>这样，就实现了禁用自动注入的功能了。</p>
<h2 id="为什么这样配置就可禁用了"><a href="#为什么这样配置就可禁用了" class="headerlink" title="为什么这样配置就可禁用了?"></a>为什么这样配置就可禁用了?</h2><p>继续追源码：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/dce37343f797773dea58ae989789d495_1737625182849.png" alt="在这里插入图片描述"><br>看下导入的AutoConfigurationImportSelector<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0bc39659ecb19daf926c510d716a9394_1737625182849.png" alt="在这里插入图片描述"><br>AutoConfigurationImportSelector类有个方法:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/72ee13ef173d4628af992e0bcd1cdcb8_1737625194885.png" alt="在这里插入图片描述"><br>这个就是是否启用：<code>SPring.boot.enableautoconfiguration</code>属性的，默认的true，第3个参数，默认是启用的。</p>
<h1 id="四、排除自动配置项的2种方式"><a href="#四、排除自动配置项的2种方式" class="headerlink" title="四、排除自动配置项的2种方式"></a>四、排除自动配置项的2种方式</h1><p>刚才是将自动配置的功能全部注入，我们实际项目中肯定不会这么用，不然springboot最好用的就被我们给抛弃了，还用springboot干啥。但是我们有排除某个注入的类的需求。<br>看下源码：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c903fd70ddfaa173dbb5dbcbf249e6a0_1737625194885.png" alt="在这里插入图片描述"><br>发现有个2中方式排除，那么继续做案例:</p>
<h2 id="根据类"><a href="#根据类" class="headerlink" title="根据类"></a>根据类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">createUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>spring.factories</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.springboot.corebean.Role,com.springboot.corebean.UserConfiguration,com.springboot.corebean.RunnableConfigration</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6fe7e0b4bc119def4a32f5084f96bfb3_1737625194885.png" alt="在这里插入图片描述"><br>打印：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/33225e001a14b32d4b9787058b16b91f_1737625194885.png" alt="在这里插入图片描述"><br>说明user没有被注入进去，我们已经把他排除了。</p>
<h2 id="也可以按照类名"><a href="#也可以按照类名" class="headerlink" title="也可以按照类名:"></a>也可以按照类名:</h2><p>改成这样即可:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4c369bc3195e03156c0f8f8d12a7e70b_1737625194885.png" alt="在这里插入图片描述"><br>同样可以排除注入的bean。</p>
<h1 id="五、springboot提供的自动配置项有哪些"><a href="#五、springboot提供的自动配置项有哪些" class="headerlink" title="五、springboot提供的自动配置项有哪些"></a>五、springboot提供的自动配置项有哪些</h1><p>继续看spring.properties<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/541cfaf5b08f9c23cff734d1c3f4ebe2_1737625205303.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/ad0af022890a1bdea66b84725ad22d21_1737625205303.png" alt="在这里插入图片描述"></p>
<h1 id="六、GsonAutoConfiguration注解说明"><a href="#六、GsonAutoConfiguration注解说明" class="headerlink" title="六、GsonAutoConfiguration注解说明"></a>六、GsonAutoConfiguration注解说明</h1><p>我们来瞅一个,我们熟悉的gson：看下他怎么注入的：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e72d928c949bfb95be5b1da4b81ef871_1737625205303.png" alt="在这里插入图片描述"><br>看到了我们之前学过得condition接口的实现类，表示没有gson的时候，这个GsonAutoConfigiguration才生成。一个。有的化就不注入了。<br>而且我们还能看出来，并不是EnableAutoConfiguration这个注解的spring.boot.enableautoconfiguration属性配置了就一定注入到spring。他可以结合condition和conditional注解来条件话选择注入。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a8e230586693e158ee5692b9eee17f2e_1737625205303.png" alt="在这里插入图片描述"><br>现在我们测试下，spring帮我们注入gson了不？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudyApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(StudyApplication.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getBeansOfType(Gson.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打印结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/de60bf955f4151d8de06b7550ea48025_1737625205303.png" alt="在这里插入图片描述"><br>跟我们分析的源码一致，在我们没注入的情况下，GsonAutoConfigiguration帮我们自动注入Gson对象了。</p>
<h1 id="七、为什么-EnableAutoConfiguration也可当做配置类来用"><a href="#七、为什么-EnableAutoConfiguration也可当做配置类来用" class="headerlink" title="七、为什么@EnableAutoConfiguration也可当做配置类来用?"></a>七、为什么@EnableAutoConfiguration也可当做配置类来用?</h1><p>将一个bean当做一个配置类并启用的注解是:@EnableConfigurationProperties，但是入口函数：<br>@SpringBootApplication一个注解了：<br>这个类里没有@EnableConfigurationProperties，只有@EnableAutoConfiguration，为啥就能启用配置类了？<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7889a0468289658a0a5f6690b7d41ad7_1737625217523.png" alt="在这里插入图片描述"><br>原理其实今天已经讲了：肯定是@EnableAutoConfiguration中的属性中有这个@EnableConfigurationProperties项,<br>我们去验证我们的答案：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/76448b860bcdd1f31bb69d0a5b7ced25_1737625217523.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/067be9c53d1b5a1227acfe40e952500a_1737625217523.png" alt="在这里插入图片描述"><br>所以@EnableAutoConfiguration自动注入了@EnableConfigurationProperties，也就能实现启用配置类的作用了。</p>
<p>总结：本文主要讲了@EnableAutoConfigration注解使用和原理，就是通过一个spring.properties文件来实现按条件注入bean的，可以全局禁用自动配置，也可以按照类或者类名从spring容器中剔除某个类的管理，还说了常用的GsonAutoConfiguration是如何帮我们自动注入一个Gson对象的，以及了解了为什么@EnableAutoConfiguration也可当做配置类来用。</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/12/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(8)--enable%E5%89%8D%E7%BC%80%E6%B3%A8%E8%A7%A3%E4%B9%8B%E5%BC%80%E5%90%AF%E7%89%B9%E6%80%A7%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E6%A1%88%E4%BE%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/12/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(8)--enable%E5%89%8D%E7%BC%80%E6%B3%A8%E8%A7%A3%E4%B9%8B%E5%BC%80%E5%90%AF%E7%89%B9%E6%80%A7%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E6%A1%88%E4%BE%8B/" class="post-title-link" itemprop="url">springboot原理实战(8)--enable前缀注解之开启特性的原理和案例</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-12 21:33:45" itemprop="dateCreated datePublished" datetime="2020-03-12T21:33:45+08:00">2020-03-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>本篇文章主要讨论enable前缀的注解的使用方法和实现原理：<br>主要内容如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/14aad8f536e5b41baa597058f0c60d51_1737625217523.png" alt="在这里插入图片描述"></p>
<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>在springboot中很多enable开头的注解，如<code>@EnableConfigurationProperties</code>,<code>@EnableAsync</code>等，这些注解的作用就是：启动一个新特性，现在演示2个例子。</p>
<h1 id="二、作用和案例"><a href="#二、作用和案例" class="headerlink" title="二、作用和案例"></a>二、作用和案例</h1><h2 id="1-EnableConfigurationProperties"><a href="#1-EnableConfigurationProperties" class="headerlink" title="1.@EnableConfigurationProperties"></a>1.@EnableConfigurationProperties</h2><p>入口函数上的注解，默认使用的是<code>@SpringBootConfiguration</code>,其实我们也可以使用<code>@EnableAutoConfiguration  + @ComponentScan</code>,甚至是<code>@EnableConfigurationProperties +@ComponentScan</code>来注入bean，详细我们可以举个例子，看下:<br>application.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tomcat.host=192.168.157.1</span><br><span class="line">tomcat.port=8080</span><br></pre></td></tr></table></figure>
<p>TomcatProperties 配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;tomcat&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line">    <span class="keyword">private</span> Integer port;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;TomcatProperties&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;tomcat.host=&#x27;&quot;</span> + host + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, tomcat.port=&quot;</span> + port +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getHost</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHost</span><span class="params">(String host)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.host = host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getPort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> port;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPort</span><span class="params">(Integer port)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.port = port;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//案例1;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo5Application.class, args);</span><br><span class="line">        System.out.println(context.getBean(TomcatProperties.class));</span><br><span class="line">        context.close();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c468a10b8c0edfca2f6f8e9b3d8649c3_1737625227967.png" alt="在这里插入图片描述"><br>改变1：@SpringBootApplication改成 @ComponentScan和@EnableAutoConfiguration看下效果:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//案例1;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo5Application.class, args);</span><br><span class="line">        System.out.println(context.getBean(TomcatProperties.class));</span><br><span class="line">        context.close();        </span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：也可以注入进来配置文件的属性！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/65e59a4a21d6b6e2a0a1caedd3fe29ec_1737625227967.png" alt="在这里插入图片描述"><br>改变2：上面的注解再次把@EnableAutoConfiguration换成@EnableConfigurationProperties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableConfigurationProperties</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//案例1;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo5Application.class, args);</span><br><span class="line">        System.out.println(context.getBean(TomcatProperties.class));</span><br><span class="line">        context.close();</span><br><span class="line">     &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再次运行：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/7442f8e5d677fc99152959cc658c9f8e_1737625227967.png" alt="在这里插入图片描述"><br>结果显示都可以将属性注入进来，说明一个问题，上面的注解都可以把<code>TomcatProperties</code>这样的配置类对应的配置属性注入进来。<br>这几个注解都具有这个特性：可以把配置文件的属性注入到bean里面去。<br>注意的是：需要配合配置类上的<code>@ConfigurationProperties</code>使用。</p>
<h2 id="2-EnableAync实现异步方法"><a href="#2-EnableAync实现异步方法" class="headerlink" title="2.@EnableAync实现异步方法"></a>2.@EnableAync实现异步方法</h2><p>@EnableAsync 作用: 启用异步方法，一般是和@Async一起使用.<br>举例说明:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Jeep</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;======&quot;</span> + i);</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo5Application.class, args);</span><br><span class="line">        context.getBean(Runnable.class).run();</span><br><span class="line">        System.out.println(<span class="string">&quot;-------end-------------&quot;</span>);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/efd1047c4eb1d786995ba0d9bc136d20_1737625227967.png" alt="在这里插入图片描述"><br>打印的end是main里面的方法说明是同步执行的，我们来修改下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Jeep</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;======&quot;</span> + i);</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo5Application.class, args);</span><br><span class="line">        context.getBean(Runnable.class).run();</span><br><span class="line">        System.out.println(<span class="string">&quot;-------end-------------&quot;</span>);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果，先执行了main，方法，然后慢慢执行，说明是异步执行的。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/274f1a0345b7598502aa67b1040e2046_1737625227968.png" alt="在这里插入图片描述"><br>enable*等注解既然这么好用，那么是如何实现的呢?接着分析:</p>
<h1 id="三、enable-等注解能够实现的原理"><a href="#三、enable-等注解能够实现的原理" class="headerlink" title="三、enable*等注解能够实现的原理"></a>三、enable*等注解能够实现的原理</h1><p>我们看下@EnableAsync。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c754116968fe6972b514c5f9c6b35d8b_1737625237013.png" alt="在这里插入图片描述"><br>发现有个@Import注解。<br>@EnableConfigurationProperties注解：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/46af17e80e7d3af8a786a7e3a95d8c07_1737625237013.png" alt="在这里插入图片描述"><br>也有个注解@Import。<br>再看下@Import，有个value属性，可以指定多个类或者配置类<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/29710eb6b8956895f8c183d82350d8af_1737625237013.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1d1b7714f3f7a5ee7314d4f15d14d879_1737625237013.png" alt="在这里插入图片描述"><br>也就是说明：能够自动启用的原因和这个<code>@Import的注解</code>和<code>它里面的value属性</code>有关。<br>@Import的注解可以导入某个bean（在value属性中指定）或配置类（在value属性中指定)到容器中，而且value属性指定的类有某些特定的功能，我们只要用@import导入就可了。</p>
<h2 id="1-使用import导入一个bean或者配置bean"><a href="#1-使用import导入一个bean或者配置bean" class="headerlink" title="1.使用import导入一个bean或者配置bean"></a>1.使用import导入一个bean或者配置bean</h2><p>我们就试试这个import的能不能帮我们导入一个bean或者配置类：<br>首先定义2个bean和一个配置bean，都没加@Component:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Role</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>入口中导入这3个bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@Import(&#123;User.class, Role.class, MyConfiguration.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(App.class, args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        System.out.println(context.getBean(Role.class));</span><br><span class="line">        System.out.println(context.getBeansOfType(Runnable.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>看下执行结果：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/5fe8c365aa93f211ee84ef6fa8195432_1737625237013.png" alt="在这里插入图片描述"><br>全部打印出来了，说明import已经帮我们注入了。</p>
<h2 id="2-使用-import导入一个bean前加点自己的逻辑"><a href="#2-使用-import导入一个bean前加点自己的逻辑" class="headerlink" title="2.使用@import导入一个bean前加点自己的逻辑"></a>2.使用@import导入一个bean前加点自己的逻辑</h2><p>刚才我们实践了import导入类了，再进一步考虑下，能不能在导入类前加入自己的逻辑，以前学过直接实现beanDefination等接口，可是这样的话会影响所有的bean。能不能缩小点范围，只影响我们需要导入的类呢？<br>可以的。<code>思路就是可以定义一个注解，在需要加载的bean上添加注解就可以过滤了。</code><br>注解里面用@import导入一些加载bean的处理器，在处理器方法中进行我们自己的逻辑。<br>这里提到了2点:一个是注解，注解就是我们之前用的enable前缀作为开头的注解。一个处理器。我们看下springboot源码中:<br>有2类：</p>
<h3 id="①-实现了ImportBeanDefinitionRegistrar接口的处理器"><a href="#①-实现了ImportBeanDefinitionRegistrar接口的处理器" class="headerlink" title="①.实现了ImportBeanDefinitionRegistrar接口的处理器"></a>①.实现了ImportBeanDefinitionRegistrar接口的处理器</h3><ul>
<li>看下@EnableConfigurationProperties注解<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3a90c1a7deea605190f84341236a61a8_1737625249268.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/60b8cb5e82f07e7dd9a11fef6151c5be_1737625249268.png" alt="在这里插入图片描述"></li>
</ul>
<h3 id="②-实现了ImportSelector接口的处理器"><a href="#②-实现了ImportSelector接口的处理器" class="headerlink" title="②.实现了ImportSelector接口的处理器"></a>②.实现了ImportSelector接口的处理器</h3><p>看下:@EnableAsync<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/14de6e8b346a1313c61eced7cba9d760_1737625249268.png" alt="在这里插入图片描述"><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/21b39684f507fdfe8f7bb4c71d083ef2_1737625249268.png" alt="在这里插入图片描述"><br>主要是利用importSelector的selectImports方法:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e8ae4cc1c406f701edce70e49e5b0481_1737625249268.png" alt="在这里插入图片描述"></p>
<h3 id="③案例："><a href="#③案例：" class="headerlink" title="③案例："></a>③案例：</h3><p>知道了这两类接口的原理。我们来几个案例：</p>
<h4 id="a-实现ImportSelector导入类并在导入类时一点逻辑"><a href="#a-实现ImportSelector导入类并在导入类时一点逻辑" class="headerlink" title="a.实现ImportSelector导入类并在导入类时一点逻辑"></a>a.实现ImportSelector导入类并在导入类时一点逻辑</h4><p>MyImportSelector<br><code>selectImports方法的返回值，必须是一个class（全称），该class会被spring容器所托管起来</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//selectImports方法的返回值，必须是一个class（全称），该class会被spring容器所托管起来</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyImportSelector</span> <span class="keyword">implements</span> <span class="title class_">ImportSelector</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] selectImports(AnnotationMetadata importingClassMetadata) &#123;</span><br><span class="line">        System.out.println(importingClassMetadata.getAnnotationAttributes(EnableLog.class.getName()));</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 这里可以获取直接的详细信息，然后根据信息去动态的返回需要被Spring容器管理的bean</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;com.springboot.demo5.User&quot;</span>,Role.class.getName(),MyConfiguration.class.getName()&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个处理器，加入了3个类，并在这3个类注入的时候加点逻辑。<br>自定义注解@EnableLog</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(&#123;MyImportSelector.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableLog &#123;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>测试入口类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableLog(name=&quot;my springboot&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(App2.class, args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        System.out.println(context.getBean(Role.class));</span><br><span class="line">        System.out.println(context.getBeansOfType(Runnable.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>可以看到通过@EnableLog注解，我们注入了bean，并且打印了我们添加的业务代码：</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c1d99d86e93a3037671487ceeca9c9b6_1737625261136.png" alt="在这里插入图片描述"></p>
<h4 id="b-实现ImportBeanDefinitionRegistrar导入类"><a href="#b-实现ImportBeanDefinitionRegistrar导入类" class="headerlink" title="b.实现ImportBeanDefinitionRegistrar导入类"></a>b.实现ImportBeanDefinitionRegistrar导入类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * registerBeanDefinitions方法的参数有一个BeanDefinitionRegistry，</span></span><br><span class="line"><span class="comment"> * BeanDefinitionRegistry 可以用来往spring容器中注入bean</span></span><br><span class="line"><span class="comment"> * 如此，我们就可以在registerBeanDefinitions方法里面动态的注入bean</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyImportBeanDefinitionRegister</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">BeanDefinitionBuilder</span> <span class="variable">bdb</span> <span class="operator">=</span> BeanDefinitionBuilder.rootBeanDefinition(User.class);</span><br><span class="line">        registry.registerBeanDefinition(<span class="string">&quot;user&quot;</span>, bdb.getBeanDefinition());</span><br><span class="line"></span><br><span class="line">        <span class="type">BeanDefinitionBuilder</span> <span class="variable">bdb2</span> <span class="operator">=</span> BeanDefinitionBuilder.rootBeanDefinition(Role.class);</span><br><span class="line">        registry.registerBeanDefinition(<span class="string">&quot;role&quot;</span>,  bdb2.getBeanDefinition());</span><br><span class="line"></span><br><span class="line">        <span class="type">BeanDefinitionBuilder</span> <span class="variable">bdb3</span> <span class="operator">=</span> BeanDefinitionBuilder.rootBeanDefinition(MyConfiguration.class);</span><br><span class="line">        registry.registerBeanDefinition(MyConfiguration.class.getName(),  bdb3.getBeanDefinition());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(&#123;MyImportBeanDefinitionRegister.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableLog &#123;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableLog(name=&quot;my springboot&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(App2.class, args);</span><br><span class="line">        System.out.println(context.getBean(User.class));</span><br><span class="line">        System.out.println(context.getBean(Role.class));</span><br><span class="line">        System.out.println(context.getBeansOfType(Runnable.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>看下结果，同样注入了bean:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/95e9728057b28aa0d306048148c9b933_1737625261136.png" alt="在这里插入图片描述"></p>
<h1 id="四、手动实现个enable-注解案例"><a href="#四、手动实现个enable-注解案例" class="headerlink" title="四、手动实现个enable*注解案例"></a>四、手动实现个enable*注解案例</h1><p>案例:我们手动实现个注解，主要在某个包下，我们就打印包下的所有类的权限定名：<br>准备2个包，和2个bean<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0fd8c1a3ce1780507d59ab854a4b3b07_1737625261136.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>EchoImportBeanDefinitionRegistrar</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.support.BeanDefinitionBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.support.BeanDefinitionRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ImportBeanDefinitionRegistrar;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.AnnotationMetadata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EchoImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; attr = importingClassMetadata.getAnnotationAttributes(EnableEcho.class.getName());</span><br><span class="line">        String[] packAttr = (String[]) attr.get(<span class="string">&quot;packages&quot;</span>);</span><br><span class="line">        List&lt;String&gt; packages = Arrays.asList(packAttr);</span><br><span class="line">        System.out.println(<span class="string">&quot;packages: &quot;</span>+ packages);</span><br><span class="line">        <span class="type">BeanDefinitionBuilder</span> <span class="variable">bdb</span> <span class="operator">=</span> BeanDefinitionBuilder.rootBeanDefinition(EchoBeanPostProcessor.class);</span><br><span class="line">        bdb.addPropertyValue(<span class="string">&quot;packages&quot;</span>,packages);</span><br><span class="line">        registry.registerBeanDefinition(EchoBeanPostProcessor.class.getName(), bdb.getBeanDefinition());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>EchoBeanPostProcessor</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EchoBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; packages;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">for</span> (String pack: packages)&#123;</span><br><span class="line">            <span class="keyword">if</span> (bean.getClass().getName().startsWith(pack))&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;echo bean : &quot;</span> + bean.getClass().getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPackages</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> packages;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPackages</span><span class="params">(List&lt;String&gt; packages)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.packages = packages;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@EnableEcho</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(&#123;EchoImportBeanDefinitionRegistrar.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableEcho &#123;</span><br><span class="line">    String[] packages() ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableLog(name=&quot;my springboot&quot;)</span></span><br><span class="line"><span class="meta">@EnableEcho(packages = &#123;&quot;com.springboot.demo5.bean&quot;,&quot;com.springboot.demo5.vo&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App3</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(App3.class, args);</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e7aaf4a6579a72de8d5c363a8dc82c02_1737625261136.png" alt="在这里插入图片描述"><br>结果显示如预期。</p>
<hr>
<p>回顾下：本篇主要介绍了enable前缀注解的使用和原理，主要根据import导入，importSelector或者ImportBeanDefinitionRegistrar实现类为参数，结合我们可以根据enable注解上的参数来控制操作bean，或者在注入bean前加入我们自己的逻辑。</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/11/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(7)--%E4%BD%BF%E7%94%A8Conditional%E5%AE%9E%E7%8E%B0%E6%8C%89%E6%9D%A1%E4%BB%B6%E6%B3%A8%E5%85%A5bean/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/11/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(7)--%E4%BD%BF%E7%94%A8Conditional%E5%AE%9E%E7%8E%B0%E6%8C%89%E6%9D%A1%E4%BB%B6%E6%B3%A8%E5%85%A5bean/" class="post-title-link" itemprop="url">springboot原理实战(7)--使用Conditional实现按条件注入bean</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-11 16:07:27" itemprop="dateCreated datePublished" datetime="2020-03-11T16:07:27+08:00">2020-03-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>本系列博客第一篇就是如何利用spring4+注解方式注入bean，在springboot中提供了按照条件方式注入，我们可以按照条件选择注入或者不注入bean。<br>本篇博客的内容概要:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/f0fc359ebe5c008fe49b9d352438d4d1_1737625271018.png" alt="在这里插入图片描述"></p>
<h1 id="一、Conditional按照条件注入bean原理"><a href="#一、Conditional按照条件注入bean原理" class="headerlink" title="一、Conditional按照条件注入bean原理"></a>一、Conditional按照条件注入bean原理</h1><p>看下Conditional注解源码，它有个value属性类型就是condition的。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d61ba629d683e23031a975a1587145d9_1737625271018.png" alt="在这里插入图片描述"><br>看下Condition接口源码:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e68c774c039b151780cd0298be483ebb_1737625271018.png" alt="在这里插入图片描述"><br>这个接口只有一个方法，是否匹配的matches方法，返回boolean类型。</p>
<p>所以<code>Conditional注解 能够提供基于条件的自动配置，一般配合Condition接口(1个或多个)一起使用，只有接口的实现类都返回true，才装配，否则不装配.</code>。<br>现在我们自定义一个condition实现类来，结合conditional注解，来切换是否能注入bean。</p>
<h1 id="二、自定义condition接口注入bean"><a href="#二、自定义condition接口注入bean" class="headerlink" title="二、自定义condition接口注入bean"></a>二、自定义condition接口注入bean</h1><p>案例:根据代码的字符集。 判断是否注入我们自己定义的bean。<br>字符集转换接口:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EncodingConvert</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有2个实现类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GbkEncodinConvert</span> <span class="keyword">implements</span> <span class="title class_">EncodingConvert</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Utf8EncodingConvert</span> <span class="keyword">implements</span> <span class="title class_">EncodingConvert</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后分别写2个condition条件，来切换是否能注入bean的实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GbkCondition</span> <span class="keyword">implements</span> <span class="title class_">Condition</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;file.encoding&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (encoding != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;gbk&quot;</span>.equals(encoding.toLowerCase());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Utf8Condition</span> <span class="keyword">implements</span> <span class="title class_">Condition</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;file.encoding&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (encoding != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;utf-8&quot;</span>.equals(encoding.toLowerCase());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写个配置类，在配置类里装载bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodingConvertConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Conditional(Utf8Condition.class)</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createUtf8EncodingConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Utf8EncodingConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Conditional(GbkCondition.class)</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createGbkEncodinConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GbkEncodinConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到上面的装载方式都加了个条件，@Conditional,参数内容为<br>根据<code>System.getProperty(&quot;file.encoding&quot;)</code>的值来判断，是否装载，如果是utf-8就装载createUtf8EncodingConvert类，如果是gbk就装载createGbkEncodinConvert这个类。</p>
<p>我们进入入口函数测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo4Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo4Application.class, args);</span><br><span class="line">        System.out.println(System.getProperty(<span class="string">&quot;file.encoding&quot;</span>));</span><br><span class="line">        System.out.println(context.getBeansOfType(EncodingConvert.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打印结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4374bbb085d210a7f736627c388ed5e5_1737625271018.png" alt="在这里插入图片描述"><br>显示注入了bean，因为编码字符集是UTF-8。<br>我们切换下参数：再试下：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/cd0cd4b10599561784983e87196be0cb_1737625271018.png" alt="在这里插入图片描述"><br>打印结果:</p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2424ed9aba00317740dcdf07559e63d7_1737625280934.png" alt="在这里插入图片描述"><br>同时我们也可以将@Conditional条件放在类上，因为@Conditional的value是个集合，所以可以指定多个,这些条件都满足才能装载类里面的bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@Conditional(&#123;Utf8Condition.class,GbkCondition.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodingConvertConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createUtf8EncodingConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Utf8EncodingConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createGbkEncodinConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GbkEncodinConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打印结果,因为类的条件为false，所以没有装载bean。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4253acd6e1d5e27b600a6fcd0fe224e9_1737625280934.png" alt="在这里插入图片描述"><br>我们改成类的条件为true的情况：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@Conditional(&#123;Utf8Condition.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodingConvertConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createUtf8EncodingConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Utf8EncodingConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> EncodingConvert <span class="title function_">createGbkEncodinConvert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GbkEncodinConvert</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>再次运行入口函数，发现类下的2个bean都被注入了：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/0d061943b2af24191f5371e972133dc7_1737625280934.png" alt="在这里插入图片描述"></p>
<h1 id="三、springboot提供的-Conditional工具类"><a href="#三、springboot提供的-Conditional工具类" class="headerlink" title="三、springboot提供的@Conditional工具类"></a>三、springboot提供的@Conditional工具类</h1><p>上面是我们自己定义的@Conditional参数中的condition实现类，其实springboot也提供了很多的实用的@Conditional工具类，我们可以直接去使用就可以。<br>在<img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/8f0b2d7d7574c2d1dad145ba829cb008_1737625280934.png" alt="在这里插入图片描述"><br>里面有很多的condition实现类：</p>
<table>
<thead>
<tr>
<th>注解</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>@ConditionalOnSingleCandidate</code></td>
<td>当给定类型的bean存在并且指定为Primary的给定类型存在时,返回true</td>
</tr>
<tr>
<td><code>@ConditionalOnMissingBean</code></td>
<td>当给定的类型、类名、注解、昵称在beanFactory中不存在时返回true.各类型间是or的关系</td>
</tr>
<tr>
<td><code>@ConditionalOnBean</code></td>
<td>与上面相反，要求bean存在</td>
</tr>
<tr>
<td><code>@ConditionalOnMissingClass</code></td>
<td>当给定的类名在类路径上不存在时返回true,各类型间是and的关系</td>
</tr>
<tr>
<td><code>@ConditionalOnClass</code></td>
<td>与上面相反，要求类存在</td>
</tr>
<tr>
<td><code>@ConditionalOnCloudPlatform</code></td>
<td>当所配置的CloudPlatform为激活时返回true</td>
</tr>
<tr>
<td><code>@ConditionalOnExpression</code></td>
<td>spel表达式执行为true</td>
</tr>
<tr>
<td><code>@ConditionalOnJava</code></td>
<td>运行时的java版本号是否包含给定的版本号.如果包含,返回匹配,否则,返回不匹配</td>
</tr>
<tr>
<td><code>@ConditionalOnProperty</code></td>
<td>要求配置属性匹配条件</td>
</tr>
<tr>
<td><code>@ConditionalOnJndi</code></td>
<td>给定的jndi的Location 必须存在一个.否则,返回不匹配</td>
</tr>
<tr>
<td><code>@ConditionalOnNotWebApplication</code></td>
<td>web环境不存在时</td>
</tr>
<tr>
<td><code>@ConditionalOnWebApplication</code></td>
<td>web环境存在时</td>
</tr>
<tr>
<td><code>@ConditionalOnResource</code></td>
<td>要求制定的资源存在</td>
</tr>
</tbody></table>
<p>现在我们使用几个测试下</p>
<h2 id="1-ConditionalOnProperty"><a href="#1-ConditionalOnProperty" class="headerlink" title="1.@ConditionalOnProperty"></a>1.@ConditionalOnProperty</h2><p>某个属性等于某个值的时候才装配。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//某个属性等于某个值的时候才装配</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnProperty(name=&quot;runable.enabled&quot;,havingValue = &quot;true&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunable</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>这个例子是 如果有runable.enabled这个属性，并且值为true就注入，我们测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo4Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo4Application.class, args);</span><br><span class="line">        System.out.println(context.getBeansOfType(Runnable.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:显示没有装载。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e9b949843ba84bb94eb3ecc438ebb6bc_1737625280934.png" alt="在这里插入图片描述"><br>我们在application.properties添加<code>runable.enabled=true</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runable.enabled=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>再次测试，显示已经装载进来了：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/a9f2c518eb2bb4623c42a3bd6d36fdd4_1737625289323.png" alt="在这里插入图片描述"><br>@ConditionalOnProperty还有个属性<code>matchIfMissing</code>，没有这个属性的时候，让条件变为true或false。<br>我们做个测试，让其他变为true，同时删除配置文件中的<code>runable.enabled=false</code>这行代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//某个属性等于某个值得时候才装配</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnProperty(name=&quot;runable.enabled&quot;,havingValue = &quot;true&quot;,matchIfMissing = true)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunable</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>测试下，在缺少配置文件属性的情况下也注入进来了：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e7c2cc542db4bc99ce511c51ea040d35_1737625289323.png" alt="在这里插入图片描述"></p>
<h2 id="2-ConditionalOnClass"><a href="#2-ConditionalOnClass" class="headerlink" title="2.@ConditionalOnClass"></a>2.@ConditionalOnClass</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//表示 classpath中存在某个class的时候才装配</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnClass(name=&quot;com.google.gson.Gson&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createGsonRunable</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>我们判断如果项目有这个Gson类就加载否则不加载，现在项目jar里面没有的，应该不注入，我们看下效果:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo4Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo4Application.class, args);</span><br><span class="line">        System.out.println(context.getBeansOfType(Runnable.class));</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:的确没注入进来。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/dc5859e72cdaf2c9ee55887ec5674964_1737625289323.png" alt="在这里插入图片描述"><br>现在我们让他注入进来，在pom.xml中引入gson包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>再次运行，显示已经注入进来了：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/96822f93c68b3d7b024c0c52c82fa671_1737625289323.png" alt="在这里插入图片描述"></p>
<h2 id="3-ConditionalOnBean"><a href="#3-ConditionalOnBean" class="headerlink" title="3.@ConditionalOnBean"></a>3.@ConditionalOnBean</h2><p><code>根据容器中是否存在某个bean来进行装配</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfiguration</span> &#123;</span><br><span class="line">    <span class="comment">//根据容器中是否存在某个bean来进行装配</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean(name=&quot;user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createUserRunable</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>目前项目中没有名字为user的bean，我们打印测试下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/04c3184d8f7bc8c484f661431a179b20_1737625289323.png" alt="在这里插入图片描述"><br>的确没注入。<br>我们写个user的bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>再次测试,显示注入了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/689e93bfdf3a713a59f92b8b760c2ed3_1737625297818.png" alt="在这里插入图片描述"><br>本文的所有内容已经完毕，主要就是按照条件转载bean，可以自定义和使用springboot提供的一些实用的工具类来为我所用。在以后的工作中，具体的类再具体了解吧。</p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hufanglei.github.io/2020/03/11/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(6)--%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%A8%E5%85%A5%E9%9B%86%E5%90%88%EF%BC%8C%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%88%87%E6%8D%A2profile%E7%8E%AF%E5%A2%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="胡方雷">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
      <meta itemprop="description" content="直到这一刻微笑着说话为止，我至少留下了一公升眼泪">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/11/springboot%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98(6)--%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%A8%E5%85%A5%E9%9B%86%E5%90%88%EF%BC%8C%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%88%87%E6%8D%A2profile%E7%8E%AF%E5%A2%83/" class="post-title-link" itemprop="url">springboot原理实战(6)--配置文件注入集合，动态注入，切换profile环境</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-11 13:27:34" itemprop="dateCreated datePublished" datetime="2020-03-11T13:27:34+08:00">2020-03-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-24 11:37:59" itemprop="dateModified" datetime="2025-01-24T11:37:59+08:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/spring%E5%AE%B6%E6%97%8F/" itemprop="url" rel="index"><span itemprop="name">spring家族</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>

<p>@[TOC]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>本篇文章是上篇文章的补充，主要内容概要如下:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/dc4fffcb1f22d6ada2c19598e13538ef_1737625297818.png" alt="在这里插入图片描述"></p>
<h1 id="一、配置文件后缀的2种方式"><a href="#一、配置文件后缀的2种方式" class="headerlink" title="一、配置文件后缀的2种方式"></a>一、配置文件后缀的2种方式</h1><p>配置文件有2种<code>*.properties</code>和<code>*.yml</code>,可以单独使用也可以混合使用(不过项目中不知道有没这么干的).<br>application.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.username=root</span><br></pre></td></tr></table></figure>
<p>application.yml</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc:</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">hufanglei</span></span><br><span class="line">  <span class="attr">password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>
<p>运行入口函数，测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo3Application.class, args);</span><br><span class="line">       System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;jdbc.username&quot;</span>));</span><br><span class="line">       System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;jdbc.password&quot;</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1fb7f0f90a148ca7f18f9f23c6af6f16_1737625297818.png" alt="在这里插入图片描述"><br>打印了yml的jdbc.password和properties的username。</p>
<blockquote>
<p>结果说明：<br>1.这2个配置文件都生效了。<br>2.如果2个配置文件重名，properties的优先级高。都有jdbc.username但是显示的是properties的。</p>
</blockquote>
<h1 id="二、配置文件属性注入扩展-集合和数组"><a href="#二、配置文件属性注入扩展-集合和数组" class="headerlink" title="二、配置文件属性注入扩展:集合和数组"></a>二、配置文件属性注入扩展:集合和数组</h1><p>配置文件属性可以写数组或集合，现在我们展示用这2种方式接受并读取出来属性值：<br><code>application.properties</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ds.hosts[0]=192.168.157.1</span><br><span class="line">ds.hosts[1]=192.168.157.2</span><br><span class="line">ds.hosts[2]=192.168.157.3</span><br><span class="line"></span><br><span class="line"><span class="comment">#ds.ports=8080，8081，8082 //这种写法也可以</span></span><br><span class="line">ds.ports[0]=8080</span><br><span class="line">ds.ports[1]=8081</span><br><span class="line">ds.ports[2]=8082</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;ds&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hosts = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> String[] ports;</span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getHosts</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> hosts;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHosts</span><span class="params">(List&lt;String&gt; hosts)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hosts = hosts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getPorts() &#123;</span><br><span class="line">        <span class="keyword">return</span> ports;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPorts</span><span class="params">(String[] ports)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.ports = ports;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;TomcatProperties&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;hosts=&quot;</span> + hosts +</span><br><span class="line">                <span class="string">&quot;, ports=&quot;</span> + Arrays.toString(ports) +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>开始测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo3Application.class, args);</span><br><span class="line">       System.out.println(context.getBean(TomcatProperties.class));</span><br><span class="line">       context.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6578f72283783d7577bdbef4a5b4b6ce_1737625297818.png" alt="在这里插入图片描述"></p>
<h1 id="三、EnvironmentPostProcessor-动态加载配置文件"><a href="#三、EnvironmentPostProcessor-动态加载配置文件" class="headerlink" title="三、EnvironmentPostProcessor 动态加载配置文件"></a>三、EnvironmentPostProcessor 动态加载配置文件</h1><p>配置文件的属性我们从上篇博客了解到可以使用@Value和Environment的getProperty方法获取， 也可以通过@PropertySource编码方式读取。<br>其实如果还有一种方式：<br>可以动态的从不同的地方收集配置文件，加入到自己的项目中并获取。这个就是通过<code>EnvironmentPostProcessor</code>接口。<br>使用和其他的后置处理器一样，自己实现这个接口，加载就可以。</p>
<p>准备一个配置文件:<code>D:/tmp/springboot.properties</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">springboot.name=springboot</span><br></pre></td></tr></table></figure>
<p>写自己的环境后置处理器:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEnvironmentPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">EnvironmentPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postProcessEnvironment</span><span class="params">(ConfigurableEnvironment environment, SpringApplication application)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>(<span class="type">InputStream</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;D:/tmp/springboot.properties&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            source.load(input);</span><br><span class="line">            <span class="type">PropertiesPropertySource</span> <span class="variable">propertySource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PropertiesPropertySource</span>(<span class="string">&quot;my&quot;</span>, source);</span><br><span class="line">            environment.getPropertySources().addLast(propertySource);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果想让我们的自定义的后置处理器生效还需要做一步：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/d1e2e3106ad98ce72d0aafb67ca44a06_1737625307067.png" alt="在这里插入图片描述"><br>在resource下配置META-INF下配置后置器到spring.factoryries中。<br><code>org.springframework.boot.env.EnvironmentPostProcessor=com.springboot.demo3.MyEnvironmentPostProcessor</code><br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/1db31cb0a67fc6089d52930315223e65_1737625307067.png" alt="在这里插入图片描述"></p>
<p>这样外部的配置文件就注入进来了,我们测试下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Demo3Application.class, args);    </span><br><span class="line">      System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;springboot.name&quot;</span>));</span><br><span class="line">       context.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果显示已经打印:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e707bc0da1a2e4f334db31dd30298453_1737625307067.png" alt="在这里插入图片描述"></p>
<h1 id="四、指定多个profile"><a href="#四、指定多个profile" class="headerlink" title="四、指定多个profile"></a>四、指定多个profile</h1><p>在开发时可能有多个环境，开发环境dev，测试环境test，默认环境default，生成环境prod，现在我们来切换和指定不同的环境。<br>准备三个配置文件：<br>application.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.url=mysql:jdbc;//127.0.0.1/db_springboot</span><br></pre></td></tr></table></figure>
<p>application-dev.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.url=mysql:jdbc;//127.0.0.1/db_springboot_dev</span><br></pre></td></tr></table></figure>
<p>application-test.properties</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.url=mysql:jdbc;//127.0.0.1/db_springboot_test</span><br></pre></td></tr></table></figure>
<h2 id="①硬编码编程方式"><a href="#①硬编码编程方式" class="headerlink" title="①硬编码编程方式:"></a>①硬编码编程方式:</h2><p>主要是在入口函数中，硬编码指定：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//编程的方式指定:生效的profie</span></span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo3Application.class);</span><br><span class="line">        app.setAdditionalProfiles(<span class="string">&quot;dev&quot;</span>);</span><br><span class="line"><span class="comment">//        app.setAdditionalProfiles(&quot;test&quot;);</span></span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;jdbc.url&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/26ab57289bf992a4d9157672c097c4c7_1737625307067.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//编程的方式指定:生效的profie</span></span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo3Application.class);</span><br><span class="line"><span class="comment">//        app.setAdditionalProfiles(&quot;dev&quot;);</span></span><br><span class="line">        app.setAdditionalProfiles(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;jdbc.url&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/e87bbd8378484e4793aba35d652ad295_1737625307067.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//编程的方式指定:生效的profie</span></span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(Demo3Application.class);</span><br><span class="line"><span class="comment">//        app.setAdditionalProfiles(&quot;dev&quot;);</span></span><br><span class="line"><span class="comment">//        app.setAdditionalProfiles(&quot;test&quot;);</span></span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        System.out.println(context.getEnvironment().getProperty(<span class="string">&quot;jdbc.url&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c7cab04b2c328233ed1e2923391eaf7a_1737625316533.png" alt="在这里插入图片描述"><br><code>结果显示，根据编码方式切换了不同的配置文件</code><br>那在启动的时候可以切换吗？<br>可以的。可以在启动时候添加参数，指定一个或者多个配置文件。</p>
<h2 id="②参数方式"><a href="#②参数方式" class="headerlink" title="②参数方式:"></a>②参数方式:</h2><h3 id="在启动参数中配置"><a href="#在启动参数中配置" class="headerlink" title="在启动参数中配置:"></a>在启动参数中配置:</h3><p><code>--spring.profiles.active=xx</code></p>
<p><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/25820047259c8222fa382e6085e05ba7_1737625316533.png" alt="在这里插入图片描述"><br>运行结果，显示一切换到test环境下。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c2ad82acca3c3ddc61dfcef271eca3af_1737625316533.png" alt="在这里插入图片描述"></p>
<h3 id="bean注入的时候-方法或者类上添加-Profile"><a href="#bean注入的时候-方法或者类上添加-Profile" class="headerlink" title="bean注入的时候:  方法或者类上添加@Profile"></a>bean注入的时候:  方法或者类上添加@Profile</h3><p>某个类或者某个方法想要在指定的环境下执行，可以通过@Profile注解指定：<br>我们写个配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========1=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile(&quot;test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========2=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile(&quot;dev&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable3</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========3=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们想要createRunnable方法在默认配置下执行（其实在所有的环境下都会触发），createRunnable2在test环境下执行，createRunnable3在dev环境下执行，就可这样定义：<br>结合上面的启动参数，我们让其生效:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/3b57ce8aff20c7934e2e44afc9f041fe_1737625316533.png" alt="在这里插入图片描述"><br>触发了默认和test方法：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/683a338b56f4d722fd7602d15a723c57_1737625316533.png" alt="在这里插入图片描述"><br>指定多个文件：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/4e34350eae45ede738daed45ae57a051_1737625325935.png" alt="在这里插入图片描述"><br>启动后运行结果:都触发了。<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/9d12f8a5c0d250f68b2e295a9cfabae0_1737625325935.png" alt="在这里插入图片描述"><br>我们也可以在类上指定一个@Profile，虽然没有-prod配置文件，但是我们可以在类上这样写，只有启动参数上加上才可以触发这个类的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@Profile(&quot;prod&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========1=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========2=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Runnable <span class="title function_">createRunnable3</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========3=====&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> () -&gt; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果启动参数不写，不会打印这几个方法，如下图，空的啥也没打印：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/2facbe10feb7b1e6c71e937b24a3954c_1737625325935.png" alt="在这里插入图片描述"><br>如果我们这样配置了，就会出触发这个类的所有方法：<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/22d9228071d8b966d71f00b8557e6b8a_1737625325935.png" alt="在这里插入图片描述"><br>再次运行:<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/c7d35cd293aa96ffa22076b1bf6e4242_1737625325935.png" alt="在这里插入图片描述"></p>
<hr>
<p>个人微信公号：<br>搜索： 怒放de每一天<br>不定时推送相关文章，期待和大家一起成长！！<br><img src="https://raw.githubusercontent.com/hufanglei/img-csdn/main/img/2025-1-13/6a0c8c9bb695bae0016871294bc2178f_1737631713820.png" alt="在这里插入图片描述"></p>
<hr>
<p>完</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/27/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><span class="page-number current">28</span><a class="page-number" href="/page/29/">29</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/29/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">胡方雷</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">1.8m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">26:40</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/hufanglei" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
